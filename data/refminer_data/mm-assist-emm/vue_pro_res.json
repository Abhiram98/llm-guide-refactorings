[
    {
        "repository": "https://github.com/YunaiV/ruoyi-vue-pro.git",
        "sha1": "9bba1ce8a4fb5c6f73cd92c9981039152a626bd6",
        "url": "https://github.com/YunaiV/ruoyi-vue-pro/commit/9bba1ce8a4fb5c6f73cd92c9981039152a626bd6",
        "move_method_refactoring": {
            "type": "Extract And Move Method",
            "description": "Extract And Move Method public selectOne() : CrmCustomerPoolConfigDO extracted from public getCustomerPoolConfig() : CrmCustomerPoolConfigDO in class cn.iocoder.yudao.module.crm.service.customer.CrmCustomerPoolConfigServiceImpl & moved to class cn.iocoder.yudao.module.crm.dal.mysql.customer.CrmCustomerPoolConfigMapper",
            "leftSideLocations": [
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/customer/CrmCustomerPoolConfigServiceImpl.java",
                    "startLine": 30,
                    "endLine": 39,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration before extraction",
                    "codeElement": "public getCustomerPoolConfig() : CrmCustomerPoolConfigDO"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/customer/CrmCustomerPoolConfigServiceImpl.java",
                    "startLine": 38,
                    "endLine": 38,
                    "startColumn": 9,
                    "endColumn": 119,
                    "codeElementType": "RETURN_STATEMENT",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                }
            ],
            "rightSideLocations": [
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/dal/mysql/customer/CrmCustomerPoolConfigMapper.java",
                    "startLine": 16,
                    "endLine": 18,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "extracted method declaration",
                    "codeElement": "public selectOne() : CrmCustomerPoolConfigDO"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/dal/mysql/customer/CrmCustomerPoolConfigMapper.java",
                    "startLine": 17,
                    "endLine": 17,
                    "startColumn": 9,
                    "endColumn": 94,
                    "codeElementType": "RETURN_STATEMENT",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/customer/CrmCustomerPoolConfigServiceImpl.java",
                    "startLine": 29,
                    "endLine": 37,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration after extraction",
                    "codeElement": "public getCustomerPoolConfig() : CrmCustomerPoolConfigDO"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/customer/CrmCustomerPoolConfigServiceImpl.java",
                    "startLine": 36,
                    "endLine": 36,
                    "startColumn": 16,
                    "endColumn": 52,
                    "codeElementType": "METHOD_INVOCATION",
                    "description": "extracted method invocation",
                    "codeElement": "customerPoolConfigMapper.selectOne()"
                }
            ],
            "isStatic": false
        },
        "ref_id": 1,
        "extraction_results": {
            "success": true,
            "newCommitHash": "a5b60c39ce0400a92b80070de8558daabc581acf",
            "newBranchName": "extract-selectOne-getCustomerPoolConfig-63db275"
        },
        "telemetry": {
            "id": "0412ac80-da39-46d7-9afb-6a2e11ebcbab",
            "hostFunctionTelemetryData": {
                "hostFunctionSize": 54,
                "lineStart": 18,
                "lineEnd": 71,
                "bodyLineStart": 18,
                "language": "java",
                "filePath": "/Users/abhiram/Documents/TBE/evaluation_projects/ruoyi-vue-pro/yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/customer/CrmCustomerPoolConfigServiceImpl.java",
                "sourceCode": "/**\n * \u5ba2\u6237\u516c\u6d77\u914d\u7f6e Service \u5b9e\u73b0\u7c7b\n *\n * @author Wanwan\n */\n@Service\n@Validated\npublic class CrmCustomerPoolConfigServiceImpl implements CrmCustomerPoolConfigService {\n\n    @Resource\n    private CrmCustomerPoolConfigMapper customerPoolConfigMapper;\n\n    /**\n     * \u83b7\u5f97\u5ba2\u6237\u516c\u6d77\u914d\u7f6e\n     *\n     * @return \u5ba2\u6237\u516c\u6d77\u914d\u7f6e\n     */\n    @Override\n    public CrmCustomerPoolConfigDO getCustomerPoolConfig() {\n        // TODO @puhui999\uff1a\u8fd9\u4e2a\u8981\u641e\u5230 mapper \u91cc\u5662\u3002\n        return selectOne();\n    }\n\n    private CrmCustomerPoolConfigDO selectOne() {\n        return customerPoolConfigMapper.selectOne(new LambdaQueryWrapperX<CrmCustomerPoolConfigDO>().last(\"LIMIT 1\"));\n    }\n\n    /**\n     * \u4fdd\u5b58\u5ba2\u6237\u516c\u6d77\u914d\u7f6e\n     *\n     * @param saveReqVO \u66f4\u65b0\u4fe1\u606f\n     */\n    @Override\n    @LogRecord(type = CRM_CUSTOMER_POOL_CONFIG_TYPE, subType = CRM_CUSTOMER_POOL_CONFIG_SUB_TYPE, bizNo = \"{{#poolConfigId}}\",\n            success = CRM_CUSTOMER_POOL_CONFIG_SUCCESS)\n    public void saveCustomerPoolConfig(CrmCustomerPoolConfigSaveReqVO saveReqVO) {\n        // \u5b58\u5728\uff0c\u5219\u8fdb\u884c\u66f4\u65b0\n        CrmCustomerPoolConfigDO dbConfig = getCustomerPoolConfig();\n        CrmCustomerPoolConfigDO poolConfig = CrmCustomerConvert.INSTANCE.convert(saveReqVO);\n        if (Objects.nonNull(dbConfig)) {\n            customerPoolConfigMapper.updateById(poolConfig.setId(dbConfig.getId()));\n            // \u8bb0\u5f55\u64cd\u4f5c\u65e5\u5fd7\u4e0a\u4e0b\u6587\n            LogRecordContext.putVariable(\"isPoolConfigUpdate\", Boolean.TRUE);\n            LogRecordContext.putVariable(\"poolConfigId\", poolConfig.getId());\n            return;\n        }\n        // \u4e0d\u5b58\u5728\uff0c\u5219\u8fdb\u884c\u63d2\u5165\n        customerPoolConfigMapper.insert(poolConfig);\n        // \u8bb0\u5f55\u64cd\u4f5c\u65e5\u5fd7\u4e0a\u4e0b\u6587\n        LogRecordContext.putVariable(\"isPoolConfigUpdate\", Boolean.FALSE);\n        LogRecordContext.putVariable(\"poolConfigId\", poolConfig.getId());\n    }\n\n}",
                "methodCount": 3
            },
            "candidatesTelemetryData": {
                "numberOfSuggestions": 1,
                "candidates": [
                    {
                        "lineStart": 40,
                        "lineEnd": 42,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method selectOne to class CrmCustomerPoolConfigMapper",
                        "description": "Move method selectOne to cn.iocoder.yudao.module.crm.dal.mysql.customer.CrmCustomerPoolConfigMapper\nRationale: The method selectOne() directly interacts with the CrmCustomerPoolConfigMapper class by using its instance customerPoolConfigMapper. This indicates that the role of this method is closely related to database operations concerning the CrmCustomerPoolConfigDO entity. Since CrmCustomerPoolConfigMapper is already responsible for CRUD operations on CrmCustomerPoolConfigDO, encapsulating the selectOne() method within CrmCustomerPoolConfigMapper would be logical. This encapsulation aligns with the Single Responsibility Principle by keeping the database interaction logic within the data access layer.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    }
                ]
            },
            "iterationData": [
                {
                    "iteration_num": 1,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectOne",
                            "method_signature": "private CrmCustomerPoolConfigDO selectOne()",
                            "target_class": "CrmCustomerPoolConfigMapper",
                            "rationale": "This method performs a database query operation which is the responsibility of the mapper (Data Access Object) layer, not the service layer. Moving it to CrmCustomerPoolConfigMapper promotes proper separation of concerns."
                        }
                    ],
                    "llm_response_time": 1987
                },
                {
                    "iteration_num": 2,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectOne",
                            "method_signature": "private CrmCustomerPoolConfigDO selectOne()",
                            "target_class": "CrmCustomerPoolConfigMapper",
                            "rationale": "The selectOne method is directly interacting with the database operations, and it should be a part of the data access layer, which is the responsibility of the CrmCustomerPoolConfigMapper class."
                        }
                    ],
                    "llm_response_time": 1843
                },
                {
                    "iteration_num": 3,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectOne",
                            "method_signature": "private CrmCustomerPoolConfigDO selectOne()",
                            "target_class": "CrmCustomerPoolConfigMapper",
                            "rationale": "The selectOne method directly interacts with the database through the customerPoolConfigMapper. Therefore, it should be moved to the CrmCustomerPoolConfigMapper class to keep the database operations encapsulated within the data access layer."
                        },
                        {
                            "method_name": "getCustomerPoolConfig",
                            "method_signature": "public CrmCustomerPoolConfigDO getCustomerPoolConfig()",
                            "target_class": "CrmCustomerPoolConfigMapper",
                            "rationale": "The getCustomerPoolConfig method is responsible for fetching configuration data by invoking the `selectOne` method, which interacts with the database via customerPoolConfigMapper. This functionality aligns more closely with the data retrieval responsibilities of the CrmCustomerPoolConfigMapper class."
                        }
                    ],
                    "llm_response_time": 2718
                },
                {
                    "iteration_num": -1,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectOne",
                            "method_signature": "private selectOne()",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                },
                {
                    "iteration_num": -2,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectOne",
                            "method_signature": "private selectOne()",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                }
            ],
            "methodCompatibilityScores": {
                "tf-idf": {
                    "private selectOne()": {
                        "first": {
                            "method_name": "selectOne",
                            "method_signature": "private selectOne()",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.25668451369560663
                    }
                },
                "voyage": {
                    "private selectOne()": {
                        "first": {
                            "method_name": "selectOne",
                            "method_signature": "private selectOne()",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5773277394419909
                    }
                }
            },
            "llmMethodPriority": {
                "tf-idf": {
                    "priority_method_names": [],
                    "llm_response_time": 1432
                },
                "tf-idf-5": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "tf-df-3": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "voyage": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "voyage-5": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "voyage-3": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                }
            },
            "targetClassMap": {
                "selectOne": {
                    "target_classes": [
                        {
                            "class_name": "CrmCustomerPoolConfigMapper",
                            "similarity_score": 0.13900960937138318
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmCustomerPoolConfigMapper"
                    ],
                    "llm_response_time": 2246,
                    "similarity_computation_time": 2,
                    "similarity_metric": "cosine"
                }
            }
        }
    },
    {
        "repository": "https://github.com/YunaiV/ruoyi-vue-pro.git",
        "sha1": "8b3bfcbd6b42530107b6f58d76f466ba521f11ca",
        "url": "https://github.com/YunaiV/ruoyi-vue-pro/commit/8b3bfcbd6b42530107b6f58d76f466ba521f11ca",
        "move_method_refactoring": {
            "type": "Extract And Move Method",
            "description": "Extract And Move Method public selectByUserIdAndSpuId(userId Long, spuId Long) : ProductBrowseHistoryDO extracted from public createBrowseHistory(userId Long, spuId Long) : void in class cn.iocoder.yudao.module.product.service.history.ProductBrowseHistoryServiceImpl & moved to class cn.iocoder.yudao.module.product.dal.mysql.history.ProductBrowseHistoryMapper",
            "leftSideLocations": [
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/service/history/ProductBrowseHistoryServiceImpl.java",
                    "startLine": 28,
                    "endLine": 53,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration before extraction",
                    "codeElement": "public createBrowseHistory(userId Long, spuId Long) : void"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/service/history/ProductBrowseHistoryServiceImpl.java",
                    "startLine": 36,
                    "endLine": 36,
                    "startColumn": 117,
                    "endColumn": 149,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/service/history/ProductBrowseHistoryServiceImpl.java",
                    "startLine": 36,
                    "endLine": 36,
                    "startColumn": 74,
                    "endColumn": 107,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/service/history/ProductBrowseHistoryServiceImpl.java",
                    "startLine": 36,
                    "endLine": 36,
                    "startColumn": 9,
                    "endColumn": 158,
                    "codeElementType": "VARIABLE_DECLARATION_STATEMENT",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                }
            ],
            "rightSideLocations": [
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/dal/mysql/history/ProductBrowseHistoryMapper.java",
                    "startLine": 23,
                    "endLine": 27,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "extracted method declaration",
                    "codeElement": "public selectByUserIdAndSpuId(userId Long, spuId Long) : ProductBrowseHistoryDO"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/dal/mysql/history/ProductBrowseHistoryMapper.java",
                    "startLine": 26,
                    "endLine": 26,
                    "startColumn": 21,
                    "endColumn": 53,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/dal/mysql/history/ProductBrowseHistoryMapper.java",
                    "startLine": 25,
                    "endLine": 25,
                    "startColumn": 21,
                    "endColumn": 54,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/dal/mysql/history/ProductBrowseHistoryMapper.java",
                    "startLine": 24,
                    "endLine": 26,
                    "startColumn": 9,
                    "endColumn": 63,
                    "codeElementType": "RETURN_STATEMENT",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/service/history/ProductBrowseHistoryServiceImpl.java",
                    "startLine": 29,
                    "endLine": 54,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration after extraction",
                    "codeElement": "public createBrowseHistory(userId Long, spuId Long) : void"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/service/history/ProductBrowseHistoryServiceImpl.java",
                    "startLine": 37,
                    "endLine": 37,
                    "startColumn": 42,
                    "endColumn": 99,
                    "codeElementType": "METHOD_INVOCATION",
                    "description": "extracted method invocation",
                    "codeElement": "browseHistoryMapper.selectByUserIdAndSpuId(userId,spuId)"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/dal/mysql/history/ProductBrowseHistoryMapper.java",
                    "startLine": 25,
                    "endLine": 25,
                    "startColumn": 21,
                    "endColumn": 54,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "added statement in extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/dal/mysql/history/ProductBrowseHistoryMapper.java",
                    "startLine": 26,
                    "endLine": 26,
                    "startColumn": 21,
                    "endColumn": 53,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "added statement in extracted method declaration",
                    "codeElement": null
                }
            ],
            "isStatic": false
        },
        "ref_id": 2,
        "extraction_results": {
            "success": true,
            "newCommitHash": "1bebd852ca5fde578332ee3106987ed1db303e5a",
            "newBranchName": "extract-selectByUserIdAndSpuId-createBrowseHistory-bbee720"
        },
        "telemetry": {
            "id": "54a8ad4a-039e-4023-999b-0be21d9ef2c8",
            "hostFunctionTelemetryData": {
                "hostFunctionSize": 61,
                "lineStart": 15,
                "lineEnd": 75,
                "bodyLineStart": 15,
                "language": "java",
                "filePath": "/Users/abhiram/Documents/TBE/evaluation_projects/ruoyi-vue-pro/yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/service/history/ProductBrowseHistoryServiceImpl.java",
                "sourceCode": "/**\n * \u5546\u54c1\u6d4f\u89c8\u8bb0\u5f55 Service \u5b9e\u73b0\u7c7b\n *\n * @author owen\n */\n@Service\n@Validated\npublic class ProductBrowseHistoryServiceImpl implements ProductBrowseHistoryService {\n    private static final int USER_STORE_MAXIMUM = 100;\n\n    @Resource\n    private ProductBrowseHistoryMapper browseHistoryMapper;\n\n    @Override\n    public void createBrowseHistory(Long userId, Long spuId) {\n        // \u7528\u6237\u672a\u767b\u5f55\u65f6\u4e0d\u8bb0\u5f55\n        if (userId == null) {\n            return;\n        }\n\n        // \u60c5\u51b5\u4e00\uff1a\u540c\u4e00\u4e2a\u5546\u54c1\uff0c\u53ea\u4fdd\u7559\u6700\u65b0\u7684\u4e00\u6761\u8bb0\u5f55\n        ProductBrowseHistoryDO historyDO = selectByUserIdAndSpuId(userId, spuId);\n        if (historyDO != null) {\n            browseHistoryMapper.deleteById(historyDO);\n        } else {\n            // \u60c5\u51b5\u4e8c\uff1a\u9650\u5236\u6bcf\u4e2a\u7528\u6237\u7684\u6d4f\u89c8\u8bb0\u5f55\u7684\u6761\u6570\uff08\u53ea\u67e5\u4e00\u6761\u6700\u65e9\u5730\u8bb0\u5f55\u3001\u8bb0\u5f55\u603b\u6570\uff09\n            Page<ProductBrowseHistoryDO> pageResult = browseHistoryMapper.selectPageByUserIdOrderByCreateTimeAsc(userId, 1, 1);\n            if (pageResult.getTotal() >= USER_STORE_MAXIMUM) {\n                // \u5220\u9664\u6700\u65e9\u7684\u4e00\u6761\n                browseHistoryMapper.deleteById(CollUtil.getFirst(pageResult.getRecords()));\n            }\n        }\n\n        // \u63d2\u5165\n        ProductBrowseHistoryDO browseHistory = new ProductBrowseHistoryDO()\n                .setUserId(userId)\n                .setSpuId(spuId);\n        browseHistoryMapper.insert(browseHistory);\n    }\n\n    private ProductBrowseHistoryDO selectByUserIdAndSpuId(Long userId, Long spuId) {\n        ProductBrowseHistoryDO historyDO = browseHistoryMapper.selectOne(ProductBrowseHistoryDO::getUserId, userId, ProductBrowseHistoryDO::getSpuId, spuId);\n        return historyDO;\n    }\n\n    @Override\n    public void hideUserBrowseHistory(Long userId, Collection<Long> spuIds) {\n        browseHistoryMapper.updateUserDeletedByUserId(userId, spuIds, true);\n    }\n\n    @Override\n    public Long getBrowseHistoryCount(Long userId, Boolean userDeleted) {\n        return browseHistoryMapper.selectCountByUserIdAndUserDeleted(userId, userDeleted);\n    }\n\n    @Override\n    public PageResult<ProductBrowseHistoryDO> getBrowseHistoryPage(ProductBrowseHistoryPageReqVO pageReqVO) {\n        return browseHistoryMapper.selectPage(pageReqVO);\n    }\n\n}",
                "methodCount": 5
            },
            "candidatesTelemetryData": {
                "numberOfSuggestions": 1,
                "candidates": [
                    {
                        "lineStart": 54,
                        "lineEnd": 57,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method selectByUserIdAndSpuId to class ProductBrowseHistoryMapper",
                        "description": "Move method selectByUserIdAndSpuId to cn.iocoder.yudao.module.product.dal.mysql.history.ProductBrowseHistoryMapper\nRationale: The method selectByUserIdAndSpuId() is primarily interacting with the data layer by querying the database for specific records based on userId and spuId. Since this functionality is closely related to data access and the ProductBrowseHistoryMapper interface already contains similar methods, it is logical and efficient to move this method there. This consolidation enhances cohesion and maintains a single responsibility principle, whereby all database-related methods for ProductBrowseHistoryDO can be managed within ProductBrowseHistoryMapper.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    }
                ]
            },
            "iterationData": [
                {
                    "iteration_num": 1,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectByUserIdAndSpuId",
                            "method_signature": "private selectByUserIdAndSpuId(Long userId, Long spuId): ProductBrowseHistoryDO",
                            "target_class": "ProductBrowseHistoryMapper",
                            "rationale": "selectByUserIdAndSpuId is heavily tied to the data access level and interacts directly with the database through ProductBrowseHistoryMapper. It would align better if it were a part of the mapper class itself."
                        }
                    ],
                    "llm_response_time": 1885
                },
                {
                    "iteration_num": 2,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectByUserIdAndSpuId",
                            "method_signature": "private ProductBrowseHistoryDO selectByUserIdAndSpuId(Long userId, Long spuId)",
                            "target_class": "ProductBrowseHistoryMapper",
                            "rationale": "The method `selectByUserIdAndSpuId` interacts directly with the database using a mapper. It should be part of the `ProductBrowseHistoryMapper` class to keep the database-related operations grouped together for better single responsibility principle and easier maintainability."
                        }
                    ],
                    "llm_response_time": 1583
                },
                {
                    "iteration_num": 3,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectByUserIdAndSpuId",
                            "method_signature": "private ProductBrowseHistoryDO selectByUserIdAndSpuId(Long userId, Long spuId)",
                            "target_class": "ProductBrowseHistoryMapper",
                            "rationale": "selectByUserIdAndSpuId() is a data access operation that directly interacts with the database, which is the responsibility of the ProductBrowseHistoryMapper class."
                        }
                    ],
                    "llm_response_time": 1504
                },
                {
                    "iteration_num": -1,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectByUserIdAndSpuId",
                            "method_signature": "private selectByUserIdAndSpuId(Long userId, Long spuId)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                },
                {
                    "iteration_num": -2,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectByUserIdAndSpuId",
                            "method_signature": "private selectByUserIdAndSpuId(Long userId, Long spuId)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                }
            ],
            "methodCompatibilityScores": {
                "tf-idf": {
                    "private selectByUserIdAndSpuId(Long userId, Long spuId)": {
                        "first": {
                            "method_name": "selectByUserIdAndSpuId",
                            "method_signature": "private selectByUserIdAndSpuId(Long userId, Long spuId)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.46959222404176715
                    }
                },
                "voyage": {
                    "private selectByUserIdAndSpuId(Long userId, Long spuId)": {
                        "first": {
                            "method_name": "selectByUserIdAndSpuId",
                            "method_signature": "private selectByUserIdAndSpuId(Long userId, Long spuId)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.7334519796586341
                    }
                }
            },
            "llmMethodPriority": {
                "tf-idf": {
                    "priority_method_names": [],
                    "llm_response_time": 1727
                },
                "tf-idf-5": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "tf-df-3": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "voyage": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "voyage-5": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "voyage-3": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                }
            },
            "targetClassMap": {
                "selectByUserIdAndSpuId": {
                    "target_classes": [
                        {
                            "class_name": "ProductBrowseHistoryMapper",
                            "similarity_score": 0.34646743359179166
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "ProductBrowseHistoryMapper"
                    ],
                    "llm_response_time": 2474,
                    "similarity_computation_time": 0,
                    "similarity_metric": "cosine"
                }
            }
        }
    },
    {
        "repository": "https://github.com/YunaiV/ruoyi-vue-pro.git",
        "sha1": "f361d05940e3e5ac91004fd5e51cad5e34749858",
        "url": "https://github.com/YunaiV/ruoyi-vue-pro/commit/f361d05940e3e5ac91004fd5e51cad5e34749858",
        "move_method_refactoring": {
            "type": "Extract And Move Method",
            "description": "Extract And Move Method public selectByIdAndName(id Long, name String) : CrmBusinessStatusTypeDO extracted from private validateBusinessStatusTypeExists(name String, id Long) : void in class cn.iocoder.yudao.module.crm.service.business.CrmBusinessStatusTypeServiceImpl & moved to class cn.iocoder.yudao.module.crm.dal.mysql.business.CrmBusinessStatusTypeMapper",
            "leftSideLocations": [
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/business/CrmBusinessStatusTypeServiceImpl.java",
                    "startLine": 97,
                    "endLine": 106,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration before extraction",
                    "codeElement": "private validateBusinessStatusTypeExists(name String, id Long) : void"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/business/CrmBusinessStatusTypeServiceImpl.java",
                    "startLine": 100,
                    "endLine": 100,
                    "startColumn": 24,
                    "endColumn": 54,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                }
            ],
            "rightSideLocations": [
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/dal/mysql/business/CrmBusinessStatusTypeMapper.java",
                    "startLine": 32,
                    "endLine": 41,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "extracted method declaration",
                    "codeElement": "public selectByIdAndName(id Long, name String) : CrmBusinessStatusTypeDO"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/dal/mysql/business/CrmBusinessStatusTypeMapper.java",
                    "startLine": 40,
                    "endLine": 40,
                    "startColumn": 26,
                    "endColumn": 56,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/business/CrmBusinessStatusTypeServiceImpl.java",
                    "startLine": 97,
                    "endLine": 110,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration after extraction",
                    "codeElement": "private validateBusinessStatusTypeExists(name String, id Long) : void"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/business/CrmBusinessStatusTypeServiceImpl.java",
                    "startLine": 98,
                    "endLine": 98,
                    "startColumn": 56,
                    "endColumn": 108,
                    "codeElementType": "METHOD_INVOCATION",
                    "description": "extracted method invocation",
                    "codeElement": "businessStatusTypeMapper.selectByIdAndName(id,name)"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/dal/mysql/business/CrmBusinessStatusTypeMapper.java",
                    "startLine": 40,
                    "endLine": 40,
                    "startColumn": 9,
                    "endColumn": 102,
                    "codeElementType": "RETURN_STATEMENT",
                    "description": "added statement in extracted method declaration",
                    "codeElement": null
                }
            ],
            "isStatic": false
        },
        "ref_id": 3,
        "extraction_results": {
            "success": true,
            "newCommitHash": "e2b41dd358c9fc9e7ccf31083e40005c7e49f1bd",
            "newBranchName": "extract-selectByIdAndName-validateBusinessStatusTypeExists-ed34b18"
        },
        "telemetry": {
            "id": "bb04072d-1171-4f9a-b075-1dc55b4b1c4e",
            "hostFunctionTelemetryData": {
                "hostFunctionSize": 101,
                "lineStart": 29,
                "lineEnd": 129,
                "bodyLineStart": 29,
                "language": "java",
                "filePath": "/Users/abhiram/Documents/TBE/evaluation_projects/ruoyi-vue-pro/yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/business/CrmBusinessStatusTypeServiceImpl.java",
                "sourceCode": "/**\n * 商机状态类型 Service 实现类\n *\n * @author ljlleo\n */\n@Service\n@Validated\npublic class CrmBusinessStatusTypeServiceImpl implements CrmBusinessStatusTypeService {\n\n    @Resource\n    private CrmBusinessStatusTypeMapper businessStatusTypeMapper;\n\n    @Resource\n    private CrmBusinessStatusMapper businessStatusMapper;\n\n    @Override\n    @Transactional(rollbackFor = Exception.class)\n    public Long createBusinessStatusType(CrmBusinessStatusTypeSaveReqVO createReqVO) {\n        //检验名称是否存在\n        validateBusinessStatusTypeExists(createReqVO.getName(), null);\n        // 插入类型\n        CrmBusinessStatusTypeDO businessStatusType = BeanUtils.toBean(createReqVO, CrmBusinessStatusTypeDO.class);\n        businessStatusTypeMapper.insert(businessStatusType);\n        // 插入状态\n        if (CollUtil.isNotEmpty(createReqVO.getStatusList())) {\n            createReqVO.getStatusList().forEach(status -> status.setTypeId(businessStatusType.getId()));\n            businessStatusMapper.insertBatch(BeanUtils.toBean(createReqVO.getStatusList(), CrmBusinessStatusDO.class));\n        }\n        return businessStatusType.getId();\n    }\n\n    @Override\n    @Transactional(rollbackFor = Exception.class)\n    public void updateBusinessStatusType(CrmBusinessStatusTypeSaveReqVO updateReqVO) {\n        // 校验存在\n        validateBusinessStatusTypeExists(updateReqVO.getId());\n        // 校验名称是否存在\n        validateBusinessStatusTypeExists(updateReqVO.getName(), updateReqVO.getId());\n        // 更新类型\n        CrmBusinessStatusTypeDO updateObj = BeanUtils.toBean(updateReqVO, CrmBusinessStatusTypeDO.class);\n        businessStatusTypeMapper.updateById(updateObj);\n        // 更新状态（删除 + 更新）\n        // TODO @ljlleo 可以参考 DeliveryExpressTemplateServiceImpl 的 updateExpressTemplateFree 方法；主要没变化的，还是不删除了哈。\n        businessStatusMapper.delete(updateReqVO.getId());\n        updateReqVO.getStatusList().forEach(status -> status.setTypeId(updateReqVO.getId()));\n        businessStatusMapper.insertBatch(BeanUtils.toBean(updateReqVO.getStatusList(), CrmBusinessStatusDO.class));\n    }\n\n    @Override\n    @Transactional(rollbackFor = Exception.class)\n    public void deleteBusinessStatusType(Long id) {\n        // TODO 待添加被引用校验\n        //...\n\n        // 校验存在\n        validateBusinessStatusTypeExists(id);\n        // 删除类型\n        businessStatusTypeMapper.deleteById(id);\n        // 删除状态\n        businessStatusMapper.delete(id);\n    }\n\n    private void validateBusinessStatusTypeExists(Long id) {\n        if (businessStatusTypeMapper.selectById(id) == null) {\n            throw exception(BUSINESS_STATUS_TYPE_NOT_EXISTS);\n        }\n    }\n\n    // TODO @ljlleo 这个方法，这个参考 validateDeptNameUnique 实现。\n    private void validateBusinessStatusTypeExists(String name, Long id) {\n        CrmBusinessStatusTypeDO businessStatusTypeDO = selectByIdAndName(id, name);\n        if (businessStatusTypeDO != null) {\n            throw exception(BUSINESS_STATUS_TYPE_NAME_EXISTS);\n        }\n    }\n\n    private CrmBusinessStatusTypeDO selectByIdAndName(Long id, String name) {\n        return businessStatusTypeMapper.selectOne(CrmBusinessStatusTypeDO::getId, id, CrmBusinessStatusTypeDO::getName, name);\n    }\n\n    @Override\n    public CrmBusinessStatusTypeDO getBusinessStatusType(Long id) {\n        return businessStatusTypeMapper.selectById(id);\n    }\n\n    @Override\n    public PageResult<CrmBusinessStatusTypeDO> getBusinessStatusTypePage(CrmBusinessStatusTypePageReqVO pageReqVO) {\n        return businessStatusTypeMapper.selectPage(pageReqVO);\n    }\n\n    @Override\n    public List<CrmBusinessStatusTypeDO> selectList(CrmBusinessStatusTypeQueryVO queryVO) {\n        return businessStatusTypeMapper.selectList(queryVO);\n    }\n\n    @Override\n    public List<CrmBusinessStatusTypeDO> getBusinessStatusTypeList(Collection<Long> ids) {\n        return businessStatusTypeMapper.selectBatchIds(ids);\n    }\n\n}",
                "methodCount": 10
            },
            "candidatesTelemetryData": {
                "numberOfSuggestions": 2,
                "candidates": [
                    {
                        "lineStart": 104,
                        "lineEnd": 106,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method selectByIdAndName to class CrmBusinessStatusTypeMapper",
                        "description": "Move method selectByIdAndName to cn.iocoder.yudao.module.crm.dal.mysql.business.CrmBusinessStatusTypeMapper\nRationale: The method selectByIdAndName() operates specifically with CrmBusinessStatusTypeDO entities and uses methods that are closely related to the CrmBusinessStatusTypeMapper functionalities. Since CrmBusinessStatusTypeMapper is the interface designed to handle operations related to CrmBusinessStatusTypeDO, it is appropriate to move this method there. Additionally, there is no indication that this logic belongs to another business status, but rather directly correlates with business status types.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 90,
                        "lineEnd": 94,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method validateBusinessStatusTypeExists to class CrmBusinessStatusTypeMapper",
                        "description": "Move method validateBusinessStatusTypeExists to cn.iocoder.yudao.module.crm.dal.mysql.business.CrmBusinessStatusTypeMapper\nRationale: The method validateBusinessStatusTypeExists(Long id) directly interfaces with businessStatusTypeMapper to check the existence of a BusinessStatusType by its ID. Given this direct interaction, it is most logical and appropriate to move the method to CrmBusinessStatusTypeMapper. The method fits the responsibility of this class as it validates entities manipulated by the CrmBusinessStatusTypeMapper.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    }
                ]
            },
            "elapsedTime": [
                {
                    "candidateIndex": 0,
                    "elapsedTime": 7270
                }
            ],
            "processingTime": {
                "llmResponseTime": -1,
                "pluginProcessingTime": -1,
                "totalTime": 20315
            },
            "iterationData": [
                {
                    "iteration_num": 1,
                    "suggested_move_methods": [
                        {
                            "method_name": "validateBusinessStatusTypeExists",
                            "method_signature": "private void validateBusinessStatusTypeExists(Long id)",
                            "target_class": "CrmBusinessStatusTypeValidator",
                            "rationale": "Validation methods are typically better placed in a separate validator class to adhere to the Single Responsibility Principle. Moving this method will also promote reuse and better separation of concerns."
                        },
                        {
                            "method_name": "validateBusinessStatusTypeExists",
                            "method_signature": "private void validateBusinessStatusTypeExists(String name, Long id)",
                            "target_class": "CrmBusinessStatusTypeValidator",
                            "rationale": "Similar to the other validation method, this method's responsibility aligns better with a dedicated validator class."
                        },
                        {
                            "method_name": "selectByIdAndName",
                            "method_signature": "private CrmBusinessStatusTypeDO selectByIdAndName(Long id, String name)",
                            "target_class": "CrmBusinessStatusTypeMapper",
                            "rationale": "Methods that interact directly with the database should ideally reside in the Mapper class. This change improves cohesion and ensures that database interactions are centralized in the Mapper layer."
                        }
                    ],
                    "llm_response_time": 3862
                },
                {
                    "iteration_num": 2,
                    "suggested_move_methods": [
                        {
                            "method_name": "validateBusinessStatusTypeExists",
                            "method_signature": "private void validateBusinessStatusTypeExists(Long id)",
                            "target_class": "CrmBusinessStatusTypeValidator",
                            "rationale": "This method is for validation purposes, and it would be more appropriate to move this to a dedicated validator class to adhere to the Single Responsibility Principle."
                        },
                        {
                            "method_name": "validateBusinessStatusTypeExists",
                            "method_signature": "private void validateBusinessStatusTypeExists(String name, Long id)",
                            "target_class": "CrmBusinessStatusTypeValidator",
                            "rationale": "Similar to the previous method, this validation logic should reside in a dedicated validator class to keep the service class focused on business logic."
                        },
                        {
                            "method_name": "selectByIdAndName",
                            "method_signature": "private CrmBusinessStatusTypeDO selectByIdAndName(Long id, String name)",
                            "target_class": "CrmBusinessStatusTypeMapper",
                            "rationale": "This method interacts directly with the database via the mapper and should logically belong to the mapper class to better organize database query operations."
                        }
                    ],
                    "llm_response_time": 3113
                },
                {
                    "iteration_num": 3,
                    "suggested_move_methods": [
                        {
                            "method_name": "validateBusinessStatusTypeExists",
                            "method_signature": "private void validateBusinessStatusTypeExists(Long id)",
                            "target_class": "CrmBusinessStatusTypeValidator",
                            "rationale": "Method is primarily responsible for validation logic which should be encapsulated in a separate validation class to respect the Single Responsibility Principle."
                        },
                        {
                            "method_name": "validateBusinessStatusTypeExists",
                            "method_signature": "private void validateBusinessStatusTypeExists(String name, Long id)",
                            "target_class": "CrmBusinessStatusTypeValidator",
                            "rationale": "Method is responsible for validation logic which can be encapsulated separately to keep the service implementation class focused on business operations."
                        },
                        {
                            "method_name": "selectByIdAndName",
                            "method_signature": "private CrmBusinessStatusTypeDO selectByIdAndName(Long id, String name)",
                            "target_class": "CrmBusinessStatusTypeRepository",
                            "rationale": "Method appears to be a repository function querying the database. It should be in a repository class to separate data access logic from business service logic."
                        }
                    ],
                    "llm_response_time": 3033
                },
                {
                    "iteration_num": -1,
                    "suggested_move_methods": [
                        {
                            "method_name": "validateBusinessStatusTypeExists",
                            "method_signature": "private validateBusinessStatusTypeExists(Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "selectByIdAndName",
                            "method_signature": "private selectByIdAndName(Long id, String name)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                },
                {
                    "iteration_num": -2,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectByIdAndName",
                            "method_signature": "private selectByIdAndName(Long id, String name)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "validateBusinessStatusTypeExists",
                            "method_signature": "private validateBusinessStatusTypeExists(Long id)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                }
            ],
            "methodCompatibilityScores": {
                "tf-idf": {
                    "private selectByIdAndName(Long id, String name)": {
                        "first": {
                            "method_name": "selectByIdAndName",
                            "method_signature": "private selectByIdAndName(Long id, String name)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.3454185067672265
                    },
                    "private validateBusinessStatusTypeExists(Long id)": {
                        "first": {
                            "method_name": "validateBusinessStatusTypeExists",
                            "method_signature": "private validateBusinessStatusTypeExists(Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.4370866917665225
                    }
                },
                "voyage": {
                    "private validateBusinessStatusTypeExists(Long id)": {
                        "first": {
                            "method_name": "validateBusinessStatusTypeExists",
                            "method_signature": "private validateBusinessStatusTypeExists(Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5944183801577033
                    },
                    "private selectByIdAndName(Long id, String name)": {
                        "first": {
                            "method_name": "selectByIdAndName",
                            "method_signature": "private selectByIdAndName(Long id, String name)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6736722229566263
                    }
                }
            },
            "llmMethodPriority": {
                "tf-idf": {
                    "priority_method_names": [
                        "private selectByIdAndName(Long id, String name)",
                        "private validateBusinessStatusTypeExists(Long id)"
                    ],
                    "llm_response_time": 1500
                },
                "tf-idf-5": {
                    "priority_method_names": [
                        "private selectByIdAndName(Long id, String name)",
                        "private validateBusinessStatusTypeExists(Long id)"
                    ],
                    "llm_response_time": 0
                },
                "tf-df-3": {
                    "priority_method_names": [
                        "private selectByIdAndName(Long id, String name)",
                        "private validateBusinessStatusTypeExists(Long id)"
                    ],
                    "llm_response_time": 0
                },
                "voyage": {
                    "priority_method_names": [],
                    "llm_response_time": 2292
                },
                "voyage-5": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "voyage-3": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                }
            },
            "targetClassMap": {
                "selectByIdAndName": {
                    "target_classes": [
                        {
                            "class_name": "CrmBusinessStatusTypeMapper",
                            "similarity_score": 0.25620504608813943
                        },
                        {
                            "class_name": "CrmBusinessStatusMapper",
                            "similarity_score": 0.28837737780119194
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmBusinessStatusTypeMapper",
                        "CrmBusinessStatusMapper"
                    ],
                    "llm_response_time": 5399,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "validateBusinessStatusTypeExists": {
                    "target_classes": [
                        {
                            "class_name": "CrmBusinessStatusTypeMapper",
                            "similarity_score": 0.3508232077228117
                        },
                        {
                            "class_name": "CrmBusinessStatusMapper",
                            "similarity_score": 0.3829110179294604
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmBusinessStatusTypeMapper",
                        "CrmBusinessStatusMapper"
                    ],
                    "llm_response_time": 0,
                    "similarity_computation_time": 0,
                    "similarity_metric": "cosine"
                }
            }
        }
    },
    {
        "repository": "https://github.com/YunaiV/ruoyi-vue-pro.git",
        "sha1": "e01dda9bafb906123fb4fdc9c951e5da5c40a53b",
        "url": "https://github.com/YunaiV/ruoyi-vue-pro/commit/e01dda9bafb906123fb4fdc9c951e5da5c40a53b",
        "move_method_refactoring": {
            "type": "Extract And Move Method",
            "description": "Extract And Move Method public selectCountByCategoryId(categoryId Long) : Long extracted from public getProductByCategoryId(categoryId Long) : CrmProductDO in class cn.iocoder.yudao.module.crm.service.product.CrmProductServiceImpl & moved to class cn.iocoder.yudao.module.crm.dal.mysql.product.CrmProductMapper",
            "leftSideLocations": [
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/product/CrmProductServiceImpl.java",
                    "startLine": 153,
                    "endLine": 156,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration before extraction",
                    "codeElement": "public getProductByCategoryId(categoryId Long) : CrmProductDO"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/product/CrmProductServiceImpl.java",
                    "startLine": 155,
                    "endLine": 155,
                    "startColumn": 82,
                    "endColumn": 109,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/product/CrmProductServiceImpl.java",
                    "startLine": 155,
                    "endLine": 155,
                    "startColumn": 9,
                    "endColumn": 124,
                    "codeElementType": "RETURN_STATEMENT",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                }
            ],
            "rightSideLocations": [
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/dal/mysql/product/CrmProductMapper.java",
                    "startLine": 31,
                    "endLine": 33,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "extracted method declaration",
                    "codeElement": "public selectCountByCategoryId(categoryId Long) : Long"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/dal/mysql/product/CrmProductMapper.java",
                    "startLine": 32,
                    "endLine": 32,
                    "startColumn": 28,
                    "endColumn": 55,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/dal/mysql/product/CrmProductMapper.java",
                    "startLine": 32,
                    "endLine": 32,
                    "startColumn": 9,
                    "endColumn": 69,
                    "codeElementType": "RETURN_STATEMENT",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/product/CrmProductServiceImpl.java",
                    "startLine": 146,
                    "endLine": 149,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration after extraction",
                    "codeElement": "public getProductByCategoryId(categoryId Long) : Long"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/product/CrmProductServiceImpl.java",
                    "startLine": 148,
                    "endLine": 148,
                    "startColumn": 16,
                    "endColumn": 65,
                    "codeElementType": "METHOD_INVOCATION",
                    "description": "extracted method invocation",
                    "codeElement": "productMapper.selectCountByCategoryId(categoryId)"
                }
            ],
            "isStatic": false
        },
        "ref_id": 5,
        "extraction_results": {
            "success": true,
            "newCommitHash": "ad5c0ea90744cad50e17d5e820080e432f0368cf",
            "newBranchName": "extract-selectCountByCategoryId-getProductByCategoryId-7dd35f3"
        },
        "telemetry": {
            "id": "eeb1af20-5235-4fb1-8823-80e160490853",
            "hostFunctionTelemetryData": {
                "hostFunctionSize": 135,
                "lineStart": 36,
                "lineEnd": 170,
                "bodyLineStart": 36,
                "language": "java",
                "filePath": "/Users/abhiram/Documents/TBE/evaluation_projects/ruoyi-vue-pro/yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/product/CrmProductServiceImpl.java",
                "sourceCode": "/**\n * CRM \u4ea7\u54c1 Service \u5b9e\u73b0\u7c7b\n *\n * @author ZanGe\u4e36\n */\n@Service\n@Validated\npublic class CrmProductServiceImpl implements CrmProductService {\n\n    @Resource(name = \"crmProductMapper\")\n    private CrmProductMapper productMapper;\n\n    @Resource\n    private CrmProductCategoryService productCategoryService;\n    @Resource\n    private CrmPermissionService permissionService;\n\n    @Resource\n    private AdminUserApi adminUserApi;\n\n    @Override\n    @Transactional(rollbackFor = Exception.class)\n    @LogRecord(type = CRM_PRODUCT_TYPE, subType = CRM_PRODUCT_CREATE_SUB_TYPE, bizNo = \"{{#productId}}\",\n            success = CRM_PRODUCT_CREATE_SUCCESS)\n    public Long createProduct(CrmProductSaveReqVO createReqVO) {\n        // 1. \u6821\u9a8c\u4ea7\u54c1\n        adminUserApi.validateUserList(Collections.singleton(createReqVO.getOwnerUserId()));\n        validateProductNoDuplicate(null, createReqVO.getNo());\n        validateProductCategoryExists(createReqVO.getCategoryId());\n\n        // 2. \u63d2\u5165\u4ea7\u54c1\n        CrmProductDO product = BeanUtils.toBean(createReqVO, CrmProductDO.class);\n        productMapper.insert(product);\n\n        // 3. \u63d2\u5165\u6570\u636e\u6743\u9650\n        permissionService.createPermission(new CrmPermissionCreateReqBO().setUserId(product.getOwnerUserId())\n                .setBizType(CrmBizTypeEnum.CRM_PRODUCT.getType()).setBizId(product.getId())\n                .setLevel(CrmPermissionLevelEnum.OWNER.getLevel()));\n\n        // 4. \u8bb0\u5f55\u64cd\u4f5c\u65e5\u5fd7\u4e0a\u4e0b\u6587\n        LogRecordContext.putVariable(\"productId\", product.getId());\n        return product.getId();\n    }\n\n    @Override\n    @LogRecord(type = CRM_PRODUCT_TYPE, subType = CRM_PRODUCT_UPDATE_SUB_TYPE, bizNo = \"{{#updateReqVO.id}}\",\n            success = CRM_PRODUCT_UPDATE_SUCCESS)\n    @CrmPermission(bizType = CrmBizTypeEnum.CRM_PRODUCT, bizId = \"#updateReqVO.id\", level = CrmPermissionLevelEnum.WRITE)\n    public void updateProduct(CrmProductSaveReqVO updateReqVO) {\n        // 1. \u6821\u9a8c\u4ea7\u54c1\n        updateReqVO.setOwnerUserId(null); // \u4e0d\u4fee\u6539\u8d1f\u8d23\u4eba\n        CrmProductDO crmProductDO = validateProductExists(updateReqVO.getId());\n        validateProductNoDuplicate(updateReqVO.getId(), updateReqVO.getNo());\n        validateProductCategoryExists(updateReqVO.getCategoryId());\n\n        // 2. \u66f4\u65b0\u4ea7\u54c1\n        CrmProductDO updateObj = BeanUtils.toBean(updateReqVO, CrmProductDO.class);\n        productMapper.updateById(updateObj);\n\n        // 3. \u8bb0\u5f55\u64cd\u4f5c\u65e5\u5fd7\u4e0a\u4e0b\u6587\n        LogRecordContext.putVariable(DiffParseFunction.OLD_OBJECT, BeanUtils.toBean(crmProductDO, CrmProductSaveReqVO.class));\n    }\n\n    private CrmProductDO validateProductExists(Long id) {\n        CrmProductDO product = productMapper.selectById(id);\n        if (product == null) {\n            throw exception(PRODUCT_NOT_EXISTS);\n        }\n        return product;\n    }\n\n    private void validateProductNoDuplicate(Long id, String no) {\n        CrmProductDO product = productMapper.selectByNo(no);\n        if (product == null\n                || product.getId().equals(id)) {\n            return;\n        }\n        throw exception(PRODUCT_NO_EXISTS);\n    }\n\n    private void validateProductCategoryExists(Long categoryId) {\n        CrmProductCategoryDO category = productCategoryService.getProductCategory(categoryId);\n        if (category == null) {\n            throw exception(PRODUCT_CATEGORY_NOT_EXISTS);\n        }\n    }\n\n    @Override\n    @LogRecord(type = CRM_PRODUCT_TYPE, subType = CRM_PRODUCT_DELETE_SUB_TYPE, bizNo = \"{{#id}}\",\n            success = CRM_PRODUCT_DELETE_SUCCESS)\n    @CrmPermission(bizType = CrmBizTypeEnum.CRM_PRODUCT, bizId = \"#id\", level = CrmPermissionLevelEnum.OWNER)\n    public void deleteProduct(Long id) {\n        // \u6821\u9a8c\u5b58\u5728\n        validateProductExists(id);\n        // \u5220\u9664\n        productMapper.deleteById(id);\n    }\n\n    @Override\n    @CrmPermission(bizType = CrmBizTypeEnum.CRM_PRODUCT, bizId = \"#id\", level = CrmPermissionLevelEnum.READ)\n    public CrmProductDO getProduct(Long id) {\n        return productMapper.selectById(id);\n    }\n\n    @Override\n    public List<CrmProductDO> getProductList(Collection<Long> ids) {\n        if (CollUtil.isEmpty(ids)) {\n            return ListUtil.empty();\n        }\n        return productMapper.selectBatchIds(ids);\n    }\n\n    @Override\n    public PageResult<CrmProductDO> getProductPage(CrmProductPageReqVO pageReqVO, Long userId) {\n        return productMapper.selectPage(pageReqVO, userId);\n    }\n\n    @Override\n    public CrmProductDO getProductByCategoryId(Long categoryId) {\n        return selectCountByCategoryId(categoryId);\n    }\n\n    private CrmProductDO selectCountByCategoryId(Long categoryId) {\n        return productMapper.selectOne(new LambdaQueryWrapper<CrmProductDO>().eq(CrmProductDO::getCategoryId, categoryId));\n    }\n\n    @Override\n    public List<CrmProductDO> getProductListByIds(Collection<Long> ids) {\n        if (CollUtil.isEmpty(ids)) {\n            return Collections.emptyList();\n        }\n        return productMapper.selectBatchIds(ids);\n    }\n\n}",
                "methodCount": 12
            },
            "candidatesTelemetryData": {
                "numberOfSuggestions": 4,
                "candidates": [
                    {
                        "lineStart": 157,
                        "lineEnd": 159,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method selectCountByCategoryId to class CrmProductMapper",
                        "description": "Move method selectCountByCategoryId to cn.iocoder.yudao.module.crm.dal.mysql.product.CrmProductMapper\nRationale: The method selectCountByCategoryId(Long categoryId) involves querying a product by its category ID, which aligns closely with the responsibility of the CrmProductMapper class. CrmProductMapper already handles various product retrieval operations, making it the most appropriate place for this method.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 106,
                        "lineEnd": 113,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method validateProductNoDuplicate to class CrmProductMapper",
                        "description": "Move method validateProductNoDuplicate to cn.iocoder.yudao.module.crm.dal.mysql.product.CrmProductMapper\nRationale: The method validateProductNoDuplicate relies heavily on operations related to CrmProductDO, specifically using the productMapper to retrieve product data. Since CrmProductMapper is already designed to handle database operations related to CrmProductDO, it logically follows that this validation method would be a good fit here. Additionally, CrmProductMapper already contains a similar method, selectByNo, which suggests that it is the appropriate class to house this functionality. Moving this method here adheres to the principle of placing related behaviors within the same class.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 115,
                        "lineEnd": 120,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method validateProductCategoryExists to class CrmProductCategoryService",
                        "description": "Move method validateProductCategoryExists to cn.iocoder.yudao.module.crm.service.product.CrmProductCategoryService\nRationale: The method validateProductCategoryExists() directly deals with product category validation, which is a responsibility closely related to the CrmProductCategoryService class. This service already manages creation, updating, deletion, and retrieval of product categories, making it the most appropriate place to have validation logic for product categories. Moving this method here encapsulates all product category-related operations in a single service, ensuring coherence and maintainability.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 98,
                        "lineEnd": 104,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method validateProductExists to class CrmProductMapper",
                        "description": "Move method validateProductExists to cn.iocoder.yudao.module.crm.dal.mysql.product.CrmProductMapper\nRationale: The validateProductExists() method is centered around the product entity and verification if a product exists in the database using its ID. CrmProductMapper is primarily responsible for database operations related to products. Thus, this method fits naturally into CrmProductMapper, as it directly deals with validating if a product exists in the database.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    }
                ]
            },
            "iterationData": [
                {
                    "iteration_num": 1,
                    "suggested_move_methods": [
                        {
                            "method_name": "validateUserList",
                            "method_signature": "public void validateUserList(Set<Long> userIds)",
                            "target_class": "AdminUserApi",
                            "rationale": "The validation of user lists is explicitly related to user management, which is the responsibility of the AdminUserApi. Moving this method will promote better separation of concerns."
                        },
                        {
                            "method_name": "createPermission",
                            "method_signature": "public void createPermission(CrmPermissionCreateReqBO reqBO)",
                            "target_class": "CrmPermissionService",
                            "rationale": "Permission creation is inherently linked to the permission system, hence it fits better within the CrmPermissionService class. This will also help in reducing the coupling within CrmProductServiceImpl."
                        },
                        {
                            "method_name": "getProductCategory",
                            "method_signature": "public CrmProductCategoryDO getProductCategory(Long categoryId)",
                            "target_class": "CrmProductCategoryService",
                            "rationale": "Product category retrieval should be managed by CrmProductCategoryService, which is likely focused on category-related operations, providing a cleaner structure."
                        }
                    ],
                    "llm_response_time": 3454
                },
                {
                    "iteration_num": 2,
                    "suggested_move_methods": [
                        {
                            "method_name": "validateProductExists",
                            "method_signature": "private CrmProductDO validateProductExists(Long id)",
                            "target_class": "CrmProductValidator",
                            "rationale": "The validateProductExists method primarily deals with validation logic, making it more suitable for a validation-focused class such as CrmProductValidator."
                        },
                        {
                            "method_name": "validateProductNoDuplicate",
                            "method_signature": "private void validateProductNoDuplicate(Long id, String no)",
                            "target_class": "CrmProductValidator",
                            "rationale": "Similar to validateProductExists, the validateProductNoDuplicate method is concerned with validation logic and should logically reside in a validation-specific class like CrmProductValidator."
                        },
                        {
                            "method_name": "validateProductCategoryExists",
                            "method_signature": "private void validateProductCategoryExists(Long categoryId)",
                            "target_class": "CrmProductValidator",
                            "rationale": "The validateProductCategoryExists method also performs validation tasks specific to product categories, which fits better in a validation class such as CrmProductValidator."
                        },
                        {
                            "method_name": "selectCountByCategoryId",
                            "method_signature": "private CrmProductDO selectCountByCategoryId(Long categoryId)",
                            "target_class": "CrmProductRepository",
                            "rationale": "The selectCountByCategoryId method is involved in data access operations, hence it is more appropriate to move this to a repository class focused on data retrieval and storage, such as CrmProductRepository."
                        }
                    ],
                    "llm_response_time": 3937
                },
                {
                    "iteration_num": 3,
                    "suggested_move_methods": [
                        {
                            "method_name": "validateUserList",
                            "method_signature": "public void validateUserList(Collection<Long> userIds)",
                            "target_class": "AdminUserApi",
                            "rationale": "The method is interacting with the AdminUserApi; hence, it should be part of that class to encapsulate user validation responsibilities."
                        },
                        {
                            "method_name": "validateProductCategoryExists",
                            "method_signature": "private void validateProductCategoryExists(Long categoryId)",
                            "target_class": "CrmProductCategoryService",
                            "rationale": "This method involves checking the existence of a product category, which is more related to the responsibilities of CrmProductCategoryService."
                        },
                        {
                            "method_name": "validateProductNoDuplicate",
                            "method_signature": "private void validateProductNoDuplicate(Long id, String no)",
                            "target_class": "CrmProductMapper",
                            "rationale": "The method primarily interacts with the productMapper to check for duplicate product numbers. This fits better within the data access layer managed by CrmProductMapper."
                        }
                    ],
                    "llm_response_time": 2860
                },
                {
                    "iteration_num": -1,
                    "suggested_move_methods": [
                        {
                            "method_name": "validateProductExists",
                            "method_signature": "private validateProductExists(Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "validateProductNoDuplicate",
                            "method_signature": "private validateProductNoDuplicate(Long id, String no)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "validateProductCategoryExists",
                            "method_signature": "private validateProductCategoryExists(Long categoryId)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "selectCountByCategoryId",
                            "method_signature": "private selectCountByCategoryId(Long categoryId)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                },
                {
                    "iteration_num": -2,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectCountByCategoryId",
                            "method_signature": "private selectCountByCategoryId(Long categoryId)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "validateProductNoDuplicate",
                            "method_signature": "private validateProductNoDuplicate(Long id, String no)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "validateProductCategoryExists",
                            "method_signature": "private validateProductCategoryExists(Long categoryId)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "validateProductExists",
                            "method_signature": "private validateProductExists(Long id)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                }
            ],
            "methodCompatibilityScores": {
                "tf-idf": {
                    "private selectCountByCategoryId(Long categoryId)": {
                        "first": {
                            "method_name": "selectCountByCategoryId",
                            "method_signature": "private selectCountByCategoryId(Long categoryId)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.40903685784918786
                    },
                    "private validateProductNoDuplicate(Long id, String no)": {
                        "first": {
                            "method_name": "validateProductNoDuplicate",
                            "method_signature": "private validateProductNoDuplicate(Long id, String no)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5141915305607087
                    },
                    "private validateProductCategoryExists(Long categoryId)": {
                        "first": {
                            "method_name": "validateProductCategoryExists",
                            "method_signature": "private validateProductCategoryExists(Long categoryId)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5247250526577376
                    },
                    "private validateProductExists(Long id)": {
                        "first": {
                            "method_name": "validateProductExists",
                            "method_signature": "private validateProductExists(Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6017823529316019
                    }
                },
                "voyage": {
                    "private selectCountByCategoryId(Long categoryId)": {
                        "first": {
                            "method_name": "selectCountByCategoryId",
                            "method_signature": "private selectCountByCategoryId(Long categoryId)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5770454030750279
                    },
                    "private validateProductCategoryExists(Long categoryId)": {
                        "first": {
                            "method_name": "validateProductCategoryExists",
                            "method_signature": "private validateProductCategoryExists(Long categoryId)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6073528280514325
                    },
                    "private validateProductNoDuplicate(Long id, String no)": {
                        "first": {
                            "method_name": "validateProductNoDuplicate",
                            "method_signature": "private validateProductNoDuplicate(Long id, String no)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6086835863960137
                    },
                    "private validateProductExists(Long id)": {
                        "first": {
                            "method_name": "validateProductExists",
                            "method_signature": "private validateProductExists(Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6527682227659021
                    }
                }
            },
            "llmMethodPriority": {
                "tf-idf": {
                    "priority_method_names": [
                        "private validateProductCategoryExists(Long categoryId)",
                        "private validateProductNoDuplicate(Long id, String no)",
                        "private validateProductExists(Long id)",
                        "private selectCountByCategoryId(Long categoryId)"
                    ],
                    "llm_response_time": 3604
                },
                "tf-idf-5": {
                    "priority_method_names": [
                        "private validateProductCategoryExists(Long categoryId)",
                        "private validateProductNoDuplicate(Long id, String no)",
                        "private validateProductExists(Long id)",
                        "private selectCountByCategoryId(Long categoryId)"
                    ],
                    "llm_response_time": 0
                },
                "tf-df-3": {
                    "priority_method_names": [
                        "private validateProductCategoryExists(Long categoryId)",
                        "private validateProductNoDuplicate(Long id, String no)",
                        "private selectCountByCategoryId(Long categoryId)"
                    ],
                    "llm_response_time": 4368
                },
                "voyage": {
                    "priority_method_names": [
                        "private validateProductCategoryExists(Long categoryId)",
                        "private validateProductNoDuplicate(Long id, String no)",
                        "private validateProductExists(Long id)",
                        "private selectCountByCategoryId(Long categoryId)"
                    ],
                    "llm_response_time": 4111
                },
                "voyage-5": {
                    "priority_method_names": [
                        "private validateProductCategoryExists(Long categoryId)",
                        "private validateProductNoDuplicate(Long id, String no)",
                        "private validateProductExists(Long id)",
                        "private selectCountByCategoryId(Long categoryId)"
                    ],
                    "llm_response_time": 0
                },
                "voyage-3": {
                    "priority_method_names": [
                        "private validateProductCategoryExists(Long categoryId)",
                        "private validateProductNoDuplicate(Long id, String no)",
                        "private selectCountByCategoryId(Long categoryId)"
                    ],
                    "llm_response_time": 2959
                }
            },
            "targetClassMap": {
                "selectCountByCategoryId": {
                    "target_classes": [
                        {
                            "class_name": "CrmProductMapper",
                            "similarity_score": 0.3105295017040594
                        },
                        {
                            "class_name": "CrmProductCategoryService",
                            "similarity_score": 0.021693045781865615
                        },
                        {
                            "class_name": "CrmPermissionService",
                            "similarity_score": 0.00929278138329161
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.05170312670923474
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmProductMapper",
                        "CrmProductCategoryService",
                        "AdminUserApi"
                    ],
                    "llm_response_time": 2543,
                    "similarity_computation_time": 2,
                    "similarity_metric": "cosine"
                },
                "validateProductNoDuplicate": {
                    "target_classes": [
                        {
                            "class_name": "CrmProductMapper",
                            "similarity_score": 0.314970394174356
                        },
                        {
                            "class_name": "CrmProductCategoryService",
                            "similarity_score": 0.03960590171906697
                        },
                        {
                            "class_name": "CrmPermissionService",
                            "similarity_score": 0.033932439903952505
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.06742611617189456
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmProductMapper",
                        "CrmProductCategoryService",
                        "AdminUserApi"
                    ],
                    "llm_response_time": 3549,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "validateProductCategoryExists": {
                    "target_classes": [
                        {
                            "class_name": "CrmProductMapper",
                            "similarity_score": 0.30240736837950305
                        },
                        {
                            "class_name": "CrmProductCategoryService",
                            "similarity_score": 0.05118906968889914
                        },
                        {
                            "class_name": "CrmPermissionService",
                            "similarity_score": 0.03445855561783899
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.07469623053489781
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmProductCategoryService",
                        "CrmProductMapper",
                        "AdminUserApi"
                    ],
                    "llm_response_time": 3448,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "validateProductExists": {
                    "target_classes": [
                        {
                            "class_name": "CrmProductMapper",
                            "similarity_score": 0.363766418634276
                        },
                        {
                            "class_name": "CrmProductCategoryService",
                            "similarity_score": 0.0269069117598525
                        },
                        {
                            "class_name": "CrmPermissionService",
                            "similarity_score": 0.011526276724721124
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.06871053855870159
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmProductMapper",
                        "CrmProductCategoryService",
                        "AdminUserApi"
                    ],
                    "llm_response_time": 3280,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                }
            }
        }
    },
    {
        "repository": "https://github.com/YunaiV/ruoyi-vue-pro.git",
        "sha1": "29f1eb2c184bf7485734d8f869a236bab337fe25",
        "url": "https://github.com/YunaiV/ruoyi-vue-pro/commit/29f1eb2c184bf7485734d8f869a236bab337fe25",
        "move_method_refactoring": {
            "type": "Extract And Move Method",
            "description": "Extract And Move Method public getBusinessMap(ids Collection<Long>) : Map<Long,CrmBusinessDO> extracted from private buildContractDetailList(contractList List<CrmContractDO>) : List<CrmContractRespVO> in class cn.iocoder.yudao.module.crm.controller.admin.contract.CrmContractController & moved to class cn.iocoder.yudao.module.crm.service.business.CrmBusinessService",
            "leftSideLocations": [
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/controller/admin/contract/CrmContractController.java",
                    "startLine": 169,
                    "endLine": 208,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration before extraction",
                    "codeElement": "private buildContractDetailList(contractList List<CrmContractDO>) : List<CrmContractRespVO>"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/controller/admin/contract/CrmContractController.java",
                    "startLine": 191,
                    "endLine": 191,
                    "startColumn": 49,
                    "endColumn": 69,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/controller/admin/contract/CrmContractController.java",
                    "startLine": 190,
                    "endLine": 191,
                    "startColumn": 9,
                    "endColumn": 71,
                    "codeElementType": "VARIABLE_DECLARATION_STATEMENT",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                }
            ],
            "rightSideLocations": [
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/business/CrmBusinessService.java",
                    "startLine": 109,
                    "endLine": 117,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "extracted method declaration",
                    "codeElement": "public getBusinessMap(ids Collection<Long>) : Map<Long,CrmBusinessDO>"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/business/CrmBusinessService.java",
                    "startLine": 116,
                    "endLine": 116,
                    "startColumn": 49,
                    "endColumn": 69,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/business/CrmBusinessService.java",
                    "startLine": 116,
                    "endLine": 116,
                    "startColumn": 9,
                    "endColumn": 71,
                    "codeElementType": "RETURN_STATEMENT",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/controller/admin/contract/CrmContractController.java",
                    "startLine": 169,
                    "endLine": 208,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration after extraction",
                    "codeElement": "private buildContractDetailList(contractList List<CrmContractDO>) : List<CrmContractRespVO>"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/controller/admin/contract/CrmContractController.java",
                    "startLine": 190,
                    "endLine": 191,
                    "startColumn": 48,
                    "endColumn": 72,
                    "codeElementType": "METHOD_INVOCATION",
                    "description": "extracted method invocation",
                    "codeElement": "businessService.getBusinessMap(convertSet(contractList,CrmContractDO::getBusinessId))"
                }
            ],
            "isStatic": false
        },
        "ref_id": 7,
        "extraction_results": {
            "success": true,
            "newCommitHash": "c23e6e9b1d38db1fe7080082c573e1dfcc9c77b7",
            "newBranchName": "extract-getBusinessMap-buildContractDetailList-3f8fa6b"
        },
        "telemetry": {
            "id": "20d2d170-7811-4017-84cc-a277af1f9570",
            "hostFunctionTelemetryData": {
                "hostFunctionSize": 175,
                "lineStart": 52,
                "lineEnd": 226,
                "bodyLineStart": 52,
                "language": "java",
                "filePath": "/Users/abhiram/Documents/TBE/evaluation_projects/ruoyi-vue-pro/yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/controller/admin/contract/CrmContractController.java",
                "sourceCode": "@Tag(name = \"\u7ba1\u7406\u540e\u53f0 - CRM \u5408\u540c\")\n@RestController\n@RequestMapping(\"/crm/contract\")\n@Validated\npublic class CrmContractController {\n\n    @Resource\n    private CrmContractService contractService;\n    @Resource\n    private CrmCustomerService customerService;\n    @Resource\n    private CrmContactService contactService;\n    @Resource\n    private CrmBusinessService businessService;\n    @Resource\n    private CrmProductService productService;\n\n    @Resource\n    private AdminUserApi adminUserApi;\n    @Resource\n    private DeptApi deptApi;\n\n    @PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:create')\")\n    public CommonResult<Long> createContract(@Valid @RequestBody CrmContractSaveReqVO createReqVO) {\n        return success(contractService.createContract(createReqVO, getLoginUserId()));\n    }\n\n    @PutMapping(\"/update\")\n    @Operation(summary = \"\u66f4\u65b0\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public CommonResult<Boolean> updateContract(@Valid @RequestBody CrmContractSaveReqVO updateReqVO) {\n        contractService.updateContract(updateReqVO);\n        return success(true);\n    }\n\n    @DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:delete')\")\n    public CommonResult<Boolean> deleteContract(@RequestParam(\"id\") Long id) {\n        contractService.deleteContract(id);\n        return success(true);\n    }\n\n    @GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public CommonResult<CrmContractRespVO> getContract(@RequestParam(\"id\") Long id) {\n        CrmContractDO contract = contractService.getContract(id);\n        return success(buildContractDetail(contract));\n    }\n\n    private CrmContractRespVO buildContractDetail(CrmContractDO contract) {\n        if (contract == null) {\n            return null;\n        }\n        CrmContractRespVO contractVO = buildContractDetailList(singletonList(contract)).get(0);\n        // \u62fc\u63a5\u4ea7\u54c1\u9879\n        List<CrmContractProductDO> businessProducts = contractService.getContractProductListByContractId(contractVO.getId());\n        Map<Long, CrmProductDO> productMap = productService.getProductMap(\n                convertSet(businessProducts, CrmContractProductDO::getProductId));\n        contractVO.setProducts(BeanUtils.toBean(businessProducts, CrmContractRespVO.Product.class, businessProductVO ->\n                MapUtils.findAndThen(productMap, businessProductVO.getProductId(),\n                        product -> businessProductVO.setProductName(product.getName())\n                                .setProductNo(product.getNo()).setProductUnit(product.getUnit()))));\n        return contractVO;\n    }\n\n    @GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public CommonResult<PageResult<CrmContractRespVO>> getContractPage(@Valid CrmContractPageReqVO pageVO) {\n        PageResult<CrmContractDO> pageResult = contractService.getContractPage(pageVO, getLoginUserId());\n        return success(BeanUtils.toBean(pageResult, CrmContractRespVO.class).setList(buildContractDetailList(pageResult.getList())));\n    }\n\n    @GetMapping(\"/page-by-customer\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\uff0c\u57fa\u4e8e\u6307\u5b9a\u5ba2\u6237\")\n    public CommonResult<PageResult<CrmContractRespVO>> getContractPageByCustomer(@Valid CrmContractPageReqVO pageVO) {\n        Assert.notNull(pageVO.getCustomerId(), \"\u5ba2\u6237\u7f16\u53f7\u4e0d\u80fd\u4e3a\u7a7a\");\n        PageResult<CrmContractDO> pageResult = contractService.getContractPageByCustomerId(pageVO);\n        return success(BeanUtils.toBean(pageResult, CrmContractRespVO.class).setList(buildContractDetailList(pageResult.getList())));\n    }\n\n    @GetMapping(\"/export-excel\")\n    @Operation(summary = \"\u5bfc\u51fa\u5408\u540c Excel\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:export')\")\n    @OperateLog(type = EXPORT)\n    public void exportContractExcel(@Valid CrmContractPageReqVO exportReqVO,\n                                    HttpServletResponse response) throws IOException {\n        PageResult<CrmContractDO> pageResult = contractService.getContractPage(exportReqVO, getLoginUserId());\n        // \u5bfc\u51fa Excel\n        ExcelUtils.write(response, \"\u5408\u540c.xls\", \"\u6570\u636e\", CrmContractRespVO.class,\n                BeanUtils.toBean(pageResult.getList(), CrmContractRespVO.class));\n    }\n\n    @PutMapping(\"/transfer\")\n    @Operation(summary = \"\u5408\u540c\u8f6c\u79fb\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public CommonResult<Boolean> transferContract(@Valid @RequestBody CrmContractTransferReqVO reqVO) {\n        contractService.transferContract(reqVO, getLoginUserId());\n        return success(true);\n    }\n\n    @PutMapping(\"/submit\")\n    @Operation(summary = \"\u63d0\u4ea4\u5408\u540c\u5ba1\u6279\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public CommonResult<Boolean> submitContract(@RequestParam(\"id\") Long id) {\n        contractService.submitContract(id, getLoginUserId());\n        return success(true);\n    }\n\n    /**\n     * \u6784\u5efa\u8be6\u7ec6\u7684\u5408\u540c\u7ed3\u679c\n     *\n     * @param contractList \u539f\u59cb\u5408\u540c\u4fe1\u606f\n     * @return \u7ec6\u7684\u5408\u540c\u7ed3\u679c\n     */\n    private List<CrmContractRespVO> buildContractDetailList(List<CrmContractDO> contractList) {\n        if (CollUtil.isEmpty(contractList)) {\n            return Collections.emptyList();\n        }\n        // 1.1 \u83b7\u53d6\u5ba2\u6237\u5217\u8868\n        Map<Long, CrmCustomerDO> customerMap = customerService.getCustomerMap(\n                convertSet(contractList, CrmContractDO::getCustomerId));\n        // 1.2 \u83b7\u53d6\u521b\u5efa\u4eba\u3001\u8d1f\u8d23\u4eba\u5217\u8868\n        Map<Long, AdminUserRespDTO> userMap = adminUserApi.getUserMap(convertListByFlatMap(contractList,\n                contact -> Stream.of(NumberUtils.parseLong(contact.getCreator()), contact.getOwnerUserId())));\n        Map<Long, DeptRespDTO> deptMap = deptApi.getDeptMap(convertSet(userMap.values(), AdminUserRespDTO::getDeptId));\n        // 1.3 \u83b7\u53d6\u8054\u7cfb\u4eba\n        Map<Long, CrmContactDO> contactMap = convertMap(contactService.getContactList(convertSet(contractList,\n                CrmContractDO::getSignContactId)), CrmContactDO::getId);\n        // 1.4 \u83b7\u53d6\u5546\u673a\n        Map<Long, CrmBusinessDO> businessMap = getBusinessMap(convertSet(contractList,\n                CrmContractDO::getBusinessId));\n        // 2. \u62fc\u63a5\u6570\u636e\n        return BeanUtils.toBean(contractList, CrmContractRespVO.class, contractVO -> {\n            // 2.1 \u8bbe\u7f6e\u5ba2\u6237\u4fe1\u606f\n            findAndThen(customerMap, contractVO.getCustomerId(), customer -> contractVO.setCustomerName(customer.getName()));\n            // 2.2 \u8bbe\u7f6e\u7528\u6237\u4fe1\u606f\n            findAndThen(userMap, Long.parseLong(contractVO.getCreator()), user -> contractVO.setCreatorName(user.getNickname()));\n            MapUtils.findAndThen(userMap, contractVO.getOwnerUserId(), user -> {\n                contractVO.setOwnerUserName(user.getNickname());\n                MapUtils.findAndThen(deptMap, user.getDeptId(), dept -> contractVO.setOwnerUserDeptName(dept.getName()));\n            });\n            findAndThen(userMap, contractVO.getSignUserId(), user -> contractVO.setSignUserName(user.getNickname()));\n            // 2.3 \u8bbe\u7f6e\u8054\u7cfb\u4eba\u4fe1\u606f\n            findAndThen(contactMap, contractVO.getSignContactId(), contact -> contractVO.setSignContactName(contact.getName()));\n            // 2.4 \u8bbe\u7f6e\u5546\u673a\u4fe1\u606f\n            findAndThen(businessMap, contractVO.getBusinessId(), business -> contractVO.setBusinessName(business.getName()));\n        });\n    }\n\n    private Map<Long, CrmBusinessDO> getBusinessMap(Collection<Long> ids) {\n        return convertMap(businessService.getBusinessList(ids), CrmBusinessDO::getId);\n    }\n\n    @GetMapping(\"/check-contract-count\")\n    @Operation(summary = \"\u83b7\u5f97\u5f85\u5ba1\u6838\u5408\u540c\u6570\u91cf\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public CommonResult<Long> getCheckContractCount() {\n        return success(contractService.getCheckContractCount(getLoginUserId()));\n    }\n\n    @GetMapping(\"/end-contract-count\")\n    @Operation(summary = \"\u83b7\u5f97\u5373\u5c06\u5230\u671f\u7684\u5408\u540c\u6570\u91cf\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public CommonResult<Long> getEndContractCount() {\n        return success(contractService.getEndContractCount(getLoginUserId()));\n    }\n\n}",
                "methodCount": 14
            },
            "candidatesTelemetryData": {
                "numberOfSuggestions": 12,
                "candidates": [
                    {
                        "lineStart": 166,
                        "lineEnd": 205,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method buildContractDetailList to class AdminUserApi",
                        "description": "Move method buildContractDetailList to cn.iocoder.yudao.module.system.api.user.AdminUserApi\nRationale: The method 'buildContractDetailList' involves gathering user-related information using 'adminUserApi'. This includes fetching user maps and associated department information, which aligns well with the responsibilities of the AdminUserApi class. Given that much of the data manipulation within this method involves users and departments, AdminUserApi seems like the most logical destination. Moving it here ensures better cohesion and more logical organization of user-related data processing.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 207,
                        "lineEnd": 209,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method getBusinessMap to class CrmProductService",
                        "description": "Move method getBusinessMap to cn.iocoder.yudao.module.crm.service.product.CrmProductService\nRationale: The method getBusinessMap() fetches business data using businessService and converts it to a map. This functionality closely aligns with the operations found in CrmProductService which already has similar methods for other business objects. The getProductMap() method in CrmProductService performs a very similar function, fetching product data and converting it to a map, indicating CrmProductService is a good fit for this method.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 73,
                        "lineEnd": 78,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method createContract to class CrmProductService",
                        "description": "Move method createContract to cn.iocoder.yudao.module.crm.service.product.CrmProductService\nRationale: The method `createContract` seems to be related to CRM operations, and the `CrmProductService` interface already handles creation and updating of CRM-related entities (products). Including contract operations within the same service aligns with the single responsibility principle, which states that a class should have only one reason to change. Since CrmProductService deals with product operations in the CRM domain, it is logical to handle contract operations there as well, ensuring cohesive functionality related to CRM is encapsulated within one service.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 138,
                        "lineEnd": 148,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method exportContractExcel to class CrmProductService",
                        "description": "Move method exportContractExcel to cn.iocoder.yudao.module.crm.service.product.CrmProductService\nRationale: The exportContractExcel() method is heavily related to CRM functionality, specifically contracts. The CrmProductService interface already deals with CRM-related operations, such as product management within the CRM context. Therefore, moving this method to CrmProductService would be logical and consistent since it aligns well with the nature of CRM operations. Additionally, it keeps all CRM-related functionalities encapsulated within one service, making the codebase more organized and maintainable.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 150,
                        "lineEnd": 156,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method transferContract to class AdminUserApi",
                        "description": "Move method transferContract to cn.iocoder.yudao.module.system.api.user.AdminUserApi\nRationale: The transferContract method involves operations related to CRM contracts and users, as it requires authorizing a user by permission and involves the current logged-in user ID. The AdminUserApi interface already deals with user-related operations such as getting user information and validating users, which aligns with the user-related aspects of the transferContract method.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 80,
                        "lineEnd": 86,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method updateContract to class CrmProductService",
                        "description": "Move method updateContract to cn.iocoder.yudao.module.crm.service.product.CrmProductService\nRationale: The updateContract method clearly deals with updating a contract, which is likely related to CRM (Customer Relationship Management) functionality. The CrmProductService class is directly within the CRM domain, and it already contains a method related to updating products, which is somewhat analogous to updating contracts. Therefore, it makes sense to move updateContract to CrmProductService, as it fits the CRM context better than the other options involving departments or users.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 158,
                        "lineEnd": 164,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method submitContract to class CrmBusinessService",
                        "description": "Move method submitContract to cn.iocoder.yudao.module.crm.service.business.CrmBusinessService\nRationale: The method submitContract() is closely related to CRM operations as it deals with contract submission, which is part of CRM business logic. Moving the method to CrmBusinessService would align well with the related operations already present in the class, such as creating, updating, and validating business entries. It ensures that CRM-related behaviors remain encapsulated within the CRM service.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 130,
                        "lineEnd": 136,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method getContractPageByCustomer to class CrmProductService",
                        "description": "Move method getContractPageByCustomer to cn.iocoder.yudao.module.crm.service.product.CrmProductService\nRationale: The method getContractPageByCustomer has a strong connection with the CRM domain, specifically dealing with contracts, which are likely linked to products and customers. Although CrmProductService focuses on products, extending it to include contract-related functionalities (especially since it deals with customers) may allow for streamlined CRM operations without the need to introduce a completely new service.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 106,
                        "lineEnd": 120,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method buildContractDetail to class CrmProductService",
                        "description": "Move method buildContractDetail to cn.iocoder.yudao.module.crm.service.product.CrmProductService\nRationale: The method `buildContractDetail` is heavily focused on constructing detailed contract information, including details about the products associated with a contract. Since this method utilizes the productService for fetching product details, and is related to contracts, which are a part of the CRM (Customer Relationship Management) system, it is more appropriate for it to reside in a service class closely related to the domain it operates on. The CrmProductService is the best fit since it is already designed to handle product-related functionalities within the CRM context.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 122,
                        "lineEnd": 128,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method getContractPage to class CrmProductService",
                        "description": "Move method getContractPage to cn.iocoder.yudao.module.crm.service.product.CrmProductService\nRationale: The method getContractPage is closely related to CRM (Customer Relationship Management) operations, as indicated by the use of getLoginUserId() in the method body and its return type, which involves CRM-specific data objects like CrmContractRespVO and PageResult. CrmProductService already manages various CRM-specific entities and operations such as creating products, updating products, and fetching product pages, making it an appropriate location for this method. Although it deals mainly with products, adding contract-related management would be a cohesive extension of its current responsibilities.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 97,
                        "lineEnd": 104,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method getContract to class CrmBusinessService",
                        "description": "Move method getContract to cn.iocoder.yudao.module.crm.service.business.CrmBusinessService\nRationale: The `getContract` method is related to CRM operations by fetching contract information, which fits well within the scope of `CrmBusinessService` given its focus on CRM activities like business opportunities and customer relationships. This class already handles various CRM functionalities, making it a natural fit for the contract-related method, ensuring cohesiveness and better maintainability.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 88,
                        "lineEnd": 95,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method deleteContract to class CrmBusinessService",
                        "description": "Move method deleteContract to cn.iocoder.yudao.module.crm.service.business.CrmBusinessService\nRationale: The 'deleteContract' method aligns closely with the tasks handled by the CrmBusinessService class, which also involves managing entities related to business transactions such as creating, updating, and deleting business opportunities. Moving the method here will maintain consistency in handling CRM-related entities and operations, avoiding scattering similar functionalities across unrelated classes.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    }
                ]
            },
            "iterationData": [
                {
                    "iteration_num": 1,
                    "suggested_move_methods": [
                        {
                            "method_name": "buildContractDetail",
                            "method_signature": "private CrmContractRespVO buildContractDetail(CrmContractDO contract)",
                            "target_class": "CrmContractService",
                            "rationale": "buildContractDetail method is processing specific contract details and should be part of the service layer to separate concerns and improve the controller's cohesiveness."
                        },
                        {
                            "method_name": "buildContractDetailList",
                            "method_signature": "private List<CrmContractRespVO> buildContractDetailList(List<CrmContractDO> contractList)",
                            "target_class": "CrmContractService",
                            "rationale": "buildContractDetailList method is responsible for building detailed contract response objects, it is closely related to CrmContractService, hence it should be moved there to keep the controller focused solely on handling HTTP requests."
                        },
                        {
                            "method_name": "getBusinessMap",
                            "method_signature": "private Map<Long, CrmBusinessDO> getBusinessMap(Collection<Long> ids)",
                            "target_class": "CrmBusinessService",
                            "rationale": "getBusinessMap method deals with CrmBusinessDO objects and their IDs, making it a natural fit for the service layer, particularly CrmBusinessService."
                        }
                    ],
                    "llm_response_time": 2978
                },
                {
                    "iteration_num": 2,
                    "suggested_move_methods": [
                        {
                            "method_name": "buildContractDetail",
                            "method_signature": "private CrmContractRespVO buildContractDetail(CrmContractDO contract)",
                            "target_class": "CrmContractService",
                            "rationale": "The method `buildContractDetail` is transforming `CrmContractDO` into `CrmContractRespVO`, which is heavily related to the business logic of contracts and products. It would be more appropriate to move this method to `CrmContractService` to keep the controller lean and focused on handling HTTP requests and responses."
                        },
                        {
                            "method_name": "buildContractDetailList",
                            "method_signature": "private List<CrmContractRespVO> buildContractDetailList(List<CrmContractDO> contractList)",
                            "target_class": "CrmContractService",
                            "rationale": "The method `buildContractDetailList` constructs a detailed list of contract response objects, heavily interacting with other services to build the response. This type of logic is better placed in the `CrmContractService` class, where it can be reused and to keep the controller focused on handling HTTP requests."
                        },
                        {
                            "method_name": "getBusinessMap",
                            "method_signature": "private Map<Long, CrmBusinessDO> getBusinessMap(Collection<Long> ids)",
                            "target_class": "CrmBusinessService",
                            "rationale": "The method `getBusinessMap` retrieves a map of business objects based on their IDs using the `businessService`. This operation is closely tied to business logic and is better suited in the `CrmBusinessService` class."
                        }
                    ],
                    "llm_response_time": 4058
                },
                {
                    "iteration_num": 3,
                    "suggested_move_methods": [
                        {
                            "method_name": "buildContractDetail",
                            "method_signature": "private CrmContractRespVO buildContractDetail(CrmContractDO contract)",
                            "target_class": "CrmContractService",
                            "rationale": "The buildContractDetail method is focused on transforming data related to contracts. This is more aligned with the service layer where the business logic and data transformations for contracts should reside."
                        },
                        {
                            "method_name": "buildContractDetailList",
                            "method_signature": "private List<CrmContractRespVO> buildContractDetailList(List<CrmContractDO> contractList)",
                            "target_class": "CrmContractService",
                            "rationale": "Similar to buildContractDetail, this method is responsible for data transformation of contract lists and should be placed in the service layer for better cohesion and separation of concerns."
                        },
                        {
                            "method_name": "getBusinessMap",
                            "method_signature": "private Map<Long, CrmBusinessDO> getBusinessMap(Collection<Long> ids)",
                            "target_class": "CrmBusinessService",
                            "rationale": "The getBusinessMap method deals with retrieving a map of business entities. This responsibility should belong to the CrmBusinessService, which is already handling business-related operations."
                        }
                    ],
                    "llm_response_time": 3798
                },
                {
                    "iteration_num": -1,
                    "suggested_move_methods": [
                        {
                            "method_name": "createContract",
                            "method_signature": "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:create')\")\n    public createContract(@Valid @RequestBody CrmContractSaveReqVO createReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "updateContract",
                            "method_signature": "@PutMapping(\"/update\")\n    @Operation(summary = \"\u66f4\u65b0\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public updateContract(@Valid @RequestBody CrmContractSaveReqVO updateReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "deleteContract",
                            "method_signature": "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:delete')\")\n    public deleteContract(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getContract",
                            "method_signature": "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContract(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "buildContractDetail",
                            "method_signature": "private buildContractDetail(CrmContractDO contract)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getContractPage",
                            "method_signature": "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContractPage(@Valid CrmContractPageReqVO pageVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getContractPageByCustomer",
                            "method_signature": "@GetMapping(\"/page-by-customer\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\uff0c\u57fa\u4e8e\u6307\u5b9a\u5ba2\u6237\")\n    public getContractPageByCustomer(@Valid CrmContractPageReqVO pageVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "exportContractExcel",
                            "method_signature": "@GetMapping(\"/export-excel\")\n    @Operation(summary = \"\u5bfc\u51fa\u5408\u540c Excel\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:export')\")\n    @OperateLog(type = EXPORT)\n    public exportContractExcel(@Valid CrmContractPageReqVO exportReqVO,\n                                    HttpServletResponse response)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "transferContract",
                            "method_signature": "@PutMapping(\"/transfer\")\n    @Operation(summary = \"\u5408\u540c\u8f6c\u79fb\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public transferContract(@Valid @RequestBody CrmContractTransferReqVO reqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "submitContract",
                            "method_signature": "@PutMapping(\"/submit\")\n    @Operation(summary = \"\u63d0\u4ea4\u5408\u540c\u5ba1\u6279\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public submitContract(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "buildContractDetailList",
                            "method_signature": "private buildContractDetailList(List<CrmContractDO> contractList)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getBusinessMap",
                            "method_signature": "private getBusinessMap(Collection<Long> ids)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                },
                {
                    "iteration_num": -2,
                    "suggested_move_methods": [
                        {
                            "method_name": "buildContractDetailList",
                            "method_signature": "private buildContractDetailList(List<CrmContractDO> contractList)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getBusinessMap",
                            "method_signature": "private getBusinessMap(Collection<Long> ids)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "createContract",
                            "method_signature": "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:create')\")\n    public createContract(@Valid @RequestBody CrmContractSaveReqVO createReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "exportContractExcel",
                            "method_signature": "@GetMapping(\"/export-excel\")\n    @Operation(summary = \"\u5bfc\u51fa\u5408\u540c Excel\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:export')\")\n    @OperateLog(type = EXPORT)\n    public exportContractExcel(@Valid CrmContractPageReqVO exportReqVO,\n                                    HttpServletResponse response)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "transferContract",
                            "method_signature": "@PutMapping(\"/transfer\")\n    @Operation(summary = \"\u5408\u540c\u8f6c\u79fb\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public transferContract(@Valid @RequestBody CrmContractTransferReqVO reqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "updateContract",
                            "method_signature": "@PutMapping(\"/update\")\n    @Operation(summary = \"\u66f4\u65b0\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public updateContract(@Valid @RequestBody CrmContractSaveReqVO updateReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "submitContract",
                            "method_signature": "@PutMapping(\"/submit\")\n    @Operation(summary = \"\u63d0\u4ea4\u5408\u540c\u5ba1\u6279\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public submitContract(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getContractPageByCustomer",
                            "method_signature": "@GetMapping(\"/page-by-customer\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\uff0c\u57fa\u4e8e\u6307\u5b9a\u5ba2\u6237\")\n    public getContractPageByCustomer(@Valid CrmContractPageReqVO pageVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "buildContractDetail",
                            "method_signature": "private buildContractDetail(CrmContractDO contract)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getContractPage",
                            "method_signature": "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContractPage(@Valid CrmContractPageReqVO pageVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getContract",
                            "method_signature": "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContract(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "deleteContract",
                            "method_signature": "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:delete')\")\n    public deleteContract(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                }
            ],
            "methodCompatibilityScores": {
                "tf-idf": {
                    "private buildContractDetailList(List<CrmContractDO> contractList)": {
                        "first": {
                            "method_name": "buildContractDetailList",
                            "method_signature": "private buildContractDetailList(List<CrmContractDO> contractList)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.36213865985714194
                    },
                    "private getBusinessMap(Collection<Long> ids)": {
                        "first": {
                            "method_name": "getBusinessMap",
                            "method_signature": "private getBusinessMap(Collection<Long> ids)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.37543276244763724
                    },
                    "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:create')\")\n    public createContract(@Valid @RequestBody CrmContractSaveReqVO createReqVO)": {
                        "first": {
                            "method_name": "createContract",
                            "method_signature": "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:create')\")\n    public createContract(@Valid @RequestBody CrmContractSaveReqVO createReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.4944914801982381
                    },
                    "@GetMapping(\"/export-excel\")\n    @Operation(summary = \"\u5bfc\u51fa\u5408\u540c Excel\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:export')\")\n    @OperateLog(type = EXPORT)\n    public exportContractExcel(@Valid CrmContractPageReqVO exportReqVO,\n                                    HttpServletResponse response)": {
                        "first": {
                            "method_name": "exportContractExcel",
                            "method_signature": "@GetMapping(\"/export-excel\")\n    @Operation(summary = \"\u5bfc\u51fa\u5408\u540c Excel\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:export')\")\n    @OperateLog(type = EXPORT)\n    public exportContractExcel(@Valid CrmContractPageReqVO exportReqVO,\n                                    HttpServletResponse response)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.49478624964303614
                    },
                    "@PutMapping(\"/transfer\")\n    @Operation(summary = \"\u5408\u540c\u8f6c\u79fb\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public transferContract(@Valid @RequestBody CrmContractTransferReqVO reqVO)": {
                        "first": {
                            "method_name": "transferContract",
                            "method_signature": "@PutMapping(\"/transfer\")\n    @Operation(summary = \"\u5408\u540c\u8f6c\u79fb\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public transferContract(@Valid @RequestBody CrmContractTransferReqVO reqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5178421872567248
                    },
                    "@PutMapping(\"/update\")\n    @Operation(summary = \"\u66f4\u65b0\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public updateContract(@Valid @RequestBody CrmContractSaveReqVO updateReqVO)": {
                        "first": {
                            "method_name": "updateContract",
                            "method_signature": "@PutMapping(\"/update\")\n    @Operation(summary = \"\u66f4\u65b0\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public updateContract(@Valid @RequestBody CrmContractSaveReqVO updateReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5238647230344056
                    },
                    "@PutMapping(\"/submit\")\n    @Operation(summary = \"\u63d0\u4ea4\u5408\u540c\u5ba1\u6279\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public submitContract(@RequestParam(\"id\") Long id)": {
                        "first": {
                            "method_name": "submitContract",
                            "method_signature": "@PutMapping(\"/submit\")\n    @Operation(summary = \"\u63d0\u4ea4\u5408\u540c\u5ba1\u6279\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public submitContract(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5435180782256583
                    },
                    "@GetMapping(\"/page-by-customer\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\uff0c\u57fa\u4e8e\u6307\u5b9a\u5ba2\u6237\")\n    public getContractPageByCustomer(@Valid CrmContractPageReqVO pageVO)": {
                        "first": {
                            "method_name": "getContractPageByCustomer",
                            "method_signature": "@GetMapping(\"/page-by-customer\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\uff0c\u57fa\u4e8e\u6307\u5b9a\u5ba2\u6237\")\n    public getContractPageByCustomer(@Valid CrmContractPageReqVO pageVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5657328617103455
                    },
                    "private buildContractDetail(CrmContractDO contract)": {
                        "first": {
                            "method_name": "buildContractDetail",
                            "method_signature": "private buildContractDetail(CrmContractDO contract)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5733563623610192
                    },
                    "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContractPage(@Valid CrmContractPageReqVO pageVO)": {
                        "first": {
                            "method_name": "getContractPage",
                            "method_signature": "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContractPage(@Valid CrmContractPageReqVO pageVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5914476551339743
                    },
                    "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContract(@RequestParam(\"id\") Long id)": {
                        "first": {
                            "method_name": "getContract",
                            "method_signature": "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContract(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6107111653556366
                    },
                    "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:delete')\")\n    public deleteContract(@RequestParam(\"id\") Long id)": {
                        "first": {
                            "method_name": "deleteContract",
                            "method_signature": "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:delete')\")\n    public deleteContract(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6386838743880496
                    }
                },
                "voyage": {
                    "private getBusinessMap(Collection<Long> ids)": {
                        "first": {
                            "method_name": "getBusinessMap",
                            "method_signature": "private getBusinessMap(Collection<Long> ids)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.48536122437919066
                    },
                    "private buildContractDetailList(List<CrmContractDO> contractList)": {
                        "first": {
                            "method_name": "buildContractDetailList",
                            "method_signature": "private buildContractDetailList(List<CrmContractDO> contractList)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6858141129492182
                    },
                    "private buildContractDetail(CrmContractDO contract)": {
                        "first": {
                            "method_name": "buildContractDetail",
                            "method_signature": "private buildContractDetail(CrmContractDO contract)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6975307249975632
                    },
                    "@PutMapping(\"/transfer\")\n    @Operation(summary = \"\u5408\u540c\u8f6c\u79fb\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public transferContract(@Valid @RequestBody CrmContractTransferReqVO reqVO)": {
                        "first": {
                            "method_name": "transferContract",
                            "method_signature": "@PutMapping(\"/transfer\")\n    @Operation(summary = \"\u5408\u540c\u8f6c\u79fb\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public transferContract(@Valid @RequestBody CrmContractTransferReqVO reqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.700908327156133
                    },
                    "@PutMapping(\"/submit\")\n    @Operation(summary = \"\u63d0\u4ea4\u5408\u540c\u5ba1\u6279\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public submitContract(@RequestParam(\"id\") Long id)": {
                        "first": {
                            "method_name": "submitContract",
                            "method_signature": "@PutMapping(\"/submit\")\n    @Operation(summary = \"\u63d0\u4ea4\u5408\u540c\u5ba1\u6279\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public submitContract(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.713155780121244
                    },
                    "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:delete')\")\n    public deleteContract(@RequestParam(\"id\") Long id)": {
                        "first": {
                            "method_name": "deleteContract",
                            "method_signature": "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:delete')\")\n    public deleteContract(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.7149039497091905
                    },
                    "@PutMapping(\"/update\")\n    @Operation(summary = \"\u66f4\u65b0\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public updateContract(@Valid @RequestBody CrmContractSaveReqVO updateReqVO)": {
                        "first": {
                            "method_name": "updateContract",
                            "method_signature": "@PutMapping(\"/update\")\n    @Operation(summary = \"\u66f4\u65b0\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public updateContract(@Valid @RequestBody CrmContractSaveReqVO updateReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.7261946473231109
                    },
                    "@GetMapping(\"/export-excel\")\n    @Operation(summary = \"\u5bfc\u51fa\u5408\u540c Excel\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:export')\")\n    @OperateLog(type = EXPORT)\n    public exportContractExcel(@Valid CrmContractPageReqVO exportReqVO,\n                                    HttpServletResponse response)": {
                        "first": {
                            "method_name": "exportContractExcel",
                            "method_signature": "@GetMapping(\"/export-excel\")\n    @Operation(summary = \"\u5bfc\u51fa\u5408\u540c Excel\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:export')\")\n    @OperateLog(type = EXPORT)\n    public exportContractExcel(@Valid CrmContractPageReqVO exportReqVO,\n                                    HttpServletResponse response)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.7293510211797753
                    },
                    "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:create')\")\n    public createContract(@Valid @RequestBody CrmContractSaveReqVO createReqVO)": {
                        "first": {
                            "method_name": "createContract",
                            "method_signature": "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:create')\")\n    public createContract(@Valid @RequestBody CrmContractSaveReqVO createReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.7587464222233187
                    },
                    "@GetMapping(\"/page-by-customer\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\uff0c\u57fa\u4e8e\u6307\u5b9a\u5ba2\u6237\")\n    public getContractPageByCustomer(@Valid CrmContractPageReqVO pageVO)": {
                        "first": {
                            "method_name": "getContractPageByCustomer",
                            "method_signature": "@GetMapping(\"/page-by-customer\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\uff0c\u57fa\u4e8e\u6307\u5b9a\u5ba2\u6237\")\n    public getContractPageByCustomer(@Valid CrmContractPageReqVO pageVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.7792358462019817
                    },
                    "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContract(@RequestParam(\"id\") Long id)": {
                        "first": {
                            "method_name": "getContract",
                            "method_signature": "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContract(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.807943840072921
                    },
                    "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContractPage(@Valid CrmContractPageReqVO pageVO)": {
                        "first": {
                            "method_name": "getContractPage",
                            "method_signature": "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContractPage(@Valid CrmContractPageReqVO pageVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.8142795302401723
                    }
                }
            },
            "llmMethodPriority": {
                "tf-idf": {
                    "priority_method_names": [
                        "private buildContractDetailList(List<CrmContractDO> contractList)",
                        "private buildContractDetail(CrmContractDO contract)",
                        "private getBusinessMap(Collection<Long> ids)",
                        "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:create')\")\n    public createContract(@Valid @RequestBody CrmContractSaveReqVO createReqVO)",
                        "@PutMapping(\"/update\")\n    @Operation(summary = \"\u66f4\u65b0\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public updateContract(@Valid @RequestBody CrmContractSaveReqVO updateReqVO)",
                        "@PutMapping(\"/transfer\")\n    @Operation(summary = \"\u5408\u540c\u8f6c\u79fb\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public transferContract(@Valid @RequestBody CrmContractTransferReqVO reqVO)",
                        "@PutMapping(\"/submit\")\n    @Operation(summary = \"\u63d0\u4ea4\u5408\u540c\u5ba1\u6279\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public submitContract(@RequestParam(\"id\") Long id)",
                        "@GetMapping(\"/export-excel\")\n    @Operation(summary = \"\u5bfc\u51fa\u5408\u540c Excel\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:export')\")\n    @OperateLog(type = EXPORT)\n    public exportContractExcel(@Valid CrmContractPageReqVO exportReqVO,\n                                    HttpServletResponse response)",
                        "@GetMapping(\"/page-by-customer\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\uff0c\u57fa\u4e8e\u6307\u5b9a\u5ba2\u6237\")\n    public getContractPageByCustomer(@Valid CrmContractPageReqVO pageVO)",
                        "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContractPage(@Valid CrmContractPageReqVO pageVO)",
                        "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContract(@RequestParam(\"id\") Long id)",
                        "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:delete')\")\n    public deleteContract(@RequestParam(\"id\") Long id)"
                    ],
                    "llm_response_time": 7161
                },
                "tf-idf-5": {
                    "priority_method_names": [
                        "private buildContractDetailList(List<CrmContractDO> contractList)",
                        "private getBusinessMap(Collection<Long> ids)",
                        "@GetMapping(\"/export-excel\")\n    @Operation(summary = \"\u5bfc\u51fa\u5408\u540c Excel\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:export')\")\n    @OperateLog(type = EXPORT)\n    public exportContractExcel(@Valid CrmContractPageReqVO exportReqVO,\n                                    HttpServletResponse response)",
                        "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:create')\")\n    public createContract(@Valid @RequestBody CrmContractSaveReqVO createReqVO)",
                        "@PutMapping(\"/transfer\")\n    @Operation(summary = \"\u5408\u540c\u8f6c\u79fb\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public transferContract(@Valid @RequestBody CrmContractTransferReqVO reqVO)"
                    ],
                    "llm_response_time": 5218
                },
                "tf-df-3": {
                    "priority_method_names": [
                        "private buildContractDetailList(List<CrmContractDO> contractList)",
                        "private getBusinessMap(Collection<Long> ids)",
                        "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:create')\")\n    public createContract(@Valid @RequestBody CrmContractSaveReqVO createReqVO)"
                    ],
                    "llm_response_time": 4417
                },
                "voyage": {
                    "priority_method_names": [
                        "private buildContractDetailList(List<CrmContractDO> contractList)",
                        "private buildContractDetail(CrmContractDO contract)",
                        "private getBusinessMap(Collection<Long> ids)",
                        "@PutMapping(\"/transfer\")\n    @Operation(summary = \"\u5408\u540c\u8f6c\u79fb\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public transferContract(@Valid @RequestBody CrmContractTransferReqVO reqVO)",
                        "@PutMapping(\"/submit\")\n    @Operation(summary = \"\u63d0\u4ea4\u5408\u540c\u5ba1\u6279\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public submitContract(@RequestParam(\"id\") Long id)",
                        "@PutMapping(\"/update\")\n    @Operation(summary = \"\u66f4\u65b0\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public updateContract(@Valid @RequestBody CrmContractSaveReqVO updateReqVO)",
                        "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:delete')\")\n    public deleteContract(@RequestParam(\"id\") Long id)",
                        "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u5408\u540c\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:create')\")\n    public createContract(@Valid @RequestBody CrmContractSaveReqVO createReqVO)",
                        "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContract(@RequestParam(\"id\") Long id)",
                        "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:query')\")\n    public getContractPage(@Valid CrmContractPageReqVO pageVO)",
                        "@GetMapping(\"/page-by-customer\")\n    @Operation(summary = \"\u83b7\u5f97\u5408\u540c\u5206\u9875\uff0c\u57fa\u4e8e\u6307\u5b9a\u5ba2\u6237\")\n    public getContractPageByCustomer(@Valid CrmContractPageReqVO pageVO)"
                    ],
                    "llm_response_time": 6353
                },
                "voyage-5": {
                    "priority_method_names": [
                        "private buildContractDetailList(List<CrmContractDO> contractList)",
                        "private buildContractDetail(CrmContractDO contract)",
                        "private getBusinessMap(Collection<Long> ids)",
                        "@PutMapping(\"/transfer\")\n    @Operation(summary = \"\u5408\u540c\u8f6c\u79fb\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public transferContract(@Valid @RequestBody CrmContractTransferReqVO reqVO)",
                        "@PutMapping(\"/submit\")\n    @Operation(summary = \"\u63d0\u4ea4\u5408\u540c\u5ba1\u6279\")\n    @PreAuthorize(\"@ss.hasPermission('crm:contract:update')\")\n    public submitContract(@RequestParam(\"id\") Long id)"
                    ],
                    "llm_response_time": 5545
                },
                "voyage-3": {
                    "priority_method_names": [
                        "private buildContractDetailList(List<CrmContractDO> contractList)",
                        "private buildContractDetail(CrmContractDO contract)",
                        "private getBusinessMap(Collection<Long> ids)"
                    ],
                    "llm_response_time": 3441
                }
            },
            "targetClassMap": {
                "buildContractDetailList": {
                    "target_classes": [
                        {
                            "class_name": "CrmContractService",
                            "similarity_score": 0.2326808781984565
                        },
                        {
                            "class_name": "CrmCustomerService",
                            "similarity_score": 0.2417573215857013
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.24075083057536503
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.2435148605530924
                        },
                        {
                            "class_name": "CrmProductService",
                            "similarity_score": 0.25003551250215117
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.2644214850193798
                        },
                        {
                            "class_name": "DeptApi",
                            "similarity_score": 0.27213669435471693
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "AdminUserApi",
                        "DeptApi",
                        "CrmProductService"
                    ],
                    "llm_response_time": 3362,
                    "similarity_computation_time": 2,
                    "similarity_metric": "cosine"
                },
                "getBusinessMap": {
                    "target_classes": [
                        {
                            "class_name": "CrmContractService",
                            "similarity_score": 0.007267203894385149
                        },
                        {
                            "class_name": "CrmCustomerService",
                            "similarity_score": 0.021108672772106558
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.024575779514397773
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.02720868095405743
                        },
                        {
                            "class_name": "CrmProductService",
                            "similarity_score": 0.04669780892349717
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.06647544862615896
                        },
                        {
                            "class_name": "DeptApi",
                            "similarity_score": 0.0792593923901217
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmProductService",
                        "DeptApi",
                        "AdminUserApi"
                    ],
                    "llm_response_time": 1872,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "createContract": {
                    "target_classes": [
                        {
                            "class_name": "CrmContractService",
                            "similarity_score": 0.017235687395327104
                        },
                        {
                            "class_name": "CrmCustomerService",
                            "similarity_score": 0.014303889502079378
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.016653308258486526
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.024199144859155693
                        },
                        {
                            "class_name": "CrmProductService",
                            "similarity_score": 0.03164387955805429
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.05255345653504332
                        },
                        {
                            "class_name": "DeptApi",
                            "similarity_score": 0.06266005147845038
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmProductService",
                        "AdminUserApi",
                        "DeptApi"
                    ],
                    "llm_response_time": 3236,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "exportContractExcel": {
                    "target_classes": [
                        {
                            "class_name": "CrmContractService",
                            "similarity_score": 0.01998481070955916
                        },
                        {
                            "class_name": "CrmCustomerService",
                            "similarity_score": 0.02261643511297131
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.021064953869483805
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.02210705327517166
                        },
                        {
                            "class_name": "CrmProductService",
                            "similarity_score": 0.023348904461748584
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.04431696575077264
                        },
                        {
                            "class_name": "DeptApi",
                            "similarity_score": 0.050952466536506806
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmProductService",
                        "AdminUserApi",
                        "DeptApi"
                    ],
                    "llm_response_time": 3435,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "transferContract": {
                    "target_classes": [
                        {
                            "class_name": "CrmContractService",
                            "similarity_score": 0.008360536430713009
                        },
                        {
                            "class_name": "CrmCustomerService",
                            "similarity_score": 0.013876811123349854
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.01615608210957902
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.02347661889504036
                        },
                        {
                            "class_name": "CrmProductService",
                            "similarity_score": 0.03069907242874855
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.050984341714185956
                        },
                        {
                            "class_name": "DeptApi",
                            "similarity_score": 0.06078917900053905
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "AdminUserApi",
                        "DeptApi",
                        "CrmProductService"
                    ],
                    "llm_response_time": 2682,
                    "similarity_computation_time": 2,
                    "similarity_metric": "cosine"
                },
                "updateContract": {
                    "target_classes": [
                        {
                            "class_name": "CrmCustomerService",
                            "similarity_score": 0.014303889502079378
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.016653308258486526
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.024199144859155693
                        },
                        {
                            "class_name": "CrmProductService",
                            "similarity_score": 0.03164387955805429
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.05255345653504332
                        },
                        {
                            "class_name": "DeptApi",
                            "similarity_score": 0.06266005147845038
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmProductService",
                        "AdminUserApi",
                        "DeptApi"
                    ],
                    "llm_response_time": 3095,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "submitContract": {
                    "target_classes": [
                        {
                            "class_name": "CrmContractService",
                            "similarity_score": 0.037343989356542054
                        },
                        {
                            "class_name": "CrmCustomerService",
                            "similarity_score": 0.042911668506238135
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.03608216789338747
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.043020701971832345
                        },
                        {
                            "class_name": "CrmProductService",
                            "similarity_score": 0.042191839410739056
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.058392729483381464
                        },
                        {
                            "class_name": "DeptApi",
                            "similarity_score": 0.06266005147845038
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmBusinessService",
                        "AdminUserApi",
                        "DeptApi"
                    ],
                    "llm_response_time": 3136,
                    "similarity_computation_time": 2,
                    "similarity_metric": "cosine"
                },
                "getContractPageByCustomer": {
                    "target_classes": [
                        {
                            "class_name": "CrmContractService",
                            "similarity_score": 0.012248869665217012
                        },
                        {
                            "class_name": "CrmCustomerService",
                            "similarity_score": 0.012198397954059277
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.014201989001600522
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.020637100076660725
                        },
                        {
                            "class_name": "CrmProductService",
                            "similarity_score": 0.026985991160191326
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.049797487023265204
                        },
                        {
                            "class_name": "DeptApi",
                            "similarity_score": 0.06107048165524592
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmProductService",
                        "AdminUserApi",
                        "DeptApi"
                    ],
                    "llm_response_time": 2926,
                    "similarity_computation_time": 2,
                    "similarity_metric": "cosine"
                },
                "buildContractDetail": {
                    "target_classes": [
                        {
                            "class_name": "CrmContractService",
                            "similarity_score": 0.007479651240011828
                        },
                        {
                            "class_name": "CrmCustomerService",
                            "similarity_score": 0.014897662376526026
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.01589922448693569
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.025203682527045457
                        },
                        {
                            "class_name": "CrmProductService",
                            "similarity_score": 0.03295745775097154
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.05473501819660281
                        },
                        {
                            "class_name": "DeptApi",
                            "similarity_score": 0.06526115091185454
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmProductService",
                        "AdminUserApi",
                        "DeptApi"
                    ],
                    "llm_response_time": 4321,
                    "similarity_computation_time": 2,
                    "similarity_metric": "cosine"
                },
                "getContractPage": {
                    "target_classes": [
                        {
                            "class_name": "CrmContractService",
                            "similarity_score": 0.012248869665217012
                        },
                        {
                            "class_name": "CrmCustomerService",
                            "similarity_score": 0.012198397954059277
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.014201989001600522
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.020637100076660725
                        },
                        {
                            "class_name": "CrmProductService",
                            "similarity_score": 0.026985991160191326
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.049797487023265204
                        },
                        {
                            "class_name": "DeptApi",
                            "similarity_score": 0.06107048165524592
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmProductService",
                        "AdminUserApi",
                        "DeptApi"
                    ],
                    "llm_response_time": 3881,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "getContract": {
                    "target_classes": [
                        {
                            "class_name": "CrmContractService",
                            "similarity_score": 0.020767764964345455
                        },
                        {
                            "class_name": "CrmCustomerService",
                            "similarity_score": 0.02215949033101781
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.018632751379486615
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.022215794970541235
                        },
                        {
                            "class_name": "CrmProductService",
                            "similarity_score": 0.02178777218448668
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.045230813765746246
                        },
                        {
                            "class_name": "DeptApi",
                            "similarity_score": 0.05547001962252291
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmBusinessService",
                        "AdminUserApi",
                        "DeptApi"
                    ],
                    "llm_response_time": 3464,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "deleteContract": {
                    "target_classes": [
                        {
                            "class_name": "CrmCustomerService",
                            "similarity_score": 0.028607779004158757
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.024054778595591648
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.028680467981221563
                        },
                        {
                            "class_name": "CrmProductService",
                            "similarity_score": 0.028127892940492703
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.050607032218930606
                        },
                        {
                            "class_name": "DeptApi",
                            "similarity_score": 0.05967623950328607
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmBusinessService",
                        "AdminUserApi",
                        "DeptApi"
                    ],
                    "llm_response_time": 3651,
                    "similarity_computation_time": 8,
                    "similarity_metric": "cosine"
                }
            }
        }
    },
    {
        "repository": "https://github.com/YunaiV/ruoyi-vue-pro.git",
        "sha1": "29f1eb2c184bf7485734d8f869a236bab337fe25",
        "url": "https://github.com/YunaiV/ruoyi-vue-pro/commit/29f1eb2c184bf7485734d8f869a236bab337fe25",
        "move_method_refactoring": {
            "type": "Extract And Move Method",
            "description": "Extract And Move Method public getBusinessMap(ids Collection<Long>) : Map<Long,CrmBusinessDO> extracted from public getFollowUpRecordPage(pageReqVO CrmFollowUpRecordPageReqVO) : CommonResult<PageResult<CrmFollowUpRecordRespVO>> in class cn.iocoder.yudao.module.crm.controller.admin.followup.CrmFollowUpRecordController & moved to class cn.iocoder.yudao.module.crm.service.business.CrmBusinessService",
            "leftSideLocations": [
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/controller/admin/followup/CrmFollowUpRecordController.java",
                    "startLine": 72,
                    "endLine": 90,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration before extraction",
                    "codeElement": "public getFollowUpRecordPage(pageReqVO CrmFollowUpRecordPageReqVO) : CommonResult<PageResult<CrmFollowUpRecordRespVO>>"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/controller/admin/followup/CrmFollowUpRecordController.java",
                    "startLine": 81,
                    "endLine": 81,
                    "startColumn": 101,
                    "endColumn": 121,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/controller/admin/followup/CrmFollowUpRecordController.java",
                    "startLine": 80,
                    "endLine": 81,
                    "startColumn": 9,
                    "endColumn": 123,
                    "codeElementType": "VARIABLE_DECLARATION_STATEMENT",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                }
            ],
            "rightSideLocations": [
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/business/CrmBusinessService.java",
                    "startLine": 109,
                    "endLine": 117,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "extracted method declaration",
                    "codeElement": "public getBusinessMap(ids Collection<Long>) : Map<Long,CrmBusinessDO>"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/business/CrmBusinessService.java",
                    "startLine": 116,
                    "endLine": 116,
                    "startColumn": 49,
                    "endColumn": 69,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/service/business/CrmBusinessService.java",
                    "startLine": 116,
                    "endLine": 116,
                    "startColumn": 9,
                    "endColumn": 71,
                    "codeElementType": "RETURN_STATEMENT",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/controller/admin/followup/CrmFollowUpRecordController.java",
                    "startLine": 78,
                    "endLine": 103,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration after extraction",
                    "codeElement": "public getFollowUpRecordPage(pageReqVO CrmFollowUpRecordPageReqVO) : CommonResult<PageResult<CrmFollowUpRecordRespVO>>"
                },
                {
                    "filePath": "yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/controller/admin/followup/CrmFollowUpRecordController.java",
                    "startLine": 86,
                    "endLine": 87,
                    "startColumn": 48,
                    "endColumn": 99,
                    "codeElementType": "METHOD_INVOCATION",
                    "description": "extracted method invocation",
                    "codeElement": "businessService.getBusinessMap(convertSetByFlatMap(pageResult.getList(),item -> item.getBusinessIds().stream()))"
                }
            ],
            "isStatic": false
        },
        "ref_id": 8,
        "extraction_results": {
            "success": true,
            "newCommitHash": "4a6198bad61c180bdf1bf80cb552151c3202fac7",
            "newBranchName": "extract-getBusinessMap-getFollowUpRecordPage-3f8fa6b"
        },
        "telemetry": {
            "id": "5e84545a-f0f5-4d9f-8aba-a5faa8e298a9",
            "hostFunctionTelemetryData": {
                "hostFunctionSize": 63,
                "lineStart": 36,
                "lineEnd": 98,
                "bodyLineStart": 36,
                "language": "java",
                "filePath": "/Users/abhiram/Documents/TBE/evaluation_projects/ruoyi-vue-pro/yudao-module-crm/yudao-module-crm-biz/src/main/java/cn/iocoder/yudao/module/crm/controller/admin/followup/CrmFollowUpRecordController.java",
                "sourceCode": "@Tag(name = \"\u7ba1\u7406\u540e\u53f0 - \u8ddf\u8fdb\u8bb0\u5f55\")\n@RestController\n@RequestMapping(\"/crm/follow-up-record\")\n@Validated\npublic class CrmFollowUpRecordController {\n\n    @Resource\n    private CrmFollowUpRecordService followUpRecordService;\n    @Resource\n    private CrmContactService contactService;\n    @Resource\n    private CrmBusinessService businessService;\n\n    @PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u8ddf\u8fdb\u8bb0\u5f55\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:create')\")\n    public CommonResult<Long> createFollowUpRecord(@Valid @RequestBody CrmFollowUpRecordSaveReqVO createReqVO) {\n        return success(followUpRecordService.createFollowUpRecord(createReqVO));\n    }\n\n    @DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:delete')\")\n    public CommonResult<Boolean> deleteFollowUpRecord(@RequestParam(\"id\") Long id) {\n        followUpRecordService.deleteFollowUpRecord(id, getLoginUserId());\n        return success(true);\n    }\n\n    @GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public CommonResult<CrmFollowUpRecordRespVO> getFollowUpRecord(@RequestParam(\"id\") Long id) {\n        CrmFollowUpRecordDO followUpRecord = followUpRecordService.getFollowUpRecord(id);\n        return success(BeanUtils.toBean(followUpRecord, CrmFollowUpRecordRespVO.class));\n    }\n\n    @GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public CommonResult<PageResult<CrmFollowUpRecordRespVO>> getFollowUpRecordPage(@Valid CrmFollowUpRecordPageReqVO pageReqVO) {\n        PageResult<CrmFollowUpRecordDO> pageResult = followUpRecordService.getFollowUpRecordPage(pageReqVO);\n        /// \u62fc\u63a5\u6570\u636e\n        Map<Long, CrmContactDO> contactMap = convertMap(contactService.getContactList(\n                convertSetByFlatMap(pageResult.getList(), item -> item.getContactIds().stream())), CrmContactDO::getId);\n        Map<Long, CrmBusinessDO> businessMap = getBusinessMap(convertSetByFlatMap(pageResult.getList(), item -> item.getBusinessIds().stream()));\n        PageResult<CrmFollowUpRecordRespVO> voPageResult = BeanUtils.toBean(pageResult, CrmFollowUpRecordRespVO.class, record -> {\n            record.setContactNames(new ArrayList<>()).setBusinessNames(new ArrayList<>());\n            record.getContactIds().forEach(id -> MapUtils.findAndThen(contactMap, id,\n                    contact -> record.getContactNames().add(contact.getName())));\n            record.getContactIds().forEach(id -> MapUtils.findAndThen(businessMap, id,\n                    business -> record.getBusinessNames().add(business.getName())));\n        });\n        return success(voPageResult);\n    }\n\n    private Map<Long, CrmBusinessDO> getBusinessMap(Collection<Long> ids) {\n        return convertMap(businessService.getBusinessList(\n                ids), CrmBusinessDO::getId);\n    }\n\n}",
                "methodCount": 5
            },
            "candidatesTelemetryData": {
                "numberOfSuggestions": 5,
                "candidates": [
                    {
                        "lineStart": 92,
                        "lineEnd": 95,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method getBusinessMap to class CrmBusinessService",
                        "description": "Move method getBusinessMap to cn.iocoder.yudao.module.crm.service.business.CrmBusinessService\nRationale: The method 'getBusinessMap' directly interacts with the 'businessService' to get a list of businesses using the 'businessService.getBusinessList(ids)' call. Given that the method relies on 'CrmBusinessDO' entities and the 'businessService' itself, it is logically cohesive for the method to reside within the 'CrmBusinessService' class. This would ensure that all business-related functionality is encapsulated within the same service, promoting modularity and easier maintenance.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 48,
                        "lineEnd": 53,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method createFollowUpRecord to class CrmBusinessService",
                        "description": "Move method createFollowUpRecord to cn.iocoder.yudao.module.crm.service.business.CrmBusinessService\nRationale: The createFollowUpRecord method pertains to the creation of follow-up records, which are directly related to business activities. The CrmBusinessService class already includes methods for creating, updating, and managing business records, as well as follow-up information (e.g., updateBusinessFollowUp). Therefore, it is logical and consistent to have follow-up record creation in this class to keep business-related operations centralized.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 73,
                        "lineEnd": 90,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method getFollowUpRecordPage to class CrmFollowUpRecordService",
                        "description": "Move method getFollowUpRecordPage to cn.iocoder.yudao.module.crm.service.followup.CrmFollowUpRecordService\nRationale: The method `getFollowUpRecordPage` deals extensively with follow-up records, which includes paginating them and gathering data related to follow-up records. Additionally, it utilizes the followUpRecordService to fetch the primary data needed in the method. All these operations suggest that the CrmFollowUpRecordService is the most logical place for this method. Moreover, this service already deals with operations such as obtaining follow-up records by pagination.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 64,
                        "lineEnd": 71,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method getFollowUpRecord to class CrmContactService",
                        "description": "Move method getFollowUpRecord to cn.iocoder.yudao.module.crm.service.contact.CrmContactService\nRationale: The method 'getFollowUpRecord' retrieves follow-up records, which are typically associated with contacts in a CRM system. The CrmContactService class already contains methods for managing follow-ups related to contacts, such as 'updateContactFollowUp' and 'updateContactContactNextTime'. Therefore, this method fits better within CrmContactService as it relates directly to managing contact interactions.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 55,
                        "lineEnd": 62,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method deleteFollowUpRecord to class CrmFollowUpRecordService",
                        "description": "Move method deleteFollowUpRecord to cn.iocoder.yudao.module.crm.service.followup.CrmFollowUpRecordService\nRationale: The method deleteFollowUpRecord() specifically handles the deletion of follow-up records, which is directly related to the CrmFollowUpRecordService class's responsibilities. This class contains various methods related to creating, updating, and deleting follow-up records. The `CrmFollowUpRecordService` class is designed to manage follow-up records, making it the most appropriate place for this method.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    }
                ]
            },
            "iterationData": [
                {
                    "iteration_num": 1,
                    "suggested_move_methods": [
                        {
                            "method_name": "getBusinessMap",
                            "method_signature": "private Map<Long, CrmBusinessDO> getBusinessMap(Collection<Long> ids)",
                            "target_class": "CrmBusinessService",
                            "rationale": "The method getBusinessMap interacts exclusively with business entities and utilizes services from CrmBusinessService. It logically fits better in CrmBusinessService since it is exclusively about getting business details."
                        }
                    ],
                    "llm_response_time": 3035
                },
                {
                    "iteration_num": 2,
                    "suggested_move_methods": [
                        {
                            "method_name": "getBusinessMap",
                            "method_signature": "private Map<Long, CrmBusinessDO> getBusinessMap(Collection<Long> ids)",
                            "target_class": "CrmBusinessService",
                            "rationale": "The method getBusinessMap pertains to business data and interacts solely with the CrmBusinessService class. Moving this method there aligns functionality with responsibility."
                        }
                    ],
                    "llm_response_time": 1635
                },
                {
                    "iteration_num": 3,
                    "suggested_move_methods": [
                        {
                            "method_name": "getBusinessMap",
                            "method_signature": "private Map<Long, CrmBusinessDO> getBusinessMap(Collection<Long> ids)",
                            "target_class": "CrmBusinessService",
                            "rationale": "The method getBusinessMap utilizes the businessService to retrieve a list of business records and convert them into a map. This functionality is more appropriate to reside in the CrmBusinessService class as it is directly related to business services."
                        }
                    ],
                    "llm_response_time": 1975
                },
                {
                    "iteration_num": -1,
                    "suggested_move_methods": [
                        {
                            "method_name": "createFollowUpRecord",
                            "method_signature": "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u8ddf\u8fdb\u8bb0\u5f55\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:create')\")\n    public createFollowUpRecord(@Valid @RequestBody CrmFollowUpRecordSaveReqVO createReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "deleteFollowUpRecord",
                            "method_signature": "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:delete')\")\n    public deleteFollowUpRecord(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getFollowUpRecord",
                            "method_signature": "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecord(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getFollowUpRecordPage",
                            "method_signature": "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecordPage(@Valid CrmFollowUpRecordPageReqVO pageReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getBusinessMap",
                            "method_signature": "private getBusinessMap(Collection<Long> ids)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                },
                {
                    "iteration_num": -2,
                    "suggested_move_methods": [
                        {
                            "method_name": "getBusinessMap",
                            "method_signature": "private getBusinessMap(Collection<Long> ids)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "createFollowUpRecord",
                            "method_signature": "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u8ddf\u8fdb\u8bb0\u5f55\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:create')\")\n    public createFollowUpRecord(@Valid @RequestBody CrmFollowUpRecordSaveReqVO createReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getFollowUpRecordPage",
                            "method_signature": "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecordPage(@Valid CrmFollowUpRecordPageReqVO pageReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getFollowUpRecord",
                            "method_signature": "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecord(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "deleteFollowUpRecord",
                            "method_signature": "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:delete')\")\n    public deleteFollowUpRecord(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                }
            ],
            "methodCompatibilityScores": {
                "tf-idf": {
                    "private getBusinessMap(Collection<Long> ids)": {
                        "first": {
                            "method_name": "getBusinessMap",
                            "method_signature": "private getBusinessMap(Collection<Long> ids)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.25763477502625615
                    },
                    "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u8ddf\u8fdb\u8bb0\u5f55\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:create')\")\n    public createFollowUpRecord(@Valid @RequestBody CrmFollowUpRecordSaveReqVO createReqVO)": {
                        "first": {
                            "method_name": "createFollowUpRecord",
                            "method_signature": "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u8ddf\u8fdb\u8bb0\u5f55\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:create')\")\n    public createFollowUpRecord(@Valid @RequestBody CrmFollowUpRecordSaveReqVO createReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.41241053568150654
                    },
                    "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecordPage(@Valid CrmFollowUpRecordPageReqVO pageReqVO)": {
                        "first": {
                            "method_name": "getFollowUpRecordPage",
                            "method_signature": "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecordPage(@Valid CrmFollowUpRecordPageReqVO pageReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.41792260831147243
                    },
                    "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecord(@RequestParam(\"id\") Long id)": {
                        "first": {
                            "method_name": "getFollowUpRecord",
                            "method_signature": "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecord(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6115269948080764
                    },
                    "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:delete')\")\n    public deleteFollowUpRecord(@RequestParam(\"id\") Long id)": {
                        "first": {
                            "method_name": "deleteFollowUpRecord",
                            "method_signature": "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:delete')\")\n    public deleteFollowUpRecord(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6222306757212862
                    }
                },
                "voyage": {
                    "private getBusinessMap(Collection<Long> ids)": {
                        "first": {
                            "method_name": "getBusinessMap",
                            "method_signature": "private getBusinessMap(Collection<Long> ids)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.44372799777039357
                    },
                    "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u8ddf\u8fdb\u8bb0\u5f55\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:create')\")\n    public createFollowUpRecord(@Valid @RequestBody CrmFollowUpRecordSaveReqVO createReqVO)": {
                        "first": {
                            "method_name": "createFollowUpRecord",
                            "method_signature": "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u8ddf\u8fdb\u8bb0\u5f55\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:create')\")\n    public createFollowUpRecord(@Valid @RequestBody CrmFollowUpRecordSaveReqVO createReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.7345920250002925
                    },
                    "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:delete')\")\n    public deleteFollowUpRecord(@RequestParam(\"id\") Long id)": {
                        "first": {
                            "method_name": "deleteFollowUpRecord",
                            "method_signature": "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:delete')\")\n    public deleteFollowUpRecord(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.7425405884580816
                    },
                    "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecordPage(@Valid CrmFollowUpRecordPageReqVO pageReqVO)": {
                        "first": {
                            "method_name": "getFollowUpRecordPage",
                            "method_signature": "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecordPage(@Valid CrmFollowUpRecordPageReqVO pageReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.8208880915035786
                    },
                    "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecord(@RequestParam(\"id\") Long id)": {
                        "first": {
                            "method_name": "getFollowUpRecord",
                            "method_signature": "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecord(@RequestParam(\"id\") Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.8211728103850189
                    }
                }
            },
            "llmMethodPriority": {
                "tf-idf": {
                    "priority_method_names": [
                        "private getBusinessMap(Collection<Long> ids)",
                        "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecordPage(@Valid CrmFollowUpRecordPageReqVO pageReqVO)",
                        "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecord(@RequestParam(\"id\") Long id)",
                        "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u8ddf\u8fdb\u8bb0\u5f55\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:create')\")\n    public createFollowUpRecord(@Valid @RequestBody CrmFollowUpRecordSaveReqVO createReqVO)",
                        "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:delete')\")\n    public deleteFollowUpRecord(@RequestParam(\"id\") Long id)"
                    ],
                    "llm_response_time": 5640
                },
                "tf-idf-5": {
                    "priority_method_names": [
                        "private getBusinessMap(Collection<Long> ids)",
                        "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecordPage(@Valid CrmFollowUpRecordPageReqVO pageReqVO)",
                        "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecord(@RequestParam(\"id\") Long id)",
                        "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u8ddf\u8fdb\u8bb0\u5f55\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:create')\")\n    public createFollowUpRecord(@Valid @RequestBody CrmFollowUpRecordSaveReqVO createReqVO)",
                        "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:delete')\")\n    public deleteFollowUpRecord(@RequestParam(\"id\") Long id)"
                    ],
                    "llm_response_time": 0
                },
                "tf-df-3": {
                    "priority_method_names": [
                        "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecordPage(@Valid CrmFollowUpRecordPageReqVO pageReqVO)",
                        "private getBusinessMap(Collection<Long> ids)",
                        "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u8ddf\u8fdb\u8bb0\u5f55\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:create')\")\n    public createFollowUpRecord(@Valid @RequestBody CrmFollowUpRecordSaveReqVO createReqVO)"
                    ],
                    "llm_response_time": 4481
                },
                "voyage": {
                    "priority_method_names": [
                        "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecordPage(@Valid CrmFollowUpRecordPageReqVO pageReqVO)",
                        "private getBusinessMap(Collection<Long> ids)",
                        "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u8ddf\u8fdb\u8bb0\u5f55\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:create')\")\n    public createFollowUpRecord(@Valid @RequestBody CrmFollowUpRecordSaveReqVO createReqVO)",
                        "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:delete')\")\n    public deleteFollowUpRecord(@RequestParam(\"id\") Long id)",
                        "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecord(@RequestParam(\"id\") Long id)"
                    ],
                    "llm_response_time": 4259
                },
                "voyage-5": {
                    "priority_method_names": [
                        "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecordPage(@Valid CrmFollowUpRecordPageReqVO pageReqVO)",
                        "private getBusinessMap(Collection<Long> ids)",
                        "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u8ddf\u8fdb\u8bb0\u5f55\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:create')\")\n    public createFollowUpRecord(@Valid @RequestBody CrmFollowUpRecordSaveReqVO createReqVO)",
                        "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:delete')\")\n    public deleteFollowUpRecord(@RequestParam(\"id\") Long id)",
                        "@GetMapping(\"/get\")\n    @Operation(summary = \"\u83b7\u5f97\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true, example = \"1024\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:query')\")\n    public getFollowUpRecord(@RequestParam(\"id\") Long id)"
                    ],
                    "llm_response_time": 1
                },
                "voyage-3": {
                    "priority_method_names": [
                        "private getBusinessMap(Collection<Long> ids)",
                        "@PostMapping(\"/create\")\n    @Operation(summary = \"\u521b\u5efa\u8ddf\u8fdb\u8bb0\u5f55\")\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:create')\")\n    public createFollowUpRecord(@Valid @RequestBody CrmFollowUpRecordSaveReqVO createReqVO)",
                        "@DeleteMapping(\"/delete\")\n    @Operation(summary = \"\u5220\u9664\u8ddf\u8fdb\u8bb0\u5f55\")\n    @Parameter(name = \"id\", description = \"\u7f16\u53f7\", required = true)\n    @PreAuthorize(\"@ss.hasPermission('crm:follow-up-record:delete')\")\n    public deleteFollowUpRecord(@RequestParam(\"id\") Long id)"
                    ],
                    "llm_response_time": 2687
                }
            },
            "targetClassMap": {
                "getBusinessMap": {
                    "target_classes": [
                        {
                            "class_name": "CrmFollowUpRecordService",
                            "similarity_score": 0.01652892561983471
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.023432086368526485
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.025942459392412832
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmBusinessService",
                        "CrmContactService",
                        "CrmFollowUpRecordService"
                    ],
                    "llm_response_time": 1886,
                    "similarity_computation_time": 0,
                    "similarity_metric": "cosine"
                },
                "createFollowUpRecord": {
                    "target_classes": [
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.0171994628118338
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.024992769341858886
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmBusinessService",
                        "CrmContactService"
                    ],
                    "llm_response_time": 2720,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "getFollowUpRecordPage": {
                    "target_classes": [
                        {
                            "class_name": "CrmFollowUpRecordService",
                            "similarity_score": 0.016452790136205153
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.013328087753271652
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.012911481660011876
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmFollowUpRecordService",
                        "CrmContactService",
                        "CrmBusinessService"
                    ],
                    "llm_response_time": 5215,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "getFollowUpRecord": {
                    "target_classes": [
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.018479392793136984
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.022032945811985595
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmContactService",
                        "CrmBusinessService"
                    ],
                    "llm_response_time": 3508,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "deleteFollowUpRecord": {
                    "target_classes": [
                        {
                            "class_name": "CrmFollowUpRecordService",
                            "similarity_score": 0.027037178023451437
                        },
                        {
                            "class_name": "CrmContactService",
                            "similarity_score": 0.023727487445819113
                        },
                        {
                            "class_name": "CrmBusinessService",
                            "similarity_score": 0.0282902393493393
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "CrmFollowUpRecordService",
                        "CrmBusinessService",
                        "CrmContactService"
                    ],
                    "llm_response_time": 3707,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                }
            }
        }
    },
    {
        "repository": "https://github.com/YunaiV/ruoyi-vue-pro.git",
        "sha1": "424210066ff3ce6f5a37d4d6da939d31cdd3eb52",
        "url": "https://github.com/YunaiV/ruoyi-vue-pro/commit/424210066ff3ce6f5a37d4d6da939d31cdd3eb52",
        "move_method_refactoring": {
            "type": "Extract And Move Method",
            "description": "Extract And Move Method public validateAvailable(chatModal AiChatModalRes) : void extracted from public updateConversation(updateReqVO AiChatConversationUpdateReqVO) : Boolean in class cn.iocoder.yudao.module.ai.service.impl.AiChatConversationServiceImpl & moved to class cn.iocoder.yudao.module.ai.service.impl.AiChatModalService",
            "leftSideLocations": [
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/service/impl/AiChatConversationServiceImpl.java",
                    "startLine": 87,
                    "endLine": 101,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration before extraction",
                    "codeElement": "public updateConversation(updateReqVO AiChatConversationUpdateReqVO) : Boolean"
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/service/impl/AiChatConversationServiceImpl.java",
                    "startLine": 95,
                    "endLine": 95,
                    "startColumn": 13,
                    "endColumn": 96,
                    "codeElementType": "THROW_STATEMENT",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/service/impl/AiChatConversationServiceImpl.java",
                    "startLine": 94,
                    "endLine": 96,
                    "startColumn": 9,
                    "endColumn": 10,
                    "codeElementType": "IF_STATEMENT",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/service/impl/AiChatConversationServiceImpl.java",
                    "startLine": 94,
                    "endLine": 96,
                    "startColumn": 83,
                    "endColumn": 10,
                    "codeElementType": "BLOCK",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                }
            ],
            "rightSideLocations": [
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/service/impl/AiChatModalService.java",
                    "startLine": 119,
                    "endLine": 125,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "extracted method declaration",
                    "codeElement": "public validateAvailable(chatModal AiChatModalRes) : void"
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/service/impl/AiChatModalService.java",
                    "startLine": 123,
                    "endLine": 123,
                    "startColumn": 13,
                    "endColumn": 96,
                    "codeElementType": "THROW_STATEMENT",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/service/impl/AiChatModalService.java",
                    "startLine": 122,
                    "endLine": 124,
                    "startColumn": 9,
                    "endColumn": 10,
                    "codeElementType": "IF_STATEMENT",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/service/impl/AiChatModalService.java",
                    "startLine": 122,
                    "endLine": 124,
                    "startColumn": 83,
                    "endColumn": 10,
                    "codeElementType": "BLOCK",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/service/impl/AiChatConversationServiceImpl.java",
                    "startLine": 86,
                    "endLine": 98,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration after extraction",
                    "codeElement": "public updateConversation(updateReqVO AiChatConversationUpdateReqVO) : Boolean"
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/service/impl/AiChatConversationServiceImpl.java",
                    "startLine": 93,
                    "endLine": 93,
                    "startColumn": 9,
                    "endColumn": 56,
                    "codeElementType": "METHOD_INVOCATION",
                    "description": "extracted method invocation",
                    "codeElement": "aiChatModalService.validateAvailable(chatModal)"
                }
            ],
            "isStatic": false
        },
        "ref_id": 14,
        "extraction_results": {
            "success": true,
            "newCommitHash": "03f78f37afdc0f87b207087e52557c7d1809339c",
            "newBranchName": "extract-validateAvailable-updateConversation-f86e24b"
        },
        "telemetry": {
            "id": "8860c768-1bf5-4e6f-84ba-1a422263ed4b",
            "hostFunctionTelemetryData": {
                "hostFunctionSize": 107,
                "lineStart": 29,
                "lineEnd": 135,
                "bodyLineStart": 29,
                "language": "java",
                "filePath": "/Users/abhiram/Documents/TBE/evaluation_projects/ruoyi-vue-pro/yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/service/impl/AiChatConversationServiceImpl.java",
                "sourceCode": "/**\n * chat 对话\n *\n * @fansili\n * @since v1.0\n */\n@Service\n@Slf4j\n@AllArgsConstructor\npublic class AiChatConversationServiceImpl implements AiChatConversationService {\n\n    private final AiChatModalMapper aiChatModalMapper;\n    private final AiChatModalService aiChatModalService;\n    private final AiChatRoleService aiChatRoleService;\n    private final AiChatConversationMapper aiChatConversationMapper;\n\n    @Override\n    public Long createConversation(AiChatConversationCreateReqVO req) {\n        // 获取用户id\n        Long loginUserId = SecurityFrameworkUtils.getLoginUserId();\n        // 默认使用 sort 排序第一个模型\n        AiChatModalDO aiChatModalDO = aiChatModalMapper.selectFirstModal();\n        // 查询角色\n        AiChatRoleRes chatRoleRes = null;\n        if (req.getRoleId() != null) {\n            chatRoleRes = aiChatRoleService.getChatRole(req.getRoleId());\n        }\n        Long chatRoleId = chatRoleRes != null ? chatRoleRes.getId() : null;\n        // 创建新的 Conversation\n        AiChatConversationDO insertConversation = saveConversation(AiCommonConstants.CONVERSATION_DEFAULT_TITLE,\n                loginUserId, chatRoleId, aiChatModalDO.getId(), aiChatModalDO.getModel()\n        );\n        // 返回对话id\n        return insertConversation.getId();\n    }\n\n    private @NotNull AiChatConversationDO saveConversation(String title,\n                                                           Long userId,\n                                                           Long roleId,\n                                                           Long modalId,\n                                                           String model) {\n        AiChatConversationDO insertConversation = new AiChatConversationDO();\n        insertConversation.setId(null);\n        insertConversation.setUserId(userId);\n        insertConversation.setTitle(title);\n        insertConversation.setPinned(false);\n\n        insertConversation.setRoleId(roleId);\n        insertConversation.setModelId(modalId);\n        insertConversation.setModel(model);\n\n        insertConversation.setTemperature(null);\n        insertConversation.setMaxTokens(null);\n        insertConversation.setMaxContexts(null);\n        aiChatConversationMapper.insert(insertConversation);\n        return insertConversation;\n    }\n\n    @Override\n    public Boolean updateConversation(AiChatConversationUpdateReqVO updateReqVO) {\n        // 校验对话是否存在\n        validateExists(updateReqVO.getId());\n        // 获取模型信息并验证\n        AiChatModalRes chatModal = aiChatModalService.getChatModalOfValidate(updateReqVO.getModelId());\n        // 校验modal是否可用\n        validateAvailable(chatModal);\n        // 更新对话信息\n        AiChatConversationDO updateAiChatConversationDO\n                = AiChatConversationConvert.INSTANCE.convertAiChatConversationDO(updateReqVO);\n        return aiChatConversationMapper.updateById(updateAiChatConversationDO) > 0;\n    }\n\n    private void validateAvailable(AiChatModalRes chatModal) {\n        if (AiChatModalDisableEnum.YES.getValue().equals(chatModal.getDisable())) {\n            throw ServiceExceptionUtil.exception(ErrorCodeConstants.AI_MODAL_DISABLE_NOT_USED);\n        }\n    }\n\n    @Override\n    public List<AiChatConversationRespVO> listConversation(AiChatConversationListReqVO listReqVO) {\n        // 获取用户id\n        Long loginUserId = SecurityFrameworkUtils.getLoginUserId();\n        // 查询前100对话\n        List<AiChatConversationDO> top100Conversation\n                = aiChatConversationMapper.selectTop100Conversation(loginUserId, listReqVO.getTitle());\n        return AiChatConversationConvert.INSTANCE.covnertChatConversationResList(top100Conversation);\n    }\n\n    @Override\n    public AiChatConversationRespVO getConversationOfValidate(Long id) {\n        AiChatConversationDO aiChatConversationDO = validateExists(id);\n        return AiChatConversationConvert.INSTANCE.covnertChatConversationRes(aiChatConversationDO);\n    }\n\n    @Override\n    public Boolean deleteConversation(Long id) {\n        return aiChatConversationMapper.deleteById(id) > 0;\n    }\n\n    private @NotNull AiChatConversationDO validateExists(Long id) {\n        AiChatConversationDO aiChatConversationDO = aiChatConversationMapper.selectById(id);\n        if (aiChatConversationDO == null) {\n            throw ServiceExceptionUtil.exception(ErrorCodeConstants.AI_CONVERSATION_NOT_EXISTS);\n        }\n        return aiChatConversationDO;\n    }\n}",
                "methodCount": 8
            },
            "candidatesTelemetryData": {
                "numberOfSuggestions": 3,
                "candidates": [
                    {
                        "lineStart": 64,
                        "lineEnd": 84,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method saveConversation to class AiChatModalService",
                        "description": "Move method saveConversation to cn.iocoder.yudao.module.ai.service.AiChatModalService\nRationale: The saveConversation() method is more focused on the business logic of creating and saving a conversation, which fits into the service layer typically handled by AiChatModalService. Services generally handle business/domain logic rather than direct database interactions, making AiChatModalService the appropriate class.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 100,
                        "lineEnd": 104,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method validateAvailable to class AiChatModalRes",
                        "description": "Move method validateAvailable to cn.iocoder.yudao.module.ai.controller.admin.model.vo.model.AiChatModalRes\nRationale: The validateAvailable method directly interacts with the AiChatModalRes class by checking its disable field. Since this method is validating the state of an instance of AiChatModalRes, it is logical and cohesive to move it into the AiChatModalRes class itself to enhance encapsulation and maintain a single-responsibility principle.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 127,
                        "lineEnd": 133,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method validateExists to class AiChatModalService",
                        "description": "Move method validateExists to cn.iocoder.yudao.module.ai.service.AiChatModalService\nRationale: The validateExists method is a validation utility that checks for the existence of an AiChatConversationDO entity before performing further actions. Such validation is more appropriate in the service layer, as it relates to business logic and operational checks. The service layer is responsible for encapsulating the business logic and interacting with the data access layer (mappers), making AiChatModalService the most appropriate target class.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    }
                ]
            },
            "elapsedTime": [
                {
                    "candidateIndex": 0,
                    "elapsedTime": 3413
                },
                {
                    "candidateIndex": 1,
                    "elapsedTime": 1665
                },
                {
                    "candidateIndex": 2,
                    "elapsedTime": 3439
                }
            ],
            "processingTime": {
                "llmResponseTime": -1,
                "pluginProcessingTime": -1,
                "totalTime": 38775
            },
            "iterationData": [
                {
                    "iteration_num": 1,
                    "suggested_move_methods": [
                        {
                            "method_name": "getLoginUserId",
                            "method_signature": "public static Long getLoginUserId()",
                            "target_class": "SecurityFrameworkUtils",
                            "rationale": "The getLoginUserId method is used to get the current login user ID and belongs to the SecurityFrameworkUtils class, indicating that it is a common utility method for retrieving user IDs across the system. Keeping it within the SecurityFrameworkUtils class ensures centralized authentication and authorization handling."
                        },
                        {
                            "method_name": "getChatRole",
                            "method_signature": "public AiChatRoleRes getChatRole(Long roleId)",
                            "target_class": "AiChatRoleService",
                            "rationale": "The getChatRole method fetches the role information based on roleId, and it is closely tied to the AiChatRoleService, which implies that all role-related logic should reside within that service to maintain cohesion."
                        },
                        {
                            "method_name": "selectFirstModal",
                            "method_signature": "public AiChatModalDO selectFirstModal()",
                            "target_class": "AiChatModalMapper",
                            "rationale": "The selectFirstModal method is responsible for selecting the first modal from the database and should be a part of AiChatModalMapper to maintain the separation of concerns between service logic and data access logic."
                        },
                        {
                            "method_name": "insert",
                            "method_signature": "public void insert(AiChatConversationDO insertConversation)",
                            "target_class": "AiChatConversationMapper",
                            "rationale": "The insert method deals with persisting conversation details in the database, which should logically belong to the AiChatConversationMapper class to keep the data access responsibilities encapsulated."
                        },
                        {
                            "method_name": "updateById",
                            "method_signature": "public boolean updateById(AiChatConversationDO updateAiChatConversationDO)",
                            "target_class": "AiChatConversationMapper",
                            "rationale": "The updateById method is responsible for updating existing conversation records in the database, which should reside within the AiChatConversationMapper class for better organization and maintainability."
                        },
                        {
                            "method_name": "selectTop100Conversation",
                            "method_signature": "public List<AiChatConversationDO> selectTop100Conversation(Long loginUserId, String title)",
                            "target_class": "AiChatConversationMapper",
                            "rationale": "The selectTop100Conversation method retrieves the top 100 conversations for a user from the database and should be part of AiChatConversationMapper to ensure that all data retrieval logic is centralized."
                        },
                        {
                            "method_name": "deleteById",
                            "method_signature": "public boolean deleteById(Long id)",
                            "target_class": "AiChatConversationMapper",
                            "rationale": "The deleteById method handles the deletion of conversations in the database. It should be moved to AiChatConversationMapper to maintain consistency in handling all data operations within the mapper."
                        },
                        {
                            "method_name": "selectById",
                            "method_signature": "public AiChatConversationDO selectById(Long id)",
                            "target_class": "AiChatConversationMapper",
                            "rationale": "The selectById method performs retrieval of specific conversation details from the database, logically belonging to AiChatConversationMapper for better organization of database operations."
                        }
                    ],
                    "llm_response_time": 8743
                },
                {
                    "iteration_num": 2,
                    "suggested_move_methods": [
                        {
                            "method_name": "getLoginUserId",
                            "method_signature": "public static Long getLoginUserId()",
                            "target_class": "SecurityFrameworkUtils",
                            "rationale": "The method getLoginUserId is related to security/authentication and fetching the current user's ID, which aligns more with the responsibilities of SecurityFrameworkUtils than AiChatConversationServiceImpl."
                        },
                        {
                            "method_name": "validateAvailable",
                            "method_signature": "private void validateAvailable(AiChatModalRes chatModal)",
                            "target_class": "AiChatModalService",
                            "rationale": "The validateAvailable method is verifying the availability of a chat model, which is more related to the responsibilities of AiChatModalService."
                        },
                        {
                            "method_name": "validateExists",
                            "method_signature": "private @NotNull AiChatConversationDO validateExists(Long id)",
                            "target_class": "AiChatConversationService",
                            "rationale": "The validateExists method checks if a conversation exists, which is a fundamental responsibility of the AiChatConversationService. It makes more sense to keep it there for centralization of validation logic."
                        }
                    ],
                    "llm_response_time": 3293
                },
                {
                    "iteration_num": 3,
                    "suggested_move_methods": [
                        {
                            "method_name": "validateAvailable",
                            "method_signature": "private void validateAvailable(AiChatModalRes chatModal)",
                            "target_class": "AiChatModalService",
                            "rationale": "The validation logic for checking whether a chat modal is available seems more related to the functionalities provided by AiChatModalService, making it a more appropriate class to host this method."
                        },
                        {
                            "method_name": "saveConversation",
                            "method_signature": "private @NotNull AiChatConversationDO saveConversation(String title, Long userId, Long roleId, Long modalId, String model)",
                            "target_class": "AiChatConversationMapper",
                            "rationale": "The saveConversation method is primarily concerned with persisting a new conversation object to the database. This responsibility aligns closely with data access functionalities provided by the AiChatConversationMapper class."
                        },
                        {
                            "method_name": "validateExists",
                            "method_signature": "private @NotNull AiChatConversationDO validateExists(Long id)",
                            "target_class": "AiChatConversationMapper",
                            "rationale": "The validateExists method's purpose is to validate the existence of a conversation in the database, which aligns closely with the data-access operations performed by AiChatConversationMapper."
                        }
                    ],
                    "llm_response_time": 3579
                },
                {
                    "iteration_num": -1,
                    "suggested_move_methods": [
                        {
                            "method_name": "saveConversation",
                            "method_signature": "private @NotNull saveConversation(String title,\n                                                           Long userId,\n                                                           Long roleId,\n                                                           Long modalId,\n                                                           String model)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "validateAvailable",
                            "method_signature": "private validateAvailable(AiChatModalRes chatModal)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "validateExists",
                            "method_signature": "private @NotNull validateExists(Long id)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                },
                {
                    "iteration_num": -2,
                    "suggested_move_methods": [
                        {
                            "method_name": "saveConversation",
                            "method_signature": "private @NotNull saveConversation(String title,\n                                                           Long userId,\n                                                           Long roleId,\n                                                           Long modalId,\n                                                           String model)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "validateAvailable",
                            "method_signature": "private validateAvailable(AiChatModalRes chatModal)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "validateExists",
                            "method_signature": "private @NotNull validateExists(Long id)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                }
            ],
            "methodCompatibilityScores": {
                "tf-idf": {
                    "private @NotNull saveConversation(String title,\n                                                           Long userId,\n                                                           Long roleId,\n                                                           Long modalId,\n                                                           String model)": {
                        "first": {
                            "method_name": "saveConversation",
                            "method_signature": "private @NotNull saveConversation(String title,\n                                                           Long userId,\n                                                           Long roleId,\n                                                           Long modalId,\n                                                           String model)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.38587226993725343
                    },
                    "private validateAvailable(AiChatModalRes chatModal)": {
                        "first": {
                            "method_name": "validateAvailable",
                            "method_signature": "private validateAvailable(AiChatModalRes chatModal)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.3929189331984953
                    },
                    "private @NotNull validateExists(Long id)": {
                        "first": {
                            "method_name": "validateExists",
                            "method_signature": "private @NotNull validateExists(Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5397707704603832
                    }
                },
                "voyage": {
                    "private validateAvailable(AiChatModalRes chatModal)": {
                        "first": {
                            "method_name": "validateAvailable",
                            "method_signature": "private validateAvailable(AiChatModalRes chatModal)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5557473077780617
                    },
                    "private @NotNull validateExists(Long id)": {
                        "first": {
                            "method_name": "validateExists",
                            "method_signature": "private @NotNull validateExists(Long id)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6633343203390589
                    },
                    "private @NotNull saveConversation(String title,\n                                                           Long userId,\n                                                           Long roleId,\n                                                           Long modalId,\n                                                           String model)": {
                        "first": {
                            "method_name": "saveConversation",
                            "method_signature": "private @NotNull saveConversation(String title,\n                                                           Long userId,\n                                                           Long roleId,\n                                                           Long modalId,\n                                                           String model)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.7281082418906123
                    }
                }
            },
            "llmMethodPriority": {
                "tf-idf": {
                    "priority_method_names": [
                        "private @NotNull validateExists(Long id)",
                        "private validateAvailable(AiChatModalRes chatModal)"
                    ],
                    "llm_response_time": 6271
                },
                "tf-idf-5": {
                    "priority_method_names": [
                        "private @NotNull validateExists(Long id)",
                        "private validateAvailable(AiChatModalRes chatModal)"
                    ],
                    "llm_response_time": 0
                },
                "tf-df-3": {
                    "priority_method_names": [
                        "private @NotNull validateExists(Long id)",
                        "private validateAvailable(AiChatModalRes chatModal)"
                    ],
                    "llm_response_time": 0
                },
                "voyage": {
                    "priority_method_names": [],
                    "llm_response_time": 4713
                },
                "voyage-5": {
                    "priority_method_names": [],
                    "llm_response_time": 1
                },
                "voyage-3": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                }
            },
            "targetClassMap": {
                "saveConversation": {
                    "target_classes": [
                        {
                            "class_name": "AiChatModalMapper",
                            "similarity_score": 0.13697345026974844
                        },
                        {
                            "class_name": "AiChatModalService",
                            "similarity_score": 0.011112826185769949
                        },
                        {
                            "class_name": "AiChatRoleService",
                            "similarity_score": 0.00978958267188856
                        },
                        {
                            "class_name": "AiChatConversationMapper",
                            "similarity_score": 0.19976361972861711
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "AiChatModalService",
                        "AiChatConversationMapper",
                        "AiChatModalMapper"
                    ],
                    "llm_response_time": 3473,
                    "similarity_computation_time": 7,
                    "similarity_metric": "cosine"
                },
                "validateAvailable": {
                    "target_classes": [
                        {
                            "class_name": "AiChatModalRes",
                            "similarity_score": 0.17038855027411945
                        },
                        {
                            "class_name": "AiChatModalMapper",
                            "similarity_score": 0.2850438562747845
                        },
                        {
                            "class_name": "AiChatModalService",
                            "similarity_score": 0.06226220585942175
                        },
                        {
                            "class_name": "AiChatRoleService",
                            "similarity_score": 0.06268391408072227
                        },
                        {
                            "class_name": "AiChatConversationMapper",
                            "similarity_score": 0.2941955933055742
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "AiChatModalRes",
                        "AiChatModalMapper",
                        "AiChatConversationMapper"
                    ],
                    "llm_response_time": 3363,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "validateExists": {
                    "target_classes": [
                        {
                            "class_name": "AiChatModalMapper",
                            "similarity_score": 0.2520388327242304
                        },
                        {
                            "class_name": "AiChatModalService",
                            "similarity_score": 0.02556027951596498
                        },
                        {
                            "class_name": "AiChatRoleService",
                            "similarity_score": 0.022516726641377063
                        },
                        {
                            "class_name": "AiChatConversationMapper",
                            "similarity_score": 0.2940610136520008
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "AiChatModalService",
                        "AiChatConversationMapper",
                        "AiChatModalMapper"
                    ],
                    "llm_response_time": 4099,
                    "similarity_computation_time": 0,
                    "similarity_metric": "cosine"
                }
            }
        }
    },
    {
        "repository": "https://github.com/YunaiV/ruoyi-vue-pro.git",
        "sha1": "7c1e949d77315754d0c0377e7bea8df1764a8e1a",
        "url": "https://github.com/YunaiV/ruoyi-vue-pro/commit/7c1e949d77315754d0c0377e7bea8df1764a8e1a",
        "move_method_refactoring": {
            "type": "Extract And Move Method",
            "description": "Extract And Move Method public selectByStatusAndPlatform(statusEnum AiImageStatusEnum, platformEnum AiPlatformEnum) : List<AiImageDO> extracted from public execute(param String) : String in class cn.iocoder.yudao.module.ai.job.MidjourneyJob & moved to class cn.iocoder.yudao.module.ai.dal.mysql.image.AiImageMapper",
            "leftSideLocations": [
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/job/MidjourneyJob.java",
                    "startLine": 42,
                    "endLine": 82,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration before extraction",
                    "codeElement": "public execute(param String) : String"
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/job/MidjourneyJob.java",
                    "startLine": 51,
                    "endLine": 51,
                    "startColumn": 29,
                    "endColumn": 51,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/job/MidjourneyJob.java",
                    "startLine": 50,
                    "endLine": 50,
                    "startColumn": 29,
                    "endColumn": 49,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/job/MidjourneyJob.java",
                    "startLine": 48,
                    "endLine": 52,
                    "startColumn": 9,
                    "endColumn": 11,
                    "codeElementType": "VARIABLE_DECLARATION_STATEMENT",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                }
            ],
            "rightSideLocations": [
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/dal/mysql/image/AiImageMapper.java",
                    "startLine": 59,
                    "endLine": 69,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "extracted method declaration",
                    "codeElement": "public selectByStatusAndPlatform(statusEnum AiImageStatusEnum, platformEnum AiPlatformEnum) : List<AiImageDO>"
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/dal/mysql/image/AiImageMapper.java",
                    "startLine": 67,
                    "endLine": 67,
                    "startColumn": 21,
                    "endColumn": 43,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/dal/mysql/image/AiImageMapper.java",
                    "startLine": 66,
                    "endLine": 66,
                    "startColumn": 21,
                    "endColumn": 41,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/dal/mysql/image/AiImageMapper.java",
                    "startLine": 65,
                    "endLine": 68,
                    "startColumn": 9,
                    "endColumn": 11,
                    "codeElementType": "RETURN_STATEMENT",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/job/MidjourneyJob.java",
                    "startLine": 40,
                    "endLine": 72,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration after extraction",
                    "codeElement": "public execute(param String) : String"
                },
                {
                    "filePath": "yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/job/MidjourneyJob.java",
                    "startLine": 43,
                    "endLine": 43,
                    "startColumn": 37,
                    "endColumn": 132,
                    "codeElementType": "METHOD_INVOCATION",
                    "description": "extracted method invocation",
                    "codeElement": "imageMapper.selectByStatusAndPlatform(AiImageStatusEnum.IN_PROGRESS,AiPlatformEnum.MIDJOURNEY)"
                }
            ],
            "isStatic": false
        },
        "ref_id": 15,
        "extraction_results": {
            "success": true,
            "newCommitHash": "9bd531bedf21668537a95d15c4ab5d519a42f18e",
            "newBranchName": "extract-selectByStatusAndPlatform-execute-aa7c2cb"
        },
        "telemetry": {
            "id": "7c185914-9624-4c43-918b-9ff66d6ae141",
            "hostFunctionTelemetryData": {
                "hostFunctionSize": 68,
                "lineStart": 22,
                "lineEnd": 89,
                "bodyLineStart": 22,
                "language": "java",
                "filePath": "/Users/abhiram/Documents/TBE/evaluation_projects/ruoyi-vue-pro/yudao-module-ai/yudao-module-ai-biz/src/main/java/cn/iocoder/yudao/module/ai/job/MidjourneyJob.java",
                "sourceCode": "/**\n * midjourney job 定时拉去 midjourney 绘制状态\n *\n * @author fansili\n * @time 2024/6/5 14:55\n * @since 1.0\n */\n@Component\n@Slf4j\npublic class MidjourneyJob implements JobHandler {\n\n    // TODO @fan：@Resource\n    @Autowired\n    private MidjourneyApi midjourneyApi;\n    @Autowired\n    private AiImageMapper imageMapper;\n    @Autowired\n    private AiImageService imageService;\n\n    // TODO @fan：这个方法，建议实现到 AiImageService，例如说 midjourneySync，返回 int 同步数量。\n    @Override\n    public String execute(String param) throws Exception {\n        // 1、获取 midjourney 平台，状态在 “进行中” 的 image\n        // TODO @fan：43 和 51 其实有点重叠，日志，建议只打 51\n        log.info(\"Midjourney 同步 - 开始...\");\n        // TODO @fan：Job、Service 等业务层，不要直接使用 LambdaUpdateWrapper，这样会导致 mapper 穿透到逻辑层。要收敛到 mapper 里。\n        List<AiImageDO> imageList = selectByStatusAndPlatform();\n        log.info(\"Midjourney 同步 - 任务数量 {}!\", imageList.size());\n        if (CollUtil.isEmpty(imageList)) {\n            // TODO @fan：51 和 54，其实有点重叠。建议 51 挪到 55 之后打。\n            return \"Midjourney 同步 - 数量为空!\";\n        }\n        // 2、批量拉去 task 信息\n        // TODO @fan：imageList.stream().map(AiImageDO::getTaskId).collect(Collectors.toSet()))，可以使用 CollectionUtils.convertSet 简化\n        List<MidjourneyApi.NotifyRequest> taskList = midjourneyApi\n                .listByCondition(imageList.stream().map(AiImageDO::getTaskId).collect(Collectors.toSet()));\n        // TODO @fan：taskList.stream().collect(Collectors.toMap(MidjourneyNotifyReqVO::getId, o -> o))，也可以使用 CollectionUtils.convertMap；本质上，重用 set、map 转换，要 convert 简化\n        Map<String, MidjourneyApi.NotifyRequest> taskIdMap = taskList.stream().collect(Collectors.toMap(MidjourneyApi.NotifyRequest::id, o -> o));\n        // 3、更新 image 状态\n        List<AiImageDO> updateImageList = new ArrayList<>();\n        for (AiImageDO aiImageDO : imageList) {\n            // 3.1 排除掉空的情况\n            if (!taskIdMap.containsKey(aiImageDO.getTaskId())) {\n                log.warn(\"Midjourney 同步 - {} 任务为空!\", aiImageDO.getTaskId());\n                continue;\n            }\n            // TODO @ 3.1 和 3.2 是不是融合下；get，然后判空，continue；\n            // 3.2 获取通知对象\n//            MidjourneyNotifyReqVO notifyReqVO = taskIdMap.get(aiImageDO.getTaskId());\n            // 3.2 构建更新对象\n            // TODO @fan：建议 List<MidjourneyNotifyReqVO> 作为 imageService 去更新；\n//            updateImageList.add(imageService.buildUpdateImage(aiImageDO.getId(), notifyReqVO));\n        }\n        // 4、批了更新 updateImageList\n        imageMapper.updateBatch(updateImageList);\n        return \"Midjourney 同步 - \".concat(String.valueOf(updateImageList.size())).concat(\" 任务!\");\n    }\n\n    private List<AiImageDO> selectByStatusAndPlatform() {\n        List<AiImageDO> imageList = imageMapper.selectList(\n                new LambdaUpdateWrapper<AiImageDO>()\n                        .eq(AiImageDO::getStatus, AiImageStatusEnum.IN_PROGRESS.getStatus())\n                        .eq(AiImageDO::getPlatform, AiPlatformEnum.MIDJOURNEY.getPlatform())\n        );\n        return imageList;\n    }\n\n}",
                "methodCount": 2
            },
            "candidatesTelemetryData": {
                "numberOfSuggestions": 1,
                "candidates": [
                    {
                        "lineStart": 79,
                        "lineEnd": 86,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method selectByStatusAndPlatform to class AiImageService",
                        "description": "Move method selectByStatusAndPlatform to cn.iocoder.yudao.module.ai.service.image.AiImageService\nRationale: The method selectByStatusAndPlatform() involves business logic that is concerned with filtering images based on status and platform. This type of operation typically falls under the responsibility of service layer classes like AiImageService. The service layer handles the business logic and coordinates data retrieval/manipulation, which makes it the most appropriate place for this method. Moving it to AiImageService also allows for better adherence to the single responsibility principle by keeping data access and business logic separate.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    }
                ]
            },
            "elapsedTime": [
                {
                    "candidateIndex": 0,
                    "elapsedTime": 5803
                }
            ],
            "processingTime": {
                "llmResponseTime": -1,
                "pluginProcessingTime": -1,
                "totalTime": 13881
            },
            "iterationData": [
                {
                    "iteration_num": 1,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectByStatusAndPlatform",
                            "method_signature": "private List<AiImageDO> selectByStatusAndPlatform()",
                            "target_class": "AiImageMapper",
                            "rationale": "The method `selectByStatusAndPlatform` is responsible for querying the database. This logic is more appropriate for the `AiImageMapper` class, adhering to the principle of separation of concerns."
                        }
                    ],
                    "llm_response_time": 2538
                },
                {
                    "iteration_num": 2,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectByStatusAndPlatform",
                            "method_signature": "private List<AiImageDO> selectByStatusAndPlatform()",
                            "target_class": "AiImageMapper",
                            "rationale": "selectByStatusAndPlatform() directly accesses the database and is tightly coupled with the data layer. This operation should belong to AiImageMapper, which handles data access."
                        },
                        {
                            "method_name": "execute",
                            "method_signature": "public String execute(String param) throws Exception",
                            "target_class": "AiImageService",
                            "rationale": "The execute() method involves business logic related to synchronizing images and updating their states. This logic is more suited to AiImageService, which handles such operations, rather than being in the job handler."
                        }
                    ],
                    "llm_response_time": 2767
                },
                {
                    "iteration_num": 3,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectByStatusAndPlatform",
                            "method_signature": "private List<AiImageDO> selectByStatusAndPlatform()",
                            "target_class": "AiImageMapper",
                            "rationale": "This method is directly interacting with the database to retrieve images with specific status and platform criteria. Such database operations are more appropriate to be encapsulated within the Mapper class."
                        },
                        {
                            "method_name": "execute",
                            "method_signature": "public String execute(String param) throws Exception",
                            "target_class": "AiImageService",
                            "rationale": "The `execute` method contains significant processing logic that could logically be part of the service layer, especially related to syncing and updating images. Moving it to `AiImageService` ensures that the business logic is appropriately encapsulated and the job class focuses on job scheduling."
                        }
                    ],
                    "llm_response_time": 2088
                },
                {
                    "iteration_num": -1,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectByStatusAndPlatform",
                            "method_signature": "private selectByStatusAndPlatform()",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                },
                {
                    "iteration_num": -2,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectByStatusAndPlatform",
                            "method_signature": "private selectByStatusAndPlatform()",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                }
            ],
            "methodCompatibilityScores": {
                "tf-idf": {
                    "private selectByStatusAndPlatform()": {
                        "first": {
                            "method_name": "selectByStatusAndPlatform",
                            "method_signature": "private selectByStatusAndPlatform()",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.2085680788151521
                    }
                },
                "voyage": {
                    "private selectByStatusAndPlatform()": {
                        "first": {
                            "method_name": "selectByStatusAndPlatform",
                            "method_signature": "private selectByStatusAndPlatform()",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6079272387266517
                    }
                }
            },
            "llmMethodPriority": {
                "tf-idf": {
                    "priority_method_names": [],
                    "llm_response_time": 2416
                },
                "tf-idf-5": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "tf-df-3": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "voyage": {
                    "priority_method_names": [],
                    "llm_response_time": 1
                },
                "voyage-5": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "voyage-3": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                }
            },
            "targetClassMap": {
                "selectByStatusAndPlatform": {
                    "target_classes": [
                        {
                            "class_name": "AiImageMapper",
                            "similarity_score": 0.16452254913212452
                        },
                        {
                            "class_name": "AiImageService",
                            "similarity_score": 0.009331135591319846
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "AiImageService",
                        "AiImageMapper"
                    ],
                    "llm_response_time": 3554,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                }
            }
        }
    },
    {
        "repository": "https://github.com/YunaiV/ruoyi-vue-pro.git",
        "sha1": "285a431616e8cfcf55f6f473cf0ef918c9799bc3",
        "url": "https://github.com/YunaiV/ruoyi-vue-pro/commit/285a431616e8cfcf55f6f473cf0ef918c9799bc3",
        "move_method_refactoring": {
            "type": "Extract And Move Method",
            "description": "Extract And Move Method public updateConversationLastMessage(kefuMessage KeFuMessageDO) : void extracted from public sendKefuMessage(sendReqVO KeFuMessageSendReqVO) : Long in class cn.iocoder.yudao.module.promotion.service.kefu.KeFuMessageServiceImpl & moved to class cn.iocoder.yudao.module.promotion.service.kefu.KeFuConversationService",
            "leftSideLocations": [
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuMessageServiceImpl.java",
                    "startLine": 54,
                    "endLine": 82,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration before extraction",
                    "codeElement": "public sendKefuMessage(sendReqVO KeFuMessageSendReqVO) : Long"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuMessageServiceImpl.java",
                    "startLine": 76,
                    "endLine": 76,
                    "startColumn": 13,
                    "endColumn": 112,
                    "codeElementType": "EXPRESSION_STATEMENT",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuMessageServiceImpl.java",
                    "startLine": 75,
                    "endLine": 77,
                    "startColumn": 9,
                    "endColumn": 10,
                    "codeElementType": "IF_STATEMENT",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuMessageServiceImpl.java",
                    "startLine": 75,
                    "endLine": 77,
                    "startColumn": 136,
                    "endColumn": 10,
                    "codeElementType": "BLOCK",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                }
            ],
            "rightSideLocations": [
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationService.java",
                    "startLine": 47,
                    "endLine": 66,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "extracted method declaration",
                    "codeElement": "public updateConversationLastMessage(kefuMessage KeFuMessageDO) : void"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationService.java",
                    "startLine": 64,
                    "endLine": 64,
                    "startColumn": 13,
                    "endColumn": 92,
                    "codeElementType": "EXPRESSION_STATEMENT",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationService.java",
                    "startLine": 62,
                    "endLine": 65,
                    "startColumn": 9,
                    "endColumn": 10,
                    "codeElementType": "IF_STATEMENT",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationService.java",
                    "startLine": 63,
                    "endLine": 65,
                    "startColumn": 73,
                    "endColumn": 10,
                    "codeElementType": "BLOCK",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuMessageServiceImpl.java",
                    "startLine": 50,
                    "endLine": 67,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration after extraction",
                    "codeElement": "public sendKefuMessage(sendReqVO KeFuMessageSendReqVO) : Long"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuMessageServiceImpl.java",
                    "startLine": 62,
                    "endLine": 62,
                    "startColumn": 9,
                    "endColumn": 71,
                    "codeElementType": "METHOD_INVOCATION",
                    "description": "extracted method invocation",
                    "codeElement": "conversationService.updateConversationLastMessage(kefuMessage)"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationService.java",
                    "startLine": 51,
                    "endLine": 51,
                    "startColumn": 9,
                    "endColumn": 107,
                    "codeElementType": "VARIABLE_DECLARATION_STATEMENT",
                    "description": "added statement in extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationService.java",
                    "startLine": 53,
                    "endLine": 55,
                    "startColumn": 9,
                    "endColumn": 75,
                    "codeElementType": "EXPRESSION_STATEMENT",
                    "description": "added statement in extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationService.java",
                    "startLine": 59,
                    "endLine": 59,
                    "startColumn": 13,
                    "endColumn": 95,
                    "codeElementType": "EXPRESSION_STATEMENT",
                    "description": "added statement in extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationService.java",
                    "startLine": 58,
                    "endLine": 60,
                    "startColumn": 81,
                    "endColumn": 10,
                    "codeElementType": "BLOCK",
                    "description": "added statement in extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationService.java",
                    "startLine": 58,
                    "endLine": 60,
                    "startColumn": 9,
                    "endColumn": 10,
                    "codeElementType": "IF_STATEMENT",
                    "description": "added statement in extracted method declaration",
                    "codeElement": null
                }
            ],
            "isStatic": false
        },
        "ref_id": 16,
        "extraction_results": {
            "success": true,
            "newCommitHash": "f2281c70cec384b33cc8713ac727cb0b1ca8fe2b",
            "newBranchName": "extract-updateConversationLastMessage-sendKefuMessage-d89a19a"
        },
        "telemetry": {
            "id": "ea3d9d4e-dd31-46b0-931a-1769d861f234",
            "hostFunctionTelemetryData": {
                "hostFunctionSize": 112,
                "lineStart": 28,
                "lineEnd": 139,
                "bodyLineStart": 28,
                "language": "java",
                "filePath": "/Users/abhiram/Documents/TBE/evaluation_projects/ruoyi-vue-pro/yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuMessageServiceImpl.java",
                "sourceCode": "/**\n * \u5ba2\u670d\u6d88\u606f Service \u5b9e\u73b0\u7c7b\n *\n * @author HUIHUI\n */\n@Service\n@Validated\npublic class KeFuMessageServiceImpl implements KeFuMessageService {\n\n    // TODO @puhui999\uff1a@\u828b\u827f\uff1a\u6349\u6478\u8981\u4e0d\u8981\u62ff\u5230\u4e00\u4e2a\u5730\u65b9\u679a\u4e3e\uff1b\n    private static final String KEFU_MESSAGE_TYPE = \"kefu_message_type\"; // \u5ba2\u670d\u6d88\u606f\u7c7b\u578b\n\n    // TODO @puhui999\uff1akefuMessageMapper\uff1b\u56e0\u4e3a messageMapper \u53ef\u80fd\u4f1a\u91cd\u53e0\n    @Resource\n    private KeFuMessageMapper messageMapper;\n\n    @Resource\n    private KeFuConversationService conversationService;\n\n    @Resource\n    private AdminUserApi adminUserApi;\n    @Resource\n    private MemberUserApi memberUserApi;\n    @Resource\n    private WebSocketSenderApi webSocketSenderApi;\n\n    @Override\n    @Transactional(rollbackFor = Exception.class)\n    public Long sendKefuMessage(KeFuMessageSendReqVO sendReqVO) {\n        // 1.1 \u6821\u9a8c\u4f1a\u8bdd\u662f\u5426\u5b58\u5728\n        KeFuConversationDO conversation = conversationService.validateKefuConversationExists(sendReqVO.getConversationId());\n        // 1.2 \u6821\u9a8c\u63a5\u6536\u4eba\u662f\u5426\u5b58\u5728\n        validateReceiverExist(sendReqVO.getReceiverId(), sendReqVO.getReceiverType());\n\n        // 2.1 \u4fdd\u5b58\u6d88\u606f\n        KeFuMessageDO kefuMessage = BeanUtils.toBean(sendReqVO, KeFuMessageDO.class);\n        messageMapper.insert(kefuMessage);\n        // TODO @puhui999\uff1a\u662f\u4e0d\u662f updateConversationMessage\uff0c\u91cc\u9762\u7edf\u4e00\u5904\u7406\u672a\u8bfb\u3001\u6062\u590d\uff1b\u76f4\u63a5\u8bbe\u7f6e KeFuMessageDO \u4f5c\u4e3a\u53c2\u6570\u597d\u4e86\u3002\u3002\u3002\n        // 2.2 \u66f4\u65b0\u4f1a\u8bdd\u6d88\u606f\u5197\u4f59\n        conversationService.updateConversationMessage(kefuMessage.getConversationId(), LocalDateTime.now(),\n                kefuMessage.getContent(), kefuMessage.getContentType());\n        // 2.3 \u66f4\u65b0\u7ba1\u7406\u5458\u672a\u8bfb\u6d88\u606f\u6570\n        if (UserTypeEnum.ADMIN.getValue().equals(kefuMessage.getReceiverType())) {\n            conversationService.updateAdminUnreadMessageCountByConversationId(kefuMessage.getConversationId(), 1);\n        }\n        // 2.4 \u4f1a\u5458\u7528\u6237\u53d1\u9001\u6d88\u606f\u65f6\uff0c\u5982\u679c\u7ba1\u7406\u5458\u5220\u9664\u8fc7\u4f1a\u8bdd\u5219\u8fdb\u884c\u6062\u590d\n        // TODO @puhui999\uff1a\u5efa\u8bae && \u6362\u4e00\u884c\n        updateConversationLastMessage(conversation, kefuMessage);\n\n        // 3. \u53d1\u9001\u6d88\u606f\n        getSelf().sendAsyncMessage(sendReqVO.getReceiverType(), sendReqVO.getReceiverId(), kefuMessage);\n        return kefuMessage.getId();\n    }\n\n    private void updateConversationLastMessage(KeFuConversationDO conversation, KeFuMessageDO kefuMessage) {\n        if (UserTypeEnum.MEMBER.getValue().equals(kefuMessage.getSenderType()) && Boolean.TRUE.equals(conversation.getAdminDeleted())) {\n            conversationService.updateConversationAdminDeleted(kefuMessage.getConversationId(), Boolean.FALSE);\n        }\n    }\n\n    @Override\n    @Transactional(rollbackFor = Exception.class)\n    public void updateKefuMessageReadStatus(Long conversationId, Long receiverId) {\n        // 1.1 \u6821\u9a8c\u4f1a\u8bdd\u662f\u5426\u5b58\u5728\n        conversationService.validateKefuConversationExists(conversationId);\n        // 1.2 \u67e5\u8be2\u63a5\u6536\u4eba\u6240\u6709\u7684\u672a\u8bfb\u6d88\u606f\n        // TODO @puhui999\uff1a\u5e94\u8be5\u4e0d\u80fd receiverId \u8fc7\u6ee4\u54c8\u3002\u56e0\u4e3a\u591a\u4e2a\u5ba2\u670d\uff0c\u4e00\u4e2a\u4eba\u70b9\u4e86\uff0c\u5c31\u90fd\u70b9\u4e86\u3002\n        List<KeFuMessageDO> messageList = messageMapper.selectListByConversationIdAndReceiverIdAndReadStatus(\n                conversationId, receiverId, Boolean.FALSE);\n        // 1.3 \u60c5\u51b5\u4e00\uff1a\u6ca1\u6709\u672a\u8bfb\u6d88\u606f\n        if (CollUtil.isEmpty(messageList)) {\n            return;\n        }\n\n        // 2.1 \u60c5\u51b5\u4e8c\uff1a\u66f4\u65b0\u672a\u8bfb\u6d88\u606f\u72b6\u6001\u4e3a\u5df2\u8bfb\n        messageMapper.updateReadStstusBatchByIds(convertSet(messageList, KeFuMessageDO::getId), Boolean.TRUE);\n        // 2.2 \u66f4\u65b0\u7ba1\u7406\u5458\u672a\u8bfb\u6d88\u606f\u6570\n        KeFuMessageDO message = getFirst(messageList);\n        assert message != null;\n        if (UserTypeEnum.ADMIN.getValue().equals(message.getReceiverType())) {\n            conversationService.updateAdminUnreadMessageCountByConversationId(conversationId, 0);\n        }\n\n        // 2.3 \u53d1\u9001\u6d88\u606f\u901a\u77e5\u53d1\u9001\u8005\uff0c\u63a5\u6536\u8005\u5df2\u8bfb -> \u53d1\u9001\u8005\u66f4\u65b0\u53d1\u9001\u7684\u6d88\u606f\u72b6\u6001\n        // TODO @puhui999\uff1a\u5f85\u5b9a~\n        getSelf().sendAsyncMessage(message.getSenderType(), message.getSenderId(), \"keFuMessageReadStatusChange\");\n    }\n\n    private void validateReceiverExist(Long receiverId, Integer receiverType) {\n        if (UserTypeEnum.ADMIN.getValue().equals(receiverType)) {\n            adminUserApi.validateUser(receiverId);\n        }\n        if (UserTypeEnum.MEMBER.getValue().equals(receiverType)) {\n            memberUserApi.validateUser(receiverId);\n        }\n    }\n\n    @Async\n    public void sendAsyncMessage(Integer userType, Long userId, Object content) {\n        webSocketSenderApi.sendObject(userType, userId, KEFU_MESSAGE_TYPE, content);\n    }\n\n    @Override\n    public PageResult<KeFuMessageDO> getKefuMessagePage(KeFuMessagePageReqVO pageReqVO) {\n        return messageMapper.selectPage(pageReqVO);\n    }\n\n    private KeFuMessageServiceImpl getSelf() {\n        return SpringUtil.getBean(getClass());\n    }\n\n}",
                "methodCount": 7
            },
            "candidatesTelemetryData": {
                "numberOfSuggestions": 3,
                "candidates": [
                    {
                        "lineStart": 124,
                        "lineEnd": 127,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method sendAsyncMessage to class WebSocketSenderApi",
                        "description": "Move method sendAsyncMessage to cn.iocoder.yudao.module.infra.api.websocket.WebSocketSenderApi\nRationale: The sendAsyncMessage method directly interacts with the webSocketSenderApi to send messages. The WebSocketSenderApi class encapsulates the WebSocket message sending functionalities, making it a natural fit for the sendAsyncMessage method. Thus, consolidating related functionalities within the WebSocketSenderApi class helps maintain cohesiveness and ensures that the method is located where the related actions and utilities are already defined.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 81,
                        "lineEnd": 85,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method updateConversationLastMessage to class KeFuMessageMapper",
                        "description": "Move method updateConversationLastMessage to cn.iocoder.yudao.module.promotion.dal.mysql.kefu.KeFuMessageMapper\nRationale: The method `updateConversationLastMessage` is closely related to operations involving `KeFuMessageDO` and `KeFuConversationDO` objects. Given that `KeFuMessageMapper` is responsible for data operations on `KeFuMessageDO`, adding the method here ensures that all related data manipulations are consolidated. This improves cohesion and maintainability as the `KeFuMessageMapper` will handle the message-related update operations, rather than scattering them across multiple interfaces.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 115,
                        "lineEnd": 122,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method validateReceiverExist to class AdminUserApi",
                        "description": "Move method validateReceiverExist to cn.iocoder.yudao.module.system.api.user.AdminUserApi\nRationale: The method 'validateReceiverExist' is closely tied to the functionality provided by the AdminUserApi class. Specifically, it involves validation logic for users based on their type, which is akin to the validation methods already defined in AdminUserApi. Moving it to AdminUserApi will ensure that all user validation logic is centralized and managed in one place, reducing redundancy and improving maintainability. While 'memberUserApi' is referenced in the method, AdminUserApi is a better primary target since the validation logic predominantly falls within the scope of user validation handled by AdminUserApi.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    }
                ]
            },
            "iterationData": [
                {
                    "iteration_num": 1,
                    "suggested_move_methods": [
                        {
                            "method_name": "validateReceiverExist",
                            "method_signature": "private void validateReceiverExist(Long receiverId, Integer receiverType)",
                            "target_class": "UserValidationService",
                            "rationale": "The validateReceiverExist method focuses on user validation logic that pertains to AdminUserApi and MemberUserApi, making it more appropriate to move this method to a UserValidationService class."
                        },
                        {
                            "method_name": "sendAsyncMessage",
                            "method_signature": "public void sendAsyncMessage(Integer userType, Long userId, Object content)",
                            "target_class": "WebSocketSenderApi",
                            "rationale": "The sendAsyncMessage method is strongly related to the WebSocketSenderApi and deals with message sending that is more appropriate for that class."
                        }
                    ],
                    "llm_response_time": 2603
                },
                {
                    "iteration_num": 2,
                    "suggested_move_methods": [
                        {
                            "method_name": "sendAsyncMessage",
                            "method_signature": "public void sendAsyncMessage(Integer userType, Long userId, Object content)",
                            "target_class": "WebSocketSenderApi",
                            "rationale": "The sendAsyncMessage method utilizes WebSocketSenderApi to send messages asynchronously. This logic is more relevant to the WebSocketSenderApi class as it is directly responsible for handling WebSocket communications."
                        },
                        {
                            "method_name": "validateReceiverExist",
                            "method_signature": "private void validateReceiverExist(Long receiverId, Integer receiverType)",
                            "target_class": "AdminUserApi",
                            "rationale": "The validateReceiverExist method performs validation of users based on their type, using AdminUserApi and MemberUserApi. This method could be more appropriate in a utility class or within the respective API classes, as the logic pertains to user validation rather than message sending."
                        }
                    ],
                    "llm_response_time": 2543
                },
                {
                    "iteration_num": 3,
                    "suggested_move_methods": [
                        {
                            "method_name": "sendAsyncMessage",
                            "method_signature": "public void sendAsyncMessage(Integer userType, Long userId, Object content)",
                            "target_class": "WebSocketSenderApi",
                            "rationale": "sendAsyncMessage is directly related to the WebSocketSenderApi service and involves sending messages asynchronously. This functionality aligns better with the WebSocketSenderApi class, making it a more appropriate place for this method."
                        },
                        {
                            "method_name": "validateReceiverExist",
                            "method_signature": "private void validateReceiverExist(Long receiverId, Integer receiverType)",
                            "target_class": "UserApiValidator",
                            "rationale": "validateReceiverExist handles user validation, depending on the type (Admin or Member). This method should ideally be part of a class responsible for user validations, such as a new class named UserApiValidator, improving cohesion and Single Responsibility Principle."
                        }
                    ],
                    "llm_response_time": 2211
                },
                {
                    "iteration_num": -1,
                    "suggested_move_methods": [
                        {
                            "method_name": "updateConversationLastMessage",
                            "method_signature": "private updateConversationLastMessage(KeFuConversationDO conversation, KeFuMessageDO kefuMessage)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "validateReceiverExist",
                            "method_signature": "private validateReceiverExist(Long receiverId, Integer receiverType)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "sendAsyncMessage",
                            "method_signature": "@Async\n    public sendAsyncMessage(Integer userType, Long userId, Object content)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                },
                {
                    "iteration_num": -2,
                    "suggested_move_methods": [
                        {
                            "method_name": "sendAsyncMessage",
                            "method_signature": "@Async\n    public sendAsyncMessage(Integer userType, Long userId, Object content)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "updateConversationLastMessage",
                            "method_signature": "private updateConversationLastMessage(KeFuConversationDO conversation, KeFuMessageDO kefuMessage)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "validateReceiverExist",
                            "method_signature": "private validateReceiverExist(Long receiverId, Integer receiverType)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                }
            ],
            "methodCompatibilityScores": {
                "tf-idf": {
                    "@Async\n    public sendAsyncMessage(Integer userType, Long userId, Object content)": {
                        "first": {
                            "method_name": "sendAsyncMessage",
                            "method_signature": "@Async\n    public sendAsyncMessage(Integer userType, Long userId, Object content)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.24323156800208287
                    },
                    "private updateConversationLastMessage(KeFuConversationDO conversation, KeFuMessageDO kefuMessage)": {
                        "first": {
                            "method_name": "updateConversationLastMessage",
                            "method_signature": "private updateConversationLastMessage(KeFuConversationDO conversation, KeFuMessageDO kefuMessage)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.45556713268202537
                    },
                    "private validateReceiverExist(Long receiverId, Integer receiverType)": {
                        "first": {
                            "method_name": "validateReceiverExist",
                            "method_signature": "private validateReceiverExist(Long receiverId, Integer receiverType)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.45817332687189183
                    }
                },
                "voyage": {
                    "private validateReceiverExist(Long receiverId, Integer receiverType)": {
                        "first": {
                            "method_name": "validateReceiverExist",
                            "method_signature": "private validateReceiverExist(Long receiverId, Integer receiverType)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5647244430481463
                    },
                    "@Async\n    public sendAsyncMessage(Integer userType, Long userId, Object content)": {
                        "first": {
                            "method_name": "sendAsyncMessage",
                            "method_signature": "@Async\n    public sendAsyncMessage(Integer userType, Long userId, Object content)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6203104206030815
                    },
                    "private updateConversationLastMessage(KeFuConversationDO conversation, KeFuMessageDO kefuMessage)": {
                        "first": {
                            "method_name": "updateConversationLastMessage",
                            "method_signature": "private updateConversationLastMessage(KeFuConversationDO conversation, KeFuMessageDO kefuMessage)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6945397460211081
                    }
                }
            },
            "llmMethodPriority": {
                "tf-idf": {
                    "priority_method_names": [],
                    "llm_response_time": 2711
                },
                "tf-idf-5": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "tf-df-3": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "voyage": {
                    "priority_method_names": [],
                    "llm_response_time": 2988
                },
                "voyage-5": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "voyage-3": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                }
            },
            "targetClassMap": {
                "sendAsyncMessage": {
                    "target_classes": [
                        {
                            "class_name": "KeFuMessageMapper",
                            "similarity_score": 0.24878220016754538
                        },
                        {
                            "class_name": "KeFuConversationService",
                            "similarity_score": 0.04747962615283043
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.05079074709477658
                        },
                        {
                            "class_name": "MemberUserApi",
                            "similarity_score": 0.04784713336973399
                        },
                        {
                            "class_name": "WebSocketSenderApi",
                            "similarity_score": 0.2333800140046683
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "WebSocketSenderApi",
                        "AdminUserApi",
                        "KeFuMessageMapper"
                    ],
                    "llm_response_time": 3268,
                    "similarity_computation_time": 3,
                    "similarity_metric": "cosine"
                },
                "updateConversationLastMessage": {
                    "target_classes": [
                        {
                            "class_name": "KeFuMessageMapper",
                            "similarity_score": 0.3544745038970271
                        },
                        {
                            "class_name": "KeFuConversationService",
                            "similarity_score": 0.04924580896481245
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.07284161902257523
                        },
                        {
                            "class_name": "MemberUserApi",
                            "similarity_score": 0.06616931598844268
                        },
                        {
                            "class_name": "WebSocketSenderApi",
                            "similarity_score": 0.1577882104010429
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "KeFuMessageMapper",
                        "AdminUserApi",
                        "WebSocketSenderApi"
                    ],
                    "llm_response_time": 3953,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "validateReceiverExist": {
                    "target_classes": [
                        {
                            "class_name": "KeFuMessageMapper",
                            "similarity_score": 0.42859730770726157
                        },
                        {
                            "class_name": "KeFuConversationService",
                            "similarity_score": 0.0562354438917361
                        },
                        {
                            "class_name": "AdminUserApi",
                            "similarity_score": 0.08226622305913775
                        },
                        {
                            "class_name": "MemberUserApi",
                            "similarity_score": 0.07556096518348253
                        },
                        {
                            "class_name": "WebSocketSenderApi",
                            "similarity_score": 0.1701034543599429
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "AdminUserApi",
                        "KeFuMessageMapper",
                        "WebSocketSenderApi"
                    ],
                    "llm_response_time": 3289,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                }
            }
        }
    },
    {
        "repository": "https://github.com/YunaiV/ruoyi-vue-pro.git",
        "sha1": "4ce2be724e91bf9838baa1cc9562f698bf8e2aa9",
        "url": "https://github.com/YunaiV/ruoyi-vue-pro/commit/4ce2be724e91bf9838baa1cc9562f698bf8e2aa9",
        "move_method_refactoring": {
            "type": "Extract And Move Method",
            "description": "Extract And Move Method public selectByUserId(userId Long) : KeFuConversationDO extracted from public getConversationByUserId(userId Long) : KeFuConversationDO in class cn.iocoder.yudao.module.promotion.service.kefu.KeFuConversationServiceImpl & moved to class cn.iocoder.yudao.module.promotion.dal.mysql.kefu.KeFuConversationMapper",
            "leftSideLocations": [
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationServiceImpl.java",
                    "startLine": 108,
                    "endLine": 112,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration before extraction",
                    "codeElement": "public getConversationByUserId(userId Long) : KeFuConversationDO"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationServiceImpl.java",
                    "startLine": 111,
                    "endLine": 111,
                    "startColumn": 9,
                    "endColumn": 84,
                    "codeElementType": "RETURN_STATEMENT",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationServiceImpl.java",
                    "startLine": 111,
                    "endLine": 111,
                    "startColumn": 45,
                    "endColumn": 74,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                }
            ],
            "rightSideLocations": [
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/dal/mysql/kefu/KeFuConversationMapper.java",
                    "startLine": 31,
                    "endLine": 33,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "extracted method declaration",
                    "codeElement": "public selectByUserId(userId Long) : KeFuConversationDO"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/dal/mysql/kefu/KeFuConversationMapper.java",
                    "startLine": 32,
                    "endLine": 32,
                    "startColumn": 9,
                    "endColumn": 65,
                    "codeElementType": "RETURN_STATEMENT",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/dal/mysql/kefu/KeFuConversationMapper.java",
                    "startLine": 32,
                    "endLine": 32,
                    "startColumn": 26,
                    "endColumn": 55,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationServiceImpl.java",
                    "startLine": 109,
                    "endLine": 112,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration after extraction",
                    "codeElement": "public getConversationByUserId(userId Long) : KeFuConversationDO"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationServiceImpl.java",
                    "startLine": 111,
                    "endLine": 111,
                    "startColumn": 16,
                    "endColumn": 57,
                    "codeElementType": "METHOD_INVOCATION",
                    "description": "extracted method invocation",
                    "codeElement": "conversationMapper.selectByUserId(userId)"
                }
            ],
            "isStatic": false
        },
        "ref_id": 17,
        "extraction_results": {
            "success": true,
            "newCommitHash": "99ad74c9d145a9d7884c7a110c6541e19ae0c140",
            "newBranchName": "extract-selectByUserId-getConversationByUserId-866b385"
        },
        "telemetry": {
            "id": "94bd84bb-a251-41ec-a5ce-63f51a5029e2",
            "hostFunctionTelemetryData": {
                "hostFunctionSize": 98,
                "lineStart": 21,
                "lineEnd": 118,
                "bodyLineStart": 21,
                "language": "java",
                "filePath": "/Users/abhiram/Documents/TBE/evaluation_projects/ruoyi-vue-pro/yudao-module-mall/yudao-module-promotion-biz/src/main/java/cn/iocoder/yudao/module/promotion/service/kefu/KeFuConversationServiceImpl.java",
                "sourceCode": "/**\n * \u5ba2\u670d\u4f1a\u8bdd Service \u5b9e\u73b0\u7c7b\n *\n * @author HUIHUI\n */\n@Service\n@Validated\npublic class KeFuConversationServiceImpl implements KeFuConversationService {\n\n    @Resource\n    private KeFuConversationMapper conversationMapper;\n\n    @Override\n    public void deleteKefuConversation(Long id) {\n        // \u6821\u9a8c\u5b58\u5728\n        validateKefuConversationExists(id);\n\n        // \u53ea\u6709\u7ba1\u7406\u5458\u7aef\u53ef\u4ee5\u5220\u9664\u4f1a\u8bdd\uff0c\u4e5f\u4e0d\u771f\u7684\u5220\uff0c\u53ea\u662f\u7ba1\u7406\u5458\u7aef\u770b\u4e0d\u5230\u5566\n        conversationMapper.updateById(new KeFuConversationDO().setId(id).setAdminDeleted(Boolean.TRUE));\n    }\n\n    @Override\n    public void updateConversationPinnedByAdmin(KeFuConversationUpdatePinnedReqVO updateReqVO) {\n        conversationMapper.updateById(new KeFuConversationDO().setId(updateReqVO.getId()).setAdminPinned(updateReqVO.getAdminPinned()));\n    }\n\n    @Override\n    @Transactional(rollbackFor = Exception.class)\n    public void updateConversationLastMessage(KeFuMessageDO kefuMessage) {\n        // 1.1 \u6821\u9a8c\u4f1a\u8bdd\u662f\u5426\u5b58\u5728\n        KeFuConversationDO conversation = validateKefuConversationExists(kefuMessage.getConversationId());\n        // 1.2 \u66f4\u65b0\u4f1a\u8bdd\u6d88\u606f\u5197\u4f59\n        conversationMapper.updateById(new KeFuConversationDO().setId(kefuMessage.getConversationId())\n                .setLastMessageTime(kefuMessage.getCreateTime()).setLastMessageContent(kefuMessage.getContent())\n                .setLastMessageContentType(kefuMessage.getContentType()));\n\n        // 2.1 \u66f4\u65b0\u7ba1\u7406\u5458\u672a\u8bfb\u6d88\u606f\u6570\n        if (UserTypeEnum.MEMBER.getValue().equals(kefuMessage.getSenderType())) {\n            conversationMapper.updateAdminUnreadMessageCount(kefuMessage.getConversationId());\n        }\n        // 2.2 \u4f1a\u5458\u7528\u6237\u53d1\u9001\u6d88\u606f\u65f6\uff0c\u5982\u679c\u7ba1\u7406\u5458\u5220\u9664\u8fc7\u4f1a\u8bdd\u5219\u8fdb\u884c\u6062\u590d\n        // TODO @puhui999\uff1a\u5176\u5b9e\u4e0d\u7528\u5224\u65ad\u7528\u6237\u7c7b\u578b\uff1b\u53ea\u8981be\u5df2\u5220\u9664\uff0c\u5c31\u6062\u590d\uff01\n        if (UserTypeEnum.MEMBER.getValue().equals(kefuMessage.getSenderType())\n                && Boolean.TRUE.equals(conversation.getAdminDeleted())) {\n            updateConversationAdminDeleted(kefuMessage.getConversationId(), Boolean.FALSE);\n        }\n    }\n\n    @Override\n    public void updateAdminUnreadMessageCountWithZero(Long id) {\n        validateKefuConversationExists(id);\n        conversationMapper.updateAdminUnreadMessageCountWithZero(id);\n    }\n\n    @Override\n    public void updateConversationAdminDeleted(Long id, Boolean adminDeleted) {\n        conversationMapper.updateById(new KeFuConversationDO().setId(id).setAdminDeleted(adminDeleted));\n    }\n\n    @Override\n    public List<KeFuConversationDO> getKefuConversationList() {\n        return conversationMapper.selectConversationList();\n    }\n\n    @Override\n    public KeFuConversationDO getOrCreateConversation(Long userId) {\n        KeFuConversationDO conversation = conversationMapper.selectOne(KeFuConversationDO::getUserId, userId);\n        // \u6ca1\u6709\u5386\u53f2\u4f1a\u8bdd\uff0c\u5219\u521d\u59cb\u5316\u4e00\u4e2a\u65b0\u4f1a\u8bdd\n        if (conversation == null) {\n            conversation = new KeFuConversationDO().setUserId(userId).setLastMessageTime(LocalDateTime.now())\n                    .setLastMessageContent(StrUtil.EMPTY).setLastMessageContentType(KeFuMessageContentTypeEnum.TEXT.getType())\n                    .setAdminPinned(Boolean.FALSE).setUserDeleted(Boolean.FALSE).setAdminDeleted(Boolean.FALSE)\n                    .setAdminUnreadMessageCount(0);\n            conversationMapper.insert(conversation);\n        }\n        return conversation;\n    }\n\n    @Override\n    public KeFuConversationDO validateKefuConversationExists(Long id) {\n        KeFuConversationDO conversation = conversationMapper.selectById(id);\n        if (conversation == null) {\n            throw exception(KEFU_CONVERSATION_NOT_EXISTS);\n        }\n        return conversation;\n    }\n\n    @Override\n    public KeFuConversationDO getConversationByUserId(Long userId) {\n        // TODO @puhui999\uff1aservice \u4e0d\u5199 dao \u7684\u903b\u8f91\u54c8\n        return selectByUserId(userId);\n    }\n\n    private KeFuConversationDO selectByUserId(Long userId) {\n        return conversationMapper.selectOne(KeFuConversationDO::getUserId, userId);\n    }\n\n}",
                "methodCount": 10
            },
            "candidatesTelemetryData": {
                "numberOfSuggestions": 1,
                "candidates": [
                    {
                        "lineStart": 113,
                        "lineEnd": 115,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method selectByUserId to class KeFuConversationMapper",
                        "description": "Move method selectByUserId to cn.iocoder.yudao.module.promotion.dal.mysql.kefu.KeFuConversationMapper\nRationale: The selectByUserId() method directly interacts with the database using the conversationMapper, which implies database operations are being performed. The KeFuConversationMapper class is designed to encapsulate such database operations related to KeFuConversationDO. By moving this method to KeFuConversationMapper, the operation logic will be centralized within a single class responsible for handling the persistence layer for KeFuConversationDO entities, enhancing cohesion and maintainability.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    }
                ]
            },
            "iterationData": [
                {
                    "iteration_num": 1,
                    "suggested_move_methods": [
                        {
                            "method_name": "updateConversationAdminDeleted",
                            "method_signature": "public void updateConversationAdminDeleted(Long id, Boolean adminDeleted)",
                            "target_class": "KeFuConversationMapper",
                            "rationale": "The method updateConversationAdminDeleted() is purely concerned with updating the database, and it makes more sense for it to reside in the KeFuConversationMapper class."
                        },
                        {
                            "method_name": "validateKefuConversationExists",
                            "method_signature": "public KeFuConversationDO validateKefuConversationExists(Long id)",
                            "target_class": "KeFuConversationMapper",
                            "rationale": "The method validateKefuConversationExists() is only performing validation by fetching data from the database. Such a method fits better in the KeFuConversationMapper class."
                        },
                        {
                            "method_name": "getConversationByUserId",
                            "method_signature": "public KeFuConversationDO getConversationByUserId(Long userId)",
                            "target_class": "KeFuConversationMapper",
                            "rationale": "The method getConversationByUserId() fetches conversation data from the database based on the user ID. This function is more appropriate in the data access class, KeFuConversationMapper."
                        },
                        {
                            "method_name": "selectByUserId",
                            "method_signature": "private KeFuConversationDO selectByUserId(Long userId)",
                            "target_class": "KeFuConversationMapper",
                            "rationale": "The selectByUserId() method is a private DAO-like method for fetching the conversation based on the user ID. It logically belongs to the data access layer, which is KeFuConversationMapper."
                        }
                    ],
                    "llm_response_time": 4960
                },
                {
                    "iteration_num": 2,
                    "suggested_move_methods": [
                        {
                            "method_name": "updateAdminUnreadMessageCountWithZero",
                            "method_signature": "public void updateAdminUnreadMessageCountWithZero(Long id)",
                            "target_class": "KeFuConversationMapper",
                            "rationale": "The method directly interacts with the database and updates a specific field in the data layer. This operation can be better managed in the mapper class."
                        },
                        {
                            "method_name": "updateConversationAdminDeleted",
                            "method_signature": "public void updateConversationAdminDeleted(Long id, Boolean adminDeleted)",
                            "target_class": "KeFuConversationMapper",
                            "rationale": "The method performs a direct update on the database, which is a concern of the data access layer and should be handled by the mapper."
                        },
                        {
                            "method_name": "selectByUserId",
                            "method_signature": "private KeFuConversationDO selectByUserId(Long userId)",
                            "target_class": "KeFuConversationMapper",
                            "rationale": "This method fetches data from the database based on a user ID. Such data fetching operations are a concern of the data access layer and should be moved to the mapper class."
                        }
                    ],
                    "llm_response_time": 2526
                },
                {
                    "iteration_num": 3,
                    "suggested_move_methods": [
                        {
                            "method_name": "updateConversationAdminDeleted",
                            "method_signature": "public void updateConversationAdminDeleted(Long id, Boolean adminDeleted)",
                            "target_class": "KeFuConversationMapper",
                            "rationale": "The method updateConversationAdminDeleted only performs an update operation on the conversationMapper and does not contain any business logic. It is more appropriate to move this method to the KeFuConversationMapper class."
                        },
                        {
                            "method_name": "selectByUserId",
                            "method_signature": "private KeFuConversationDO selectByUserId(Long userId)",
                            "target_class": "KeFuConversationMapper",
                            "rationale": "The method selectByUserId queries the database directly and does not contain any business logic. It should be moved to the KeFuConversationMapper class."
                        }
                    ],
                    "llm_response_time": 2220
                },
                {
                    "iteration_num": -1,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectByUserId",
                            "method_signature": "private selectByUserId(Long userId)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                },
                {
                    "iteration_num": -2,
                    "suggested_move_methods": [
                        {
                            "method_name": "selectByUserId",
                            "method_signature": "private selectByUserId(Long userId)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                }
            ],
            "methodCompatibilityScores": {
                "tf-idf": {
                    "private selectByUserId(Long userId)": {
                        "first": {
                            "method_name": "selectByUserId",
                            "method_signature": "private selectByUserId(Long userId)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.47051471774733916
                    }
                },
                "voyage": {
                    "private selectByUserId(Long userId)": {
                        "first": {
                            "method_name": "selectByUserId",
                            "method_signature": "private selectByUserId(Long userId)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.6379785494579647
                    }
                }
            },
            "llmMethodPriority": {
                "tf-idf": {
                    "priority_method_names": [
                        "private selectByUserId(Long userId)"
                    ],
                    "llm_response_time": 1166
                },
                "tf-idf-5": {
                    "priority_method_names": [
                        "private selectByUserId(Long userId)"
                    ],
                    "llm_response_time": 0
                },
                "tf-df-3": {
                    "priority_method_names": [
                        "private selectByUserId(Long userId)"
                    ],
                    "llm_response_time": 0
                },
                "voyage": {
                    "priority_method_names": [
                        "private selectByUserId(Long userId)"
                    ],
                    "llm_response_time": 0
                },
                "voyage-5": {
                    "priority_method_names": [
                        "private selectByUserId(Long userId)"
                    ],
                    "llm_response_time": 0
                },
                "voyage-3": {
                    "priority_method_names": [
                        "private selectByUserId(Long userId)"
                    ],
                    "llm_response_time": 0
                }
            },
            "targetClassMap": {
                "selectByUserId": {
                    "target_classes": [
                        {
                            "class_name": "KeFuConversationMapper",
                            "similarity_score": 0.2651650429449553
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "KeFuConversationMapper"
                    ],
                    "llm_response_time": 2302,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                }
            }
        }
    },
    {
        "repository": "https://github.com/YunaiV/ruoyi-vue-pro.git",
        "sha1": "401de3034479bf8787b22fc4e9f6c6b7f9f03c73",
        "url": "https://github.com/YunaiV/ruoyi-vue-pro/commit/401de3034479bf8787b22fc4e9f6c6b7f9f03c73",
        "move_method_refactoring": {
            "type": "Extract And Move Method",
            "description": "Extract And Move Method public getSpuMap(ids Collection<Long>) : Map<Long,ProductSpuDO> extracted from public getBrowseHistoryPage(pageReqVO ProductBrowseHistoryPageReqVO) : CommonResult<PageResult<ProductBrowseHistoryRespVO>> in class cn.iocoder.yudao.module.product.controller.admin.history.ProductBrowseHistoryController & moved to class cn.iocoder.yudao.module.product.service.spu.ProductSpuService",
            "leftSideLocations": [
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/controller/admin/history/ProductBrowseHistoryController.java",
                    "startLine": 42,
                    "endLine": 57,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration before extraction",
                    "codeElement": "public getBrowseHistoryPage(pageReqVO ProductBrowseHistoryPageReqVO) : CommonResult<PageResult<ProductBrowseHistoryRespVO>>"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/controller/admin/history/ProductBrowseHistoryController.java",
                    "startLine": 53,
                    "endLine": 53,
                    "startColumn": 91,
                    "endColumn": 110,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/controller/admin/history/ProductBrowseHistoryController.java",
                    "startLine": 53,
                    "endLine": 53,
                    "startColumn": 9,
                    "endColumn": 112,
                    "codeElementType": "VARIABLE_DECLARATION_STATEMENT",
                    "description": "extracted code from source method declaration",
                    "codeElement": null
                }
            ],
            "rightSideLocations": [
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/service/spu/ProductSpuService.java",
                    "startLine": 62,
                    "endLine": 71,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "extracted method declaration",
                    "codeElement": "public getSpuMap(ids Collection<Long>) : Map<Long,ProductSpuDO>"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/service/spu/ProductSpuService.java",
                    "startLine": 70,
                    "endLine": 70,
                    "startColumn": 49,
                    "endColumn": 68,
                    "codeElementType": "LAMBDA_EXPRESSION_BODY",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/service/spu/ProductSpuService.java",
                    "startLine": 70,
                    "endLine": 70,
                    "startColumn": 9,
                    "endColumn": 70,
                    "codeElementType": "RETURN_STATEMENT",
                    "description": "extracted code to extracted method declaration",
                    "codeElement": null
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/controller/admin/history/ProductBrowseHistoryController.java",
                    "startLine": 40,
                    "endLine": 55,
                    "startColumn": 5,
                    "endColumn": 6,
                    "codeElementType": "METHOD_DECLARATION",
                    "description": "source method declaration after extraction",
                    "codeElement": "public getBrowseHistoryPage(pageReqVO ProductBrowseHistoryPageReqVO) : CommonResult<PageResult<ProductBrowseHistoryRespVO>>"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/controller/admin/history/ProductBrowseHistoryController.java",
                    "startLine": 50,
                    "endLine": 51,
                    "startColumn": 42,
                    "endColumn": 84,
                    "codeElementType": "METHOD_INVOCATION",
                    "description": "extracted method invocation",
                    "codeElement": "productSpuService.getSpuMap(convertSet(pageResult.getList(),ProductBrowseHistoryDO::getSpuId))"
                },
                {
                    "filePath": "yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/service/spu/ProductSpuService.java",
                    "startLine": 69,
                    "endLine": 69,
                    "startColumn": 9,
                    "endColumn": 51,
                    "codeElementType": "VARIABLE_DECLARATION_STATEMENT",
                    "description": "added statement in extracted method declaration",
                    "codeElement": null
                }
            ],
            "isStatic": false
        },
        "ref_id": 19,
        "extraction_results": {
            "success": true,
            "newCommitHash": "2df8667d786d5879d9a7d8dfbddb804b5808d3a9",
            "newBranchName": "extract-getSpuMap-getBrowseHistoryPage-65ef6ff"
        },
        "telemetry": {
            "id": "b1d02b5e-0b7a-4f16-be33-71f892d52374",
            "hostFunctionTelemetryData": {
                "hostFunctionSize": 34,
                "lineStart": 31,
                "lineEnd": 64,
                "bodyLineStart": 31,
                "language": "java",
                "filePath": "/Users/abhiram/Documents/TBE/evaluation_projects/ruoyi-vue-pro/yudao-module-mall/yudao-module-product-biz/src/main/java/cn/iocoder/yudao/module/product/controller/admin/history/ProductBrowseHistoryController.java",
                "sourceCode": "@Tag(name = \"\u7ba1\u7406\u540e\u53f0 - \u5546\u54c1\u6d4f\u89c8\u8bb0\u5f55\")\n@RestController\n@RequestMapping(\"/product/browse-history\")\n@Validated\npublic class ProductBrowseHistoryController {\n\n    @Resource\n    private ProductBrowseHistoryService browseHistoryService;\n    @Resource\n    private ProductSpuService productSpuService;\n\n    @GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5546\u54c1\u6d4f\u89c8\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('product:browse-history:query')\")\n    public CommonResult<PageResult<ProductBrowseHistoryRespVO>> getBrowseHistoryPage(@Valid ProductBrowseHistoryPageReqVO pageReqVO) {\n        PageResult<ProductBrowseHistoryDO> pageResult = browseHistoryService.getBrowseHistoryPage(pageReqVO);\n        if (CollUtil.isEmpty(pageResult.getList())) {\n            return success(PageResult.empty());\n        }\n\n        // \u5f97\u5230\u5546\u54c1 spu \u4fe1\u606f\n        Set<Long> spuIds = convertSet(pageResult.getList(), ProductBrowseHistoryDO::getSpuId);\n        Map<Long, ProductSpuDO> spuMap = getSpuMap(spuIds);\n        return success(BeanUtils.toBean(pageResult, ProductBrowseHistoryRespVO.class,\n                vo -> Optional.ofNullable(spuMap.get(vo.getSpuId()))\n                        .ifPresent(spu -> vo.setSpuName(spu.getName()).setPicUrl(spu.getPicUrl()).setPrice(spu.getPrice()))));\n    }\n\n    private Map<Long, ProductSpuDO> getSpuMap(Set<Long> spuIds) {\n        Map<Long, ProductSpuDO> spuMap = convertMap(productSpuService.getSpuList(spuIds), ProductSpuDO::getId);\n        return spuMap;\n    }\n\n}",
                "methodCount": 2
            },
            "candidatesTelemetryData": {
                "numberOfSuggestions": 2,
                "candidates": [
                    {
                        "lineStart": 41,
                        "lineEnd": 56,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method getBrowseHistoryPage to class ProductBrowseHistoryService",
                        "description": "Move method getBrowseHistoryPage to cn.iocoder.yudao.module.product.service.history.ProductBrowseHistoryService\nRationale: The method 'getBrowseHistoryPage' is responsible for retrieving and processing product browse history details, which falls directly within the scope of ProductBrowseHistoryService. This service is already handling other browse history-related operations such as creating and hiding browse records, and fetching paged browse history results. The method that needs to be moved processes the pagination and additional details for the browse history, making it a natural fit to be housed within ProductBrowseHistoryService.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    },
                    {
                        "lineStart": 58,
                        "lineEnd": 61,
                        "refactoringType": "MyMoveInstanceMethodRefactoring",
                        "refactoringInfo": "Move method getSpuMap to class ProductSpuService",
                        "description": "Move method getSpuMap to cn.iocoder.yudao.module.product.service.spu.ProductSpuService\nRationale: The method getSpuMap relies directly on the getSpuList method from the ProductSpuService class. This indicates a strong dependency on functionalities provided by ProductSpuService, making it a more appropriate location for this method. Additionally, the service's purpose aligns with managing SPU entities and associated logic, which includes creating mappings of SPU objects.",
                        "couldCreateRefObject": true,
                        "applied": false,
                        "startedRefactoringFlow": false,
                        "undone": false
                    }
                ]
            },
            "iterationData": [
                {
                    "iteration_num": 1,
                    "suggested_move_methods": [
                        {
                            "method_name": "getSpuMap",
                            "method_signature": "private Map<Long, ProductSpuDO> getSpuMap(Set<Long> spuIds)",
                            "target_class": "ProductSpuService",
                            "rationale": "The getSpuMap method is focused on obtaining product SPU information, which is the responsibility of the ProductSpuService. Moving it to ProductSpuService will reduce the coupling in ProductBrowseHistoryController and enhance cohesion."
                        }
                    ],
                    "llm_response_time": 1769
                },
                {
                    "iteration_num": 2,
                    "suggested_move_methods": [
                        {
                            "method_name": "getSpuMap",
                            "method_signature": "private Map<Long, ProductSpuDO> getSpuMap(Set<Long> spuIds)",
                            "target_class": "ProductSpuService",
                            "rationale": "The getSpuMap method mainly interacts with the ProductSpuService to fetch and map SPUs. It would be more appropriate to place this method inside the ProductSpuService class since it aligns with the service class responsibility."
                        }
                    ],
                    "llm_response_time": 1578
                },
                {
                    "iteration_num": 3,
                    "suggested_move_methods": [
                        {
                            "method_name": "getSpuMap",
                            "method_signature": "private Map<Long, ProductSpuDO> getSpuMap(Set<Long> spuIds)",
                            "target_class": "ProductSpuService",
                            "rationale": "The method getSpuMap() is responsible for fetching SPUs based on a set of IDs, which is more related to the ProductSpuService's responsibility of managing SPU data. Moving this method to ProductSpuService will enhance cohesion and maintainability."
                        }
                    ],
                    "llm_response_time": 2216
                },
                {
                    "iteration_num": -1,
                    "suggested_move_methods": [
                        {
                            "method_name": "getBrowseHistoryPage",
                            "method_signature": "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5546\u54c1\u6d4f\u89c8\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('product:browse-history:query')\")\n    public getBrowseHistoryPage(@Valid ProductBrowseHistoryPageReqVO pageReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getSpuMap",
                            "method_signature": "private getSpuMap(Set<Long> spuIds)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                },
                {
                    "iteration_num": -2,
                    "suggested_move_methods": [
                        {
                            "method_name": "getBrowseHistoryPage",
                            "method_signature": "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5546\u54c1\u6d4f\u89c8\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('product:browse-history:query')\")\n    public getBrowseHistoryPage(@Valid ProductBrowseHistoryPageReqVO pageReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        {
                            "method_name": "getSpuMap",
                            "method_signature": "private getSpuMap(Set<Long> spuIds)",
                            "target_class": "",
                            "rationale": ""
                        }
                    ],
                    "llm_response_time": 0
                }
            ],
            "methodCompatibilityScores": {
                "tf-idf": {
                    "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5546\u54c1\u6d4f\u89c8\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('product:browse-history:query')\")\n    public getBrowseHistoryPage(@Valid ProductBrowseHistoryPageReqVO pageReqVO)": {
                        "first": {
                            "method_name": "getBrowseHistoryPage",
                            "method_signature": "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5546\u54c1\u6d4f\u89c8\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('product:browse-history:query')\")\n    public getBrowseHistoryPage(@Valid ProductBrowseHistoryPageReqVO pageReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.40509574683346666
                    },
                    "private getSpuMap(Set<Long> spuIds)": {
                        "first": {
                            "method_name": "getSpuMap",
                            "method_signature": "private getSpuMap(Set<Long> spuIds)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.44151078568834784
                    }
                },
                "voyage": {
                    "private getSpuMap(Set<Long> spuIds)": {
                        "first": {
                            "method_name": "getSpuMap",
                            "method_signature": "private getSpuMap(Set<Long> spuIds)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.5779128544689723
                    },
                    "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5546\u54c1\u6d4f\u89c8\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('product:browse-history:query')\")\n    public getBrowseHistoryPage(@Valid ProductBrowseHistoryPageReqVO pageReqVO)": {
                        "first": {
                            "method_name": "getBrowseHistoryPage",
                            "method_signature": "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5546\u54c1\u6d4f\u89c8\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('product:browse-history:query')\")\n    public getBrowseHistoryPage(@Valid ProductBrowseHistoryPageReqVO pageReqVO)",
                            "target_class": "",
                            "rationale": ""
                        },
                        "second": 0.8095233018507474
                    }
                }
            },
            "llmMethodPriority": {
                "tf-idf": {
                    "priority_method_names": [],
                    "llm_response_time": 3389
                },
                "tf-idf-5": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "tf-df-3": {
                    "priority_method_names": [],
                    "llm_response_time": 0
                },
                "voyage": {
                    "priority_method_names": [
                        "private getSpuMap(Set<Long> spuIds)",
                        "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5546\u54c1\u6d4f\u89c8\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('product:browse-history:query')\")\n    public getBrowseHistoryPage(@Valid ProductBrowseHistoryPageReqVO pageReqVO)"
                    ],
                    "llm_response_time": 3201
                },
                "voyage-5": {
                    "priority_method_names": [
                        "private getSpuMap(Set<Long> spuIds)",
                        "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5546\u54c1\u6d4f\u89c8\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('product:browse-history:query')\")\n    public getBrowseHistoryPage(@Valid ProductBrowseHistoryPageReqVO pageReqVO)"
                    ],
                    "llm_response_time": 0
                },
                "voyage-3": {
                    "priority_method_names": [
                        "private getSpuMap(Set<Long> spuIds)",
                        "@GetMapping(\"/page\")\n    @Operation(summary = \"\u83b7\u5f97\u5546\u54c1\u6d4f\u89c8\u8bb0\u5f55\u5206\u9875\")\n    @PreAuthorize(\"@ss.hasPermission('product:browse-history:query')\")\n    public getBrowseHistoryPage(@Valid ProductBrowseHistoryPageReqVO pageReqVO)"
                    ],
                    "llm_response_time": 0
                }
            },
            "targetClassMap": {
                "getBrowseHistoryPage": {
                    "target_classes": [
                        {
                            "class_name": "ProductBrowseHistoryService",
                            "similarity_score": 0.053893136493502865
                        },
                        {
                            "class_name": "ProductSpuService",
                            "similarity_score": 0.04914292251821706
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "ProductBrowseHistoryService",
                        "ProductSpuService"
                    ],
                    "llm_response_time": 2529,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                },
                "getSpuMap": {
                    "target_classes": [
                        {
                            "class_name": "ProductBrowseHistoryService",
                            "similarity_score": 0.02492030458280802
                        },
                        {
                            "class_name": "ProductSpuService",
                            "similarity_score": 0.006732976360389806
                        }
                    ],
                    "target_classes_sorted_by_llm": [
                        "ProductSpuService",
                        "ProductBrowseHistoryService"
                    ],
                    "llm_response_time": 3376,
                    "similarity_computation_time": 1,
                    "similarity_metric": "cosine"
                }
            }
        }
    }
]